IF OBJECT_ID('VM.VIEW_COMPANY_PROFILES') IS NOT NULL BEGIN
  EXECUTE('
	ALTER VIEW VM.VIEW_COMPANY_PROFILES
	AS
	SELECT Database_Name DATABASE_ID, ISNULL(PrintDesc,Company_Name) AS COMPANY_DESC, Company_Logo lOGO, CReg_Date REGISTRATION_DATE, Address COMPANY_ADDRESS, Country COMPANY_COUNTRY, State COMPANY_STATE, City COMPANY_CITY, PhoneNo COMPANY_OFFICE_NUMBER, Fax COMPANY_FAX_NO, Pan_No COMPANY_TPAN_OR_VAT, Email COMPANY_EMAIL, Website COMPANY_WEBSITE
	FROM AMS.CompanyInfo;');
END;

IF OBJECT_ID('VM.VIEW_PR_MASTER') IS NOT NULL BEGIN
  EXECUTE(' 
	ALTER VIEW [VM].[VIEW_PR_MASTER]
	AS
	SELECT PM.PR_Invoice VOUCHER_NO, CONVERT(VARCHAR(10), PM.Invoice_Date, 103) VOUCHER_DATE, PM.Invoice_Miti VOUCHER_MITI, PM.Invoice_Time VOUCHER_TIME, PM.PB_Invoice REF_VOUCHER_NO, PM.PB_Date REF_VOUCHER_DATE, PM.PB_Miti REF_VOUCHER_MITI, PM.Vendor_ID LEDGER_ID, GL.GLName LEDGER_DESC, GL.GLCode LEDEGER_SHORTNAME, GL.PanNo LEDGER_PAN, GL.GLAddress LEDGER_ADDRESS, GL.CrDays LEDGER_CREDIT_DAYS, GL.CrLimit LEDGER_CREDIT_LIMIT, GL.PhoneNo LEDGER_PHONE_NO, GL.LandLineNo LEDGER_LANDLINE_NO, GL.OwnerName LEDGER_OWNER_NAME, GL.AreaId LEDGER_AREA_ID, GLA.AreaName LEDGER_AREA, GL.AgentId LEDGER_AGENT_ID, GLAG.AgentName LEDGER_AGENT, PM.Party_Name PARTY_NAME, PM.Vat_No PARTY_VAT_NO, PM.Contact_Person PARTY_CONTACT_PERSON, PM.Mobile_No PARTY_MOBILE_NO, PM.Address PARTY_ADDRESS, PM.ChqNo PARTY_CHEQUE_NO, PM.ChqDate PARTY_CHEQUE_DATE, PM.Invoice_Type VOUCHER_TYPE, PM.Invoice_In VOUCHER_IN, PM.DueDays DUE_DAYS, PM.DueDate DUE_DATE, PM.Agent_Id AGETN_ID, JA.AgentName AGENT_DESC, JA.AgentCode AGENT_SHORTNAME, JA.Address AGENT_ADDRESS, JA.Commission AGENT_COMMISSION, JA.PhoneNo AGENT_PHONE_NO, JA.Email AGENT_EMAIL, JA.CrLimit AGENT_CREIDT_LIMIT, JA.CrDays AGENT_CREDIT_DAYS, PM.Subledger_Id SUB_LEDGER_ID, SL.SLName SUB_LEDGER_DESC, SL.SLCode SUB_LEDGER_SHORTNAME, SL.SLAddress SUB_LEDGER_ADDRESS, SL.SLPhoneNo SUB_LEDGER_PHONE_NO, PM.Cls1 DEPARTMENT_1ST, D.DName DEPARTMENT_DESC, D.DCode DEPARTMENT_SHORTNAME, PM.Cls2 DEPARTMENT_2ND, PM.Cls3 DEPARTMENT_3RD, PM.Cls4 DEPARTMENT_4TH, PM.Cur_Id CURRENCY_ID, C.CName CURRENCY_DESC, C.CCode Currency, C.CRate EXCHANEG_RATE, PM.Cur_Rate CURRENCY_RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.LN_Amount LOCAL_NET_AMOUNT, PM.Tender_Amount TENDER_AMOUNT, PM.Change_Amount CHANGE_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.Tbl_Amount TAXABLE_AMOUNT, PM.Action_type ACTION_TYPE, PM.No_Print NO_OF_PRINT, PM.In_Words NUM_IN_WORDS, PM.Remarks REMARKS, PM.Reconcile_By RECONCILE_BY, PM.Reconcile_Date RECONCILE_DATE, PM.Auth_By AUTHORIZED_BY, PM.Auth_Date AUTHORIZED_DATE, PM.Cleared_By CLEARED_BY, PM.Cleared_Date CLEARED_DATE, PM.CancelBy CANCEL_BY, PM.CancelDate CANCEL_DATE, PM.CancelRemarks CANCEL_REMARKS, PM.CUnit_Id COMPANY_UNIT_ID, CU.CmpUnit_Name COMPANY_UNIT_DESC, CU.CmpUnit_Code COMPANY_SHORTNAME, PM.CBranch_Id BRANCH_ID, B.Branch_Name BRANCH, B.Branch_Code BRANCH_SHORTNAME, PM.FiscalYearId FISCAL_YEAR_ID, FY.AD_FY AD_FISCAL_YEAR, FY.BS_FY BS_FISCAL_YEAR, PM.Enter_By ENTER_BY, PM.Enter_Date ENTER_DATE
	FROM AMS.PR_Master PM
		 LEFT OUTER JOIN AMS.GeneralLedger GL ON GL.GLID=PM.Vendor_ID
		 LEFT OUTER JOIN AMS.JuniorAgent GLAG ON GLAG.AgentId=GL.AgentId
		 LEFT OUTER JOIN AMS.Area GLA ON GLA.AreaId=GL.AreaId
		 LEFT OUTER JOIN AMS.Currency C ON C.CId=PM.Cur_Id
		 LEFT OUTER JOIN AMS.Subledger SL ON SL.SLId=PM.Subledger_Id
		 LEFT OUTER JOIN AMS.JuniorAgent JA ON JA.AgentId=PM.Agent_Id
		 LEFT OUTER JOIN AMS.GeneralLedger JAGL ON JAGL.GLID=JA.GLCode
		 LEFT OUTER JOIN AMS.Branch B ON B.Branch_ID=PM.CBranch_Id
		 LEFT OUTER JOIN AMS.CompanyUnit CU ON CU.CmpUnit_ID=PM.CUnit_Id
		 LEFT OUTER JOIN AMS.FiscalYear FY ON FY.FY_Id=PM.FiscalYearId
		 LEFT OUTER JOIN AMS.Department D ON D.DId=PM.Cls1; ');
END;

IF OBJECT_ID('VM.VIEW_PR_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_PR_DETAILS AS
    SELECT PM.PR_Invoice VOUCHER_NO, PM.Invoice_SNo VOUCHER_SNO, PM.P_Id Product_Id, p.PName PRODUCT_DESC, p.PShortName PRODUCT_SHORTNAME,p.HsCode PRODUCT_HSCODE, p.PAlias PRODUCT_ALIAS, p.PUnit PRODUCT_UNIT_ID, p.PAltUnit PRODUCT_ALT_UNIT_ID, p.PBuyRate PRODUCT_BUY_RATE, p.PSalesRate PRODUCT_SALES_RATE, p.PMRP PRODUCT_MRP, p.TradeRate PRODUCT_TRADE, p.PMin PRODUCT_MIN_STOCK, p.PMax PRODUCT_MAX_STOCK, p.PImage PRODUCT_IMANGE, p.CmpId1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, PM.Gdn_Id GODOWN_ID, g.GName GODOWN_DESC, g.GCode GODOWN_SHORTNAME, g.GLocation GODOWN_LOCATION, PM.ALT_QTY ALT_QTY, PM.Alt_UnitId ALT_UNIT_ID, pau.UnitCode ALT_UNIT, PM.QTY QTY, PM.Unit_Id Unit_Id, ppu.UnitCode UNIT, PM.RATE RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.AltStock_Qty ALT_STOCK_QTY, PM.STOCK_QTY STOCK_QTY, PM.NARRATION NARRATION, PM.PB_Invoice REF_VOUCHER_NO, PM.PB_Sno REF_VOUCHER_SNO, PM.Tax_Amount TAXABLE_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.V_Rate VAT_RATE, PM.FREE_UNIT_ID FREE_UNIT_ID, PM.FREE_QTY FREE_QTY, PM.StockFree_Qty STOCK_FREE_QTY, PM.ExtraFree_Unit_Id EXTRA_FREE_UNIT_ID, PM.ExtraFree_Qty EXTRA_FREE_QTY, PM.ExtraStockFree_Qty EXTRA_STOCK_FREE_QTY, PM.T_Product IS_TAXABLE, PM.P_Ledger PURCHASE_LEDGER_ID, PM.PR_Ledger RETURN_LEDGER_ID, PM.SZ1 SIZE_1, PM.SZ2 SIZE_2, PM.SZ3 SIZE_3, PM.SZ4 SIZE_4, PM.SZ5 SIZE_5, PM.SZ6 SIZE_6, PM.SZ7 SIZE_7, PM.SZ8 SIZE_8, PM.SZ9 SIZE_9, PM.SZ10 SIZE_10, PM.SERIAL_NO SERIAL_NO, PM.BATCH_NO BATCH_NO, PM.Exp_Date EXPIRY_DATE, PM.Manu_Date MANUFACTURING_DATE
    FROM AMS.PR_Details PM
	     LEFT OUTER JOIN AMS.Product p ON p.PID = PM.P_Id
	     LEFT OUTER JOIN AMS.ProductUnit ppu ON ppu.UID = PM.Unit_Id
	     LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID = PM.Alt_UnitId
	     LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpId = p.PGrpId
	     LEFT OUTER JOIN AMS.ProductSubGroup psg ON psg.PSubGrpId = p.PSubGrpId
	     LEFT OUTER JOIN AMS.Department d ON p.CmpId = d.DId
	     LEFT OUTER JOIN AMS.Godown g ON PM.Gdn_Id = g.GID; ');
END;

IF OBJECT_ID('VM.VIEW_PB_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_PB_MASTER AS
    SELECT PM.PB_Invoice VOUCHER_NO, CONVERT(varchar(10),PM.Invoice_Date,103) VOUCHER_DATE, PM.Invoice_Miti VOUCHER_MITI, PM.Invoice_Time VOUCHER_TIME, PM.PB_Vno REF_VOUCHER_NO, PM.Vno_Date REF_VOUCHER_DATE, PM.Vno_Miti REF_VOUCHER_MITI, PM.Vendor_ID LEDGER_ID, GL.GLName LEDGER_DESC, GL.GLCode LEDEGER_SHORTNAME, GL.GLAddress LEDGER_ADDRESS, GL.CrDays LEDGER_CREDIT_DAYS, GL.CrLimit LEDGER_CREDIT_LIMIT, GL.PhoneNo LEDGER_PHONE_NO, GL.LandLineNo LEDGER_LANDLINE_NO, GL.OwnerName LEDGER_OWNER_NAME, GL.AreaId LEDGER_AREA_ID, GLA.AreaName LEDGER_AREA, GL.AgentId LEDGER_AGENT_ID, GLAG.AgentName LEDGER_AGENT, PM.PARTY_NAME PARTY_NAME, PM.Vat_No PARTY_VAT_NO, PM.Contact_Person PARTY_CONTACT_PERSON, PM.Mobile_No PARTY_MOBILE_NO, PM.Address PARTY_ADDRESS, PM.ChqNo PARTY_CHEQUE_NO, PM.ChqDate PARTY_CHEQUE_DATE, PM.Invoice_Type VOUCHER_TYPE, PM.Invoice_In VOUCHER_IN, PM.DueDays DUE_DAYS, PM.DueDate DUE_DATE, PM.Agent_ID AGETN_ID, JA.AgentName AGENT_DESC, JA.AgentCode AGENT_SHORTNAME, JA.Address AGENT_ADDRESS, JA.Commission AGENT_COMMISSION, JA.PhoneNo AGENT_PHONE_NO, JA.Email AGENT_EMAIL, JA.CrLimit AGENT_CREIDT_LIMIT, JA.CrDays AGENT_CREDIT_DAYS, PM.Subledger_Id SUB_LEDGER_ID, SL.SLName SUB_LEDGER_DESC, SL.SLCode SUB_LEDGER_SHORTNAME, SL.SLAddress SUB_LEDGER_ADDRESS, SL.SLPhoneNo SUB_LEDGER_PHONE_NO, PM.Cls1 DEPARTMENT_1ST, D.DName DEPARTMENT_DESC, D.DCode DEPARTMENT_SHORTNAME, PM.Cls2 DEPARTMENT_2ND, PM.Cls3 DEPARTMENT_3RD, PM.Cls4 DEPARTMENT_4TH, PM.Cur_Id CURRENCY_ID, C.CName CURRENCY_DESC, C.CCode Currency, C.CRate EXCHANEG_RATE, PM.Cur_Rate CURRENCY_RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.LN_Amount LOCAL_NET_AMOUNT, PM.TENDER_AMOUNT TENDER_AMOUNT, PM.CHANGE_AMOUNT CHANGE_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.Tbl_Amount TAXABLE_AMOUNT, PM.ACTION_TYPE ACTION_TYPE, PM.No_Print NO_OF_PRINT, PM.In_Words NUM_IN_WORDS, PM.REMARKS REMARKS, PM.RECONCILE_BY RECONCILE_BY, PM.RECONCILE_DATE RECONCILE_DATE, PM.Auth_By AUTHORIZED_BY, PM.Auth_Date AUTHORIZED_DATE, PM.CLEARED_BY CLEARED_BY, PM.CLEARED_DATE CLEARED_DATE, PM.CancelBy CANCEL_BY, PM.CancelDate CANCEL_DATE, PM.CancelRemarks CANCEL_REMARKS, PM.CUnit_Id COMPANY_UNIT_ID, CU.CmpUnit_Name COMPANY_UNIT_DESC, CU.CmpUnit_Code COMPANY_SHORTNAME, PM.CBranch_Id BRANCH_ID, B.Branch_Name BRANCH, B.Branch_Code BRANCH_SHORTNAME, PM.FiscalYearId FISCAL_YEAR_ID, FY.AD_FY AD_FISCAL_YEAR, FY.BS_FY BS_FISCAL_YEAR, PM.ENTER_BY ENTER_BY, PM.ENTER_DATE ENTER_DATE
    FROM AMS.PB_Master PM
	     LEFT OUTER JOIN AMS.GeneralLedger GL ON GL.GLID = PM.Vendor_ID
	     LEFT OUTER JOIN AMS.JuniorAgent GLAG ON GLAG.AgentId = GL.AgentId
	     LEFT OUTER JOIN AMS.Area GLA ON GLA.AreaId = GL.AreaId
	     LEFT OUTER JOIN AMS.Currency C ON C.CId = PM.Cur_Id
	     LEFT OUTER JOIN AMS.Subledger SL ON SL.SLId = PM.Subledger_Id
	     LEFT OUTER JOIN AMS.JuniorAgent JA ON JA.AgentId = PM.Agent_ID
	     LEFT OUTER JOIN AMS.GeneralLedger JAGL ON JAGL.GLID = JA.GLCode
	     LEFT OUTER JOIN AMS.BRANCH B ON B.BRANCH_ID = PM.CBranch_Id
	     LEFT OUTER JOIN AMS.CompanyUnit CU ON CU.CmpUnit_ID = PM.CUnit_Id
	     LEFT OUTER JOIN AMS.FiscalYear FY ON FY.FY_Id = PM.FiscalYearId
	     LEFT OUTER JOIN AMS.Department D ON D.DId = PM.Cls1;');
END;

IF OBJECT_ID('VM.VIEW_PB_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_PB_DETAILS AS
    SELECT PM.PB_Invoice VOUCHER_NO, PM.Invoice_SNo VOUCHER_SNO, PM.P_Id Product_Id, p.PName PRODUCT_DESC, p.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE, p.PAlias PRODUCT_ALIAS, p.PUnit PRODUCT_UNIT_ID, p.PAltUnit PRODUCT_ALT_UNIT_ID, p.PBuyRate PRODUCT_BUY_RATE, p.PSalesRate PRODUCT_SALES_RATE, p.PMRP PRODUCT_MRP, p.TradeRate PRODUCT_TRADE, p.PMin PRODUCT_MIN_STOCK, p.PMax PRODUCT_MAX_STOCK, p.PImage PRODUCT_IMANGE, p.CmpId1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, PM.Gdn_Id GODOWN_ID, g.GName GODOWN_DESC, g.GCode GODOWN_SHORTNAME, g.GLocation GODOWN_LOCATION, PM.ALT_QTY ALT_QTY, PM.Alt_UnitId ALT_UNIT_ID, pau.UnitCode ALT_UNIT, PM.QTY QTY, PM.Unit_Id Unit_Id, ppu.UnitCode UNIT, PM.RATE RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.AltStock_Qty ALT_STOCK_QTY, PM.STOCK_QTY STOCK_QTY, PM.NARRATION NARRATION, PM.PO_Invoice ORDER_VOUCHER_NO, PM.PO_Sno ORDER_SNO, PM.PC_Invoice CHALLAN_VOUCHER_NO, PM.PC_SNo CHALLAN_SNO, PM.Tax_Amount TAXABLE_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.V_Rate VAT_RATE, PM.FREE_UNIT_ID FREE_UNIT_ID, PM.FREE_QTY FREE_QTY, PM.StockFree_Qty STOCK_FREE_QTY, PM.ExtraFree_Unit_Id EXTRA_FREE_UNIT_ID, PM.ExtraFree_Qty EXTRA_FREE_QTY, PM.ExtraStockFree_Qty EXTRA_STOCK_FREE_QTY, PM.T_Product IS_TAXABLE, PM.P_Ledger PURCHASE_LEDGER_ID, PM.PR_Ledger RETURN_LEDGER_ID, PM.SZ1 SIZE_1, PM.SZ2 SIZE_2, PM.SZ3 SIZE_3, PM.SZ4 SIZE_4, PM.SZ5 SIZE_5, PM.SZ6 SIZE_6, PM.SZ7 SIZE_7, PM.SZ8 SIZE_8, PM.SZ9 SIZE_9, PM.SZ10 SIZE_10, PM.SERIAL_NO SERIAL_NO, PM.BATCH_NO BATCH_NO, PM.Exp_Date EXPIRY_DATE, PM.Manu_Date MANUFACTURING_DATE
    FROM AMS.PB_Details PM
	     LEFT OUTER JOIN AMS.Product p ON p.PID = PM.P_Id
	     LEFT OUTER JOIN AMS.ProductUnit ppu ON ppu.UID = PM.Unit_Id
	     LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID = PM.Alt_UnitId
	     LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpId = p.PGrpId
	     LEFT OUTER JOIN AMS.ProductSubGroup psg ON psg.PSubGrpId = p.PSubGrpId
	     LEFT OUTER JOIN AMS.Department d ON p.CmpId = d.DId
	     LEFT OUTER JOIN AMS.Godown g ON PM.Gdn_Id = g.GID;');
END;

IF OBJECT_ID('VM.VIEW_PB_OTHER_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_PB_OTHER_MASTER AS
    SELECT PAB_Invoice VOUCHER_NO, PPNo VOUCHER_PURCHASE_NO, PPDate PURCHASE_DATE, TaxableAmount TAXABLE_AMOUNT, VatAmount VAT_AMOUNT, CustomAgent CUSTOM_AGENT, Transportation TRANSPORTATION, VechileNo VECHILE_NO, Cn_No CN_NO, Cn_Date CN_DATE, BankDoc BANK_DOCCUMNET
    FROM AMS.PB_OtherMaster;');
END;

IF OBJECT_ID('VM.VIEW_PO_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW [VM].[VIEW_PO_MASTER] AS
    SELECT PM.PO_Invoice VOUCHER_NO, PM.Invoice_Date VOUCHER_DATE, PM.Invoice_Miti VOUCHER_MITI, PM.Invoice_Time VOUCHER_TIME, PM.PB_Vno REF_VOUCHER_NO, PM.Vno_Date REF_VOUCHER_DATE, PM.Vno_Miti REF_VOUCHER_MITI, PM.Vendor_ID LEDGER_ID, GL.GLName LEDGER_DESC, GL.GLCode LEDEGER_SHORTNAME, GL.GLAddress LEDGER_ADDRESS, GL.CrDays LEDGER_CREDIT_DAYS, GL.CrLimit LEDGER_CREDIT_LIMIT, GL.PhoneNo LEDGER_PHONE_NO, GL.LandLineNo LEDGER_LANDLINE_NO, GL.OwnerName LEDGER_OWNER_NAME, GL.AreaId LEDGER_AREA_ID, GLA.AreaName LEDGER_AREA, GL.AgentId LEDGER_AGENT_ID, GLAG.AgentName LEDGER_AGENT, PM.PARTY_NAME PARTY_NAME, PM.Vat_No PARTY_VAT_NO, PM.Contact_Person PARTY_CONTACT_PERSON, PM.Mobile_No PARTY_MOBILE_NO, PM.Address PARTY_ADDRESS, PM.ChqNo PARTY_CHEQUE_NO, PM.ChqDate PARTY_CHEQUE_DATE, PM.Invoice_Type VOUCHER_TYPE, PM.Invoice_In VOUCHER_IN, PM.DueDays DUE_DAYS, PM.DueDate DUE_DATE, PM.Agent_ID AGETN_ID, JA.AgentName AGENT_DESC, JA.AgentCode AGENT_SHORTNAME, JA.Address AGENT_ADDRESS, JA.Commission AGENT_COMMISSION, JA.PhoneNo AGENT_PHONE_NO, JA.Email AGENT_EMAIL, JA.CrLimit AGENT_CREIDT_LIMIT, JA.CrDays AGENT_CREDIT_DAYS, PM.Subledger_Id SUB_LEDGER_ID, SL.SLName SUB_LEDGER_DESC, SL.SLCode SUB_LEDGER_SHORTNAME, SL.SLAddress SUB_LEDGER_ADDRESS, SL.SLPhoneNo SUB_LEDGER_PHONE_NO, PM.Cls1 DEPARTMENT_1ST, D.DName DEPARTMENT_DESC, D.DCode DEPARTMENT_SHORTNAME, PM.Cls2 DEPARTMENT_2ND, PM.Cls3 DEPARTMENT_3RD, PM.Cls4 DEPARTMENT_4TH, PM.Cur_Id CURRENCY_ID, C.CName CURRENCY_DESC, C.CCode CURRENCY, C.CRate EXCHANEG_RATE, PM.Cur_Rate CURRENCY_RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.LN_Amount LOCAL_NET_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.Tbl_Amount TAXABLE_AMOUNT, PM.ACTION_TYPE ACTION_TYPE, PM.No_Print NO_OF_PRINT, PM.In_Words NUM_IN_WORDS, PM.REMARKS REMARKS, PM.RECONCILE_BY RECONCILE_BY, PM.RECONCILE_DATE RECONCILE_DATE, PM.Auth_By AUTHORIZED_BY, PM.Auth_Date AUTHORIZED_DATE, PM.CUnit_Id COMPANY_UNIT_ID, CU.CmpUnit_Name COMPANY_UNIT_DESC, CU.CmpUnit_Code COMPANY_SHORTNAME, PM.CBranch_Id BRANCH_ID, B.Branch_Name BRANCH, B.Branch_Code BRANCH_SHORTNAME, PM.FiscalYearId FISCAL_YEAR_ID, FY.AD_FY AD_FISCAL_YEAR, FY.BS_FY BS_FISCAL_YEAR, PM.ENTER_BY ENTER_BY, PM.ENTER_DATE ENTER_DATE
    FROM AMS.PO_Master PM
	     LEFT OUTER JOIN AMS.GeneralLedger GL ON GL.GLID = PM.Vendor_ID
	     LEFT OUTER JOIN AMS.JuniorAgent GLAG ON GLAG.AgentId = GL.AgentId
	     LEFT OUTER JOIN AMS.Area GLA ON GLA.AreaId = GL.AreaId
	     LEFT OUTER JOIN AMS.CURRENCY C ON C.CId = PM.Cur_Id
	     LEFT OUTER JOIN AMS.Subledger SL ON SL.SLId = PM.Subledger_Id
	     LEFT OUTER JOIN AMS.JuniorAgent JA ON JA.AgentId = PM.Agent_ID
	     LEFT OUTER JOIN AMS.GeneralLedger JAGL ON JAGL.GLID = JA.GLCode
	     LEFT OUTER JOIN AMS.BRANCH B ON B.BRANCH_ID = PM.CBranch_Id
	     LEFT OUTER JOIN AMS.CompanyUnit CU ON CU.CmpUnit_ID = PM.CUnit_Id
	     LEFT OUTER JOIN AMS.FiscalYear FY ON FY.FY_Id = PM.FiscalYearId
	     LEFT OUTER JOIN AMS.Department D ON D.DId = PM.Cls1;');
END;

IF OBJECT_ID('VM.VIEW_PO_DETAILS') IS NOT NULL BEGIN
  EXECUTE('    
	ALTER VIEW VM.VIEW_PO_DETAILS AS
    SELECT PM.PO_Invoice VOUCHER_NO, PM.Invoice_SNo VOUCHER_SNO, PM.P_Id Product_Id, p.PName PRODUCT_DESC, p.PShortName PRODUCT_SHORTNAME, p.HsCode PRODUCT_HSCODE, p.PAlias PRODUCT_ALIAS, p.PUnit PRODUCT_UNIT_ID, p.PAltUnit PRODUCT_ALT_UNIT_ID, p.PBuyRate PRODUCT_BUY_RATE, p.PSalesRate PRODUCT_SALES_RATE, p.PMRP PRODUCT_MRP, p.TradeRate PRODUCT_TRADE, p.PMin PRODUCT_MIN_STOCK, p.PMax PRODUCT_MAX_STOCK, p.PImage PRODUCT_IMANGE, p.CMPID1 DEPARTMENT_1ST, PM.Gdn_Id GODOWN_ID, PM.ALT_QTY ALT_QTY, PM.Alt_UnitId ALT_UNIT_ID, PM.QTY QTY, PM.UNIT_ID UNIT_ID, PM.RATE RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.AltStock_Qty ALT_STOCK_QTY, PM.STOCK_QTY STOCK_QTY, PM.NARRATION NARRATION, PM.PIN_Invoice PIN_VOUCHER_NO, PM.PIN_Sno PIN_VOUCHER_SNO, PM.Tax_Amount TAXABLE_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.V_Rate VAT_RATE, PM.FREE_UNIT_ID FREE_UNIT_ID, PM.FREE_QTY FREE_QTY, PM.StockFree_Qty STOCK_FREE_QTY, PM.ExtraFree_Unit_Id EXTRA_FREE_UNIT_ID, PM.ExtraFree_Qty EXTRA_FREE_QTY, PM.ExtraStockFree_Qty EXTRA_STOCK_FREE_QTY, PM.T_Product IS_TAXABLE, PM.P_Ledger PURCHASE_LEDGER_ID, PM.PR_Ledger RETURN_LEDGER_ID, PM.SZ1 SIZE_1, PM.SZ2 SIZE_2, PM.SZ3 SIZE_3, PM.SZ4 SIZE_4, PM.SZ5 SIZE_5, PM.SZ6 SIZE_6, PM.SZ7 SIZE_7, PM.SZ8 SIZE_8, PM.SZ9 SIZE_9, PM.SZ10 SIZE_10, PM.SERIAL_NO SERIAL_NO, PM.BATCH_NO BATCH_NO, PM.Exp_Date EXPIRY_DATE, PM.Manu_Date MANUFACTURING_DATE
    FROM AMS.PO_Details PM
	     LEFT OUTER JOIN AMS.Product p ON p.PID = PM.P_Id
	     LEFT OUTER JOIN AMS.ProductUnit ppu ON ppu.UID = p.PUnit
	     LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID = p.PAltUnit
	     LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpId = p.PGrpId
	     LEFT OUTER JOIN AMS.ProductSubGroup psg ON psg.PSubGrpId = p.PSubGrpId; ');
END;

IF OBJECT_ID('VM.VIEW_PC_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_PC_MASTER AS
    SELECT PM.PC_Invoice VOUCHER_NO, PM.Invoice_Date VOUCHER_DATE, PM.Invoice_Miti VOUCHER_MITI, PM.Invoice_Time VOUCHER_TIME, PM.PB_Vno REF_VOUCHER_NO, PM.Vno_Date REF_VOUCHER_DATE, PM.Vno_Miti REF_VOUCHER_MITI, PM.Vendor_ID LEDGER_ID, GL.GLName LEDGER_DESC, GL.GLCode LEDEGER_SHORTNAME, GL.GLAddress LEDGER_ADDRESS, GL.CrDays LEDGER_CREDIT_DAYS, GL.CrLimit LEDGER_CREDIT_LIMIT, GL.PhoneNo LEDGER_PHONE_NO, GL.LandLineNo LEDGER_LANDLINE_NO, GL.OwnerName LEDGER_OWNER_NAME, GL.AreaId LEDGER_AREA_ID, GLA.AreaName LEDGER_AREA, GL.AgentId LEDGER_AGENT_ID, GLAG.AgentName LEDGER_AGENT, PM.PARTY_NAME PARTY_NAME, PM.Vat_No PARTY_VAT_NO, PM.Contact_Person PARTY_CONTACT_PERSON, PM.Mobile_No PARTY_MOBILE_NO, PM.Address PARTY_ADDRESS, PM.ChqNo PARTY_CHEQUE_NO, PM.ChqDate PARTY_CHEQUE_DATE, PM.Invoice_Type VOUCHER_TYPE, PM.Invoice_In VOUCHER_IN, PM.DueDays DUE_DAYS, PM.DueDate DUE_DATE, PM.Agent_ID AGETN_ID, JA.AgentName AGENT_DESC, JA.AgentCode AGENT_SHORTNAME, JA.Address AGENT_ADDRESS, JA.Commission AGENT_COMMISSION, JA.PhoneNo AGENT_PHONE_NO, JA.Email AGENT_EMAIL, JA.CrLimit AGENT_CREIDT_LIMIT, JA.CrDays AGENT_CREDIT_DAYS, PM.Subledger_Id SUB_LEDGER_ID, SL.SLName SUB_LEDGER_DESC, SL.SLCode SUB_LEDGER_SHORTNAME, SL.SLAddress SUB_LEDGER_ADDRESS, SL.SLPhoneNo SUB_LEDGER_PHONE_NO, PM.Cls1 DEPARTMENT_1ST, D.DName DEPARTMENT_DESC, D.DCode DEPARTMENT_SHORTNAME, PM.Cls2 DEPARTMENT_2ND, PM.Cls3 DEPARTMENT_3RD, PM.Cls4 DEPARTMENT_4TH, PM.Cur_Id CURRENCY_ID, C.CName CURRENCY_DESC, C.CCode Currency, C.CRate EXCHANEG_RATE, PM.Cur_Rate CURRENCY_RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.LN_Amount LOCAL_NET_AMOUNT, PM.TENDER_AMOUNT TENDER_AMOUNT, PM.CHANGE_AMOUNT CHANGE_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.Tbl_Amount TAXABLE_AMOUNT, PM.ACTION_TYPE ACTION_TYPE, PM.No_Print NO_OF_PRINT, PM.In_Words NUM_IN_WORDS, PM.REMARKS REMARKS, PM.RECONCILE_BY RECONCILE_BY, PM.RECONCILE_DATE RECONCILE_DATE, PM.Auth_By AUTHORIZED_BY, PM.Auth_Date AUTHORIZED_DATE, PM.CUnit_Id COMPANY_UNIT_ID, CU.CmpUnit_Name COMPANY_UNIT_DESC, CU.CmpUnit_Code COMPANY_SHORTNAME, PM.CBranch_Id BRANCH_ID, B.Branch_Name BRANCH, B.Branch_Code BRANCH_SHORTNAME, PM.FiscalYearId FISCAL_YEAR_ID, FY.AD_FY AD_FISCAL_YEAR, FY.BS_FY BS_FISCAL_YEAR, PM.ENTER_BY ENTER_BY, PM.ENTER_DATE ENTER_DATE
    FROM AMS.PC_Master PM
	     LEFT OUTER JOIN AMS.GeneralLedger GL ON GL.GLID = PM.Vendor_ID
	     LEFT OUTER JOIN AMS.JuniorAgent GLAG ON GLAG.AgentId = GL.AgentId
	     LEFT OUTER JOIN AMS.Area GLA ON GLA.AreaId = GL.AreaId
	     LEFT OUTER JOIN AMS.Currency C ON C.CId = PM.Cur_Id
	     LEFT OUTER JOIN AMS.Subledger SL ON SL.SLId = PM.Subledger_Id
	     LEFT OUTER JOIN AMS.JuniorAgent JA ON JA.AgentId = PM.Agent_ID
	     LEFT OUTER JOIN AMS.GeneralLedger JAGL ON JAGL.GLID = JA.GLCode
	     LEFT OUTER JOIN AMS.BRANCH B ON B.BRANCH_ID = PM.CBranch_Id
	     LEFT OUTER JOIN AMS.CompanyUnit CU ON CU.CmpUnit_ID = PM.CUnit_Id
	     LEFT OUTER JOIN AMS.FiscalYear FY ON FY.FY_Id = PM.FiscalYearId
	     LEFT OUTER JOIN AMS.Department D ON D.DId = PM.Cls1;');
END;

IF OBJECT_ID('VM.VIEW_PC_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_PC_DETAILS AS
    SELECT PM.PC_Invoice VOUCHER_NO, PM.Invoice_SNo VOUCHER_SNO, PM.P_Id Product_Id, p.PName PRODUCT_DESC, p.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE, p.PAlias PRODUCT_ALIAS, p.PUnit PRODUCT_UNIT_ID, p.PAltUnit PRODUCT_ALT_UNIT_ID, p.PBuyRate PRODUCT_BUY_RATE, p.PSalesRate PRODUCT_SALES_RATE, p.PMRP PRODUCT_MRP, p.TradeRate PRODUCT_TRADE, p.PMin PRODUCT_MIN_STOCK, p.PMax PRODUCT_MAX_STOCK, p.PImage PRODUCT_IMANGE, p.CmpId1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, PM.Gdn_Id GODOWN_ID, g.GName GODOWN_DESC, g.GCode GODOWN_SHORTNAME, g.GLocation GODOWN_LOCATION, PM.ALT_QTY ALT_QTY, PM.Alt_UnitId ALT_UNIT_ID, pau.UnitCode ALT_UNIT, PM.QTY QTY, PM.Unit_Id Unit_Id, ppu.UnitCode UNIT, PM.RATE RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.AltStock_Qty ALT_STOCK_QTY, PM.STOCK_QTY STOCK_QTY, PM.NARRATION NARRATION, PM.PO_Invoice ORDER_VOUCHER_NO, PM.PO_Sno ORDER_SNO,PM.Tax_Amount TAXABLE_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.V_Rate VAT_RATE, PM.FREE_UNIT_ID FREE_UNIT_ID, PM.FREE_QTY FREE_QTY, PM.StockFree_Qty STOCK_FREE_QTY, PM.ExtraFree_Unit_Id EXTRA_FREE_UNIT_ID, PM.ExtraFree_Qty EXTRA_FREE_QTY, PM.ExtraStockFree_Qty EXTRA_STOCK_FREE_QTY, PM.T_Product IS_TAXABLE, PM.P_Ledger PURCHASE_LEDGER_ID, PM.PR_Ledger RETURN_LEDGER_ID, PM.SZ1 SIZE_1, PM.SZ2 SIZE_2, PM.SZ3 SIZE_3, PM.SZ4 SIZE_4, PM.SZ5 SIZE_5, PM.SZ6 SIZE_6, PM.SZ7 SIZE_7, PM.SZ8 SIZE_8, PM.SZ9 SIZE_9, PM.SZ10 SIZE_10, PM.SERIAL_NO SERIAL_NO, PM.BATCH_NO BATCH_NO, PM.Exp_Date EXPIRY_DATE, PM.Manu_Date MANUFACTURING_DATE
    FROM AMS.PC_Details PM
	     LEFT OUTER JOIN AMS.Product p ON p.PID = PM.P_Id
	     LEFT OUTER JOIN AMS.ProductUnit ppu ON ppu.UID = PM.Unit_Id
	     LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID = PM.Alt_UnitId
	     LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpId = p.PGrpId
	     LEFT OUTER JOIN AMS.ProductSubGroup psg ON psg.PSubGrpId = p.PSubGrpId
	     LEFT OUTER JOIN AMS.Department d ON p.CmpId = d.DId
	     LEFT OUTER JOIN AMS.Godown g ON PM.Gdn_Id = g.GID;');
END;

IF OBJECT_ID('VM.VIEW_PIN_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_PIN_MASTER
	AS
	SELECT PIN_Invoice VOUCHER_NO, PIN_Date VOUCHER_DATE, PIN_Miti VOUCHER_MITI, PERSON PERSON, Sub_Ledger SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sl.GLID, slGl.GLName SUBLEDGER_LEDGER_DESC, slGl.GLCode SUBLEDGER_LEDGER_SHORTNAME, slGl.ACCode SUBLEDGER_LEDGER_ACCOUNTING_CODE, slGl.GLAddress SUBLEDGER_LEDGER_ADDRESS, slGl.PanNo SUBLEDGER_LEDGER_PAN_NO, slGl.CrDays SUBLEDGER_LEDGER_CREDIT_DAYS, slGl.CrLimit SUBLEDGER_LEDGER_CREDIT_LIMIT, slGl.CrTYpe SUBLEDGER_LEDGER_CREDIT_TYPE, slGl.IntRate SUBLEDGER_LEDGER_INTEREST_RATE, slGl.PhoneNo SUBLEDGER_LEDGER_PHONE_NO, slGl.LandLineNo SUBLEDGER_LEDGER_LANDLINE_NO, slGl.OwnerName SUBLEDGER_LEDGER_OWNER_NAME, slGl.OwnerNumber SUBLEDGER_LEDGER_OWNER_NO, slGl.Email SUBLEDGER_LEDGER_EMAIL_ADDRESS, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, PM.EnterBY ENTER_BY, REMARKS REMARKS, PRINT_VALUE PRINT_VALUE, CancelBy CANCEL_BY, CancelDate CANCEL_DATE, CancelRemarks CANCEL_REMARKS, FiscalYearId FISCAL_YEAR_ID, fy.AD_FY, fy.Start_ADDate, fy.End_ADDate, fy.BS_FY, fy.Start_BSDate, fy.End_BSDate, BranchId BRANCH_ID, b.Branch_Name BRANCH_DESC, b.Branch_Code BRANCH_SHORTNAME, b.Address BRANCH_ADDRESS, b.PhoneNo BRANCH_PHONE_NO, b.Email BRANCH_EMAIL, b.ContactPerson BRANCH_CONTACT_PERSON, b.ContactPersonAdd BRANCH_CONTACT_PERSON_ADDRESS, b.ContactPersonPhone BRANCH_CONTACT_PERSON_PHONE_NO, CompanyUnitId COMPANY_UNIT_ID, cu.CmpUnit_Name BUSINESS_UNIT_DESC, cu.CmpUnit_Code BUSINESS_UNIT_SHORTNAME
	FROM AMS.PIN_Master PM
		 LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=PM.Sub_Ledger
		 LEFT OUTER JOIN AMS.GeneralLedger slGl ON slGl.GLID=sl.GLID
		 LEFT OUTER JOIN AMS.Department d ON d.DId=PM.Cls1
		 LEFT OUTER JOIN AMS.FiscalYear fy ON fy.FY_Id=PM.FiscalYearId
		 LEFT OUTER JOIN AMS.Branch b ON b.BRANCH_ID=PM.BranchId
		 LEFT OUTER JOIN AMS.CompanyUnit cu ON cu.CmpUnit_Id=PM.CompanyUnitId');
END;

IF OBJECT_ID('VM.VIEW_PIN_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_PIN_DETAILS
	AS
	SELECT PIN_Invoice VOUCHER_NO, SNO VOUCHER_SNO, P_Id PRODUCT_ID, p.PName PRODUCT_DESC, p.PAlias PRODUCT_ALIS, p.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE, p.PType PRODUCT_TYPE, p.PCategory PRODUCT_CATEGORY, p.PUnit PRODUCT_UNIT, ppu.UnitName PRODUCT_UNIT_DESC, ppu.UnitCode PRODUCT_UNIT_SHORTNAME, ppu.Branch_ID PRODUCT_UNIT_BR_ID, pb.Branch_Name PRO_BR_DESC, pb.Branch_Code PRO_BR_SHORTNAME, pb.Reg_Date PRO_BR_REG_DATE, pb.Address PRO_BR_ADD, pb.Country PRO_BR_COUNTRY, pb.State PRO_BR_STATE, pb.City PRO_BR_CITY, pb.PhoneNo PRO_BR_PHONENO, pb.Fax PRO_BR_FAX, pb.Email PRO_BR_EMAIL, pb.ContactPerson PRO_BR_CT_PERSON, pb.ContactPersonPhone PRO_BR_CT_PHONE, ppu.Company_Id PRO_COMP_ID, pci.Company_Name PRO_COMP_DESC, pci.Company_Logo PRO_COMP_LOGO, pci.CReg_Date PRO_COMP_DATE, pci.Address PRO_COMP_ADDRESS, pci.Country PRO_COMP_COUNTRY, pci.State PRO_COMP_STATE, pci.City PRO_COMP_CITY, pci.PhoneNo PRO_COMP_PHONE_NO, pci.Pan_No PRO_COMP_PAN_NO, pci.Email PRO_COMP_EMAIL, pci.Website PRO_COMP_WEBSITE, pci.Status PRO_COMP_STATUS, pci.CreateDate PRO_COMP_CREATE_DATE, pci.LoginDate PRO_COMP_LOGIN_DATE, pci.SoftModule PRO_COMP_SOFT_MODULE, ppu.EnterBY ENTER_BY, ppu.EnterDate ENTER_DATE, ppu.Status Status, p.PAltUnit PRODUCT_ALT_UNIT, pau.UnitName PRODUCT_ALT_UNIT_DESC, pau.UnitCode PRODUCT_ALT_UNIT_SHORTNAME, pau.Branch_ID PRODUCT_ALT_UNIT_BRANCH_ID, paub.Branch_Name PRO_ALT_UNT_BR_DESC, paub.Branch_Code PRO_ALT_UNT_BR_SHORTNAME, paub.Reg_Date PRO_ALT_UNT_BR_REG_DATE, paub.Address PRO_ALT_UNT_BR_ADDRESS, paub.PhoneNo PRO_ALT_UNT_BR_PHONE, paub.Email PRO_ALT_UNT_BR_EMAIL, paub.ContactPerson PRO_ALT_UNT_BR_CONTACT_PER, paub.ContactPersonAdd PRO_ALT_UNT_BR_CONTACT_PER_DD, paub.ContactPersonPhone PRO_ALT_UNT_BR_CONTACT_PER_PHONE, paub.Created_By PRO_ALT_UNT_BR_CRETD_BY, paub.Created_Date PRO_ALT_UNT_BR_CRETD_DATE, paub.Modify_By PRO_ALT_UNT_BR_MOD_BY, paub.Modify_Date PRO_ALT_UNT_BR_MOD_DATE, pau.Company_Id PRODUCT_ALT_UNT_COMP_ID, pauc.Company_Name PRO_ALT_UNT_COMP_DESC, pauc.Company_Logo PRO_ALT_UNT_COMP_LOGO, pauc.CReg_Date PRO_ALT_UNT_COMP_REG_DATE, pauc.Address PRO_ALT_UNT_COMP_ADDRESS, pauc.PhoneNo PRO_ALT_UNT_COMP_PHONE, pauc.Pan_No PRO_ALT_UNT_COMP_PAN_NO, pauc.Email PRO_ALT_UNT_COMP_EMAIL, pauc.Website PRO_ALT_UNT_COMP_WEBSITE, pauc.Status PRO_ALT_UNT_COMP_STATUS, pauc.CreateDate PRO_ALT_UNT_COMP_CREATE_DATE, pau.EnterBY PRO_ALT_UNT_ENTER_BY, pau.EnterDate PRO_ALT_UNT_ENTER_DATE, pau.Status PRO_ALT_UNT_STATUS, p.PQtyConv PRO_QNTY_CONV, p.PAltConv PRO_ALT_QNTY_CONV, p.PValTech PRO_VAL_TECH, p.PSerialno PRO_SERIAL_NO, p.PSizewise PRO_SIZE_WISE, p.PBatchwise PRO_BATCH_WISE, p.PBuyRate PRO_BUY_RATE, p.PSalesRate PRO_SALES_RATE, p.PMargin1 PRO_MARGIN_ONE, p.TradeRate PRO_TRADE_RATE, p.PMargin2 PRO_MARGIN_TWO, p.PMRP PRO_MARKED_PRICE, p.PGrpId PRO_GRP_ID, pg.GrpName PRO_GRP_DESC, pg.GrpCode PRO_GRP_SHORTNAME, pg.GMargin PRO_GRP_MARGIN, pg.Gprinter PRO_GRP_PRINTER, pg.Branch_ID PRO_GRP_BRANCH_ID, pgb.Branch_Name PRO_GRP_BR_DESC, pgb.Branch_Code PRO_GRP_BR_SHORTNAME, pgb.Reg_Date PRO_GRP_BR_REG_DATE, pgb.Address PRO_GRP_BR_ADDRESS, pgb.PhoneNo PRO_GRP_BR_PHONENO, pgb.Email PRO_GRP_BR_EMAIL, pgb.ContactPerson PRO_GRP_BR_CONTACT_PER, pgb.ContactPersonAdd PRO_GRP_BR_CONTACT_PER_ADD, pgb.ContactPersonPhone PRO_GRP_BR_CONTACT_PER_PH, pgb.Created_By PRO_GRP_BR_CREATED_BY, pgb.Created_Date PRO_GRP_BR_CREATED_DATE, pgb.Modify_By PRO_GRP_BR_MODIFY_BY, pgb.Modify_Date PRO_GRP_MODIFY_DATE, pg.Company_Id PRO_GRP_COMP_ID, pgc.Company_Name PRO_GRP_COMP_DESC, pgc.Company_Logo PRO_GRP_COMP_LOGO, pgc.CReg_Date PRO_GRP_COMP_REG_DATE, pgc.Address PRO_GRP_COMP_ADDRESS, pgc.PhoneNo PRO_GRP_COMP_PHONE_NO, pgc.Pan_No PRO_GRP_COMP_PAN_NO, pgc.Email PRO_GRP_COMP_EMAIL, pgc.Website PRO_GRP_COMP_WEBSITE, pgc.Status PRO_GRP_COMP_STATUS, pgc.CreateDate PRO_GRP_COMP_CREATED_DATE, pgc.LoginDate PRO_GRP_COMP_LOGIN_DATE, pgc.PrintDesc PRO_GRP_COMP_PRINTDESC, pg.Status PRO_GRP_STATUS, pg.EnterBY PRO_GRP_ENTER_BY, pg.EnterDate PRO_GRP_ENTER_DATE, p.PSubGrpId PRODUCT_SUB_GRP_ID, psg.SubGrpName PRODUCT_SUB_GRP_DESC, psg.ShortName PRODUCT_SUB_GRP_SHORTNAME, psg.GrpId PRO_SUB_GRP_ID, psgpg.GrpName PRO_SUB_GRP_DESC, psgpg.GrpCode PRO_SUB_GRP_SHORTNAME, psgpg.GMargin PRO_SUB_GRP_MARGIN, psgpg.Gprinter PRO_SUB_GRP_PRINTER, psgpg.Branch_ID PRO_SUB_GRP_BRANCH_ID, psgpgb.Branch_Name PSG_PRO_GRP_BR_DESC, psgpgb.Branch_Code PSG_PRO_GRP_BR_SHORTNAME, psgpgb.Reg_Date PSG_PRO_GRP_BR_REG_DATE, psgpgb.Address PSG_PRO_GRP_BR_ADDRESS, psgpgb.PhoneNo PSG_PRO_GRP_BR_PHONENO, psgpgb.Fax PSG_PRO_GRP_BR_FAX, psgpgb.Email PSG_PRO_GRP_BR_EMAIL, psgpgb.ContactPerson PSG_PRO_GRP_BR_CONTACT_PER, psgpgb.ContactPersonAdd PSG_PRO_GRP_BR_CONTACT_PER_ADD, psgpgb.ContactPersonPhone PSG_PRO_GRP_BR_CONTACT_PER_PH, psgpgb.Created_By PSG_PRO_GRP_BR_CREATED_BY, psgpgb.Created_Date PSG_PR_GRP_BR_CREATED_DATE, psgpgb.Modify_By PSG_PRO_GRP_BR_MODIFY_BY, psgpgb.Modify_Date PSG_PRO_GRP_BR_MODIFY_DATE, psgpg.Company_Id PSG_PRO_GRP_COMP_ID, psgpgc.Company_Name PSG_PRO_GRP_COMP_DESC, psgpgc.Company_Logo PSG_PRO_GRP_COMP_LOGO, psgpgc.CReg_Date PSG_PRO_GRP_REG_DATE, psgpgc.Address PSG_PRO_GRP_COMP_ADDRESS, psgpgc.PhoneNo PSG_PRO_GRP_COMP_PHONE_NO, psgpgc.Pan_No PSG_PRO_GRP_COMP_PAN_NO, psgpgc.Email PSG_PRO_GRP_COMP_EMAIL, psgpgc.Website PSG_PRO_GRP_COMP_WEBSITE, psgpgc.Version_No PSG_PRO_GRP_COMP_VERSION, psgpgc.Status PSG_PRO_GRP_COMP_STATUS, psgpgc.CreateDate PSG_PRO_GRP_COMP_CREATED_DATE, psgpgc.LoginDate PSG_PRO_GRP_COMP_LOGIN_DATE, psgpg.Status PRO_SUB_GRP_STATUS, psgpg.EnterBY PRO_SUB_GRP_ENTER_BY, psgpg.EnterDate PRO_SUB_GRP_ENTER_DATE, psg.Branch_ID PRODUCT_SUB_GRP_BRANCH_ID, psgb.Branch_Name PRODUCT_SUB_GRP_BR_DESC, psgb.Branch_Code PRODUCT_SUB_GRP_BR_SHORTNAME, psgb.Reg_Date PRO_SUB_GRP_BR_REG_DATE, psgb.Address PRO_SUB_GRP_BR_ADDRESS, psgb.PhoneNo PRO_SUB_GRP_BR_PHONE, psgb.Email PRO_SUB_GRP_BR_EMAIL, psgb.ContactPerson PRO_SUB_GRP_BR_CONTCT_PER, psgb.ContactPersonAdd PRO_SUB_GRP_BR_CONTCT_PER_ADD, psgb.ContactPersonPhone PRO_SUB_GRP_BR_CONTCT_PER_PH, psgb.Created_By PRO_SUB_GRP_BR_CREATED_BY, psgb.Created_Date PRO_SUB_GRP_BR_CREATED_DATE, psgb.Modify_By PRO_SUB_GRP_BR_MODIFY_BY, psgb.Modify_Date PRO_SUB_GRP_BR_MODIFy_DATE, psg.Company_Id PRO_SUB_GRP_COMP_ID, psgc.Company_Name PRO_SUB_GRP_COMP_DESC, psgc.Company_Logo PRO_SUB_GRP_COMP_LOGO, psgc.CReg_Date PRO_SUB_GRP_COMP_REG_DATE, psgc.Address PRO_SUB_GRP_COMP_ADDRESS, psgc.City PRO_SUB_GRP_COMP_CITY, psgc.PhoneNo PRO_SUB_GRP_COMP_PHONE, psgc.Pan_No PRO_SUB_GRP_COMP_PAN, psgc.Email PRO_SUB_GRP_COMP_EMAIL, psgc.Website PRO_SUB_GRP_COMP_WEBSITE, psgc.PrintDesc PRO_SUB_GRP_COMP_PRINTDESC, psg.EnterBY PRO_SUB_GRP_ENTERBY, psg.EnterDate PRO_SUB_GRP_ENTERDATE, psg.Status PRODUCT_SUB_GRP_STATUS, p.PTax PRODUCT_TAX, p.PMin PRO_MIN_QTY, p.PMax PRO_MAX_QTY, p.CMPID CMPID, p.CMPID1 CMPID1, p.CMPID2 CMPID2, p.CmpId3 CmpId3, p.Branch_ID PRODUCT_BR_ID, prb.Branch_Name PRODUCT_BR_DESC, prb.Branch_Code PRODUCT_BR_SHORTNAME, prb.Reg_Date PRODUCT_BR_REG_DATE, prb.Address PRODUCT_BR_ADDRESS, prb.Country PRODUCT_BR_COUNTRY, prb.State PRODUCT_BR_STATE, prb.City PRODUCT_BR_CITY, prb.PhoneNo PRODUCT_BR_PHONE, prb.Fax PRODUCT_BR_FAX, prb.Email PRODUCT_BR_EMAIL, prb.ContactPerson PRODUCT_BR_CONTACT_PER, prb.ContactPersonAdd PRODUCT_BR_CONTACT_PER_ADD, prb.ContactPersonPhone PRODUCT_BR_CONTACT_PER_PHONE, prb.Created_By PRODUCT_BR_CREATED_BY, prb.Created_Date PRODUCT_BR_CREATED_DATE, prb.Modify_By PRODUCT_BR_MODIFY_BY, prb.Modify_Date PRODUCT_BR_MODIFY_DATE, prb.SyncGlobalId PRODUCT_BR_SYNCGLOBALID, prb.SyncOriginId PRODUCT_BR_SYNCORIGINID, prb.SyncCreatedOn PRODUCT_BR_SyncCreatedOn, prb.SyncLastPatchedOn PRODUCT_BR_SYNCLASTPATCHEDON, prb.SyncRowVersion PRODUCT_BR_SYNCROWVERSION, prb.SyncBaseId PRODUCT_BR_SYNCBASEDID, p.CmpUnit_Id PRODUCT_COMP_ID, pcu.CmpUnit_Name PRODUCT_COMP_DESC, pcu.CmpUnit_Code PRODUCT_COMP_SHORTNAME, pcu.Reg_Date PRODUCT_COMP_REGDATE, pcu.Address PRODUCT_COMP_ADDRESS, pcu.Country PRODUCT_COMP_COUNTRY, pcu.State PRODUCT_COMP_STATE, pcu.City PRODUCT_COMP_CITY, pcu.PhoneNo PRODUCT_COMP_PHONE, pcu.Fax PRODUCT_COMP_FAX, pcu.Email PRODUCT_COMP_EMAIL, pcu.ContactPerson PRODUCT_COMP_CONTACT_PER, pcu.ContactPersonAdd PRODUCT_COMP_CONTACT_PER_ADD, pcu.ContactPersonPhone PRODUCT_COMP_CONTACT_PER_PHONE, pcu.Branch_ID PRODUCT_COMP_BRANCH_ID, pcub.Branch_Name PRODUCT_COMP_UNIT_BR_DESC, pcub.Branch_Code PRODUCT_COMP_UNIT_BR_SHORTNAME, pcub.Reg_Date PRODUCT_COMP_UNIT_BR_REG_DATE, pcub.Address PRODUCT_COMP_UNIT_BR_ADDRESS, pcub.Country PRODUCT_COMP_UNIT_BR_COUNTRY, pcub.State PRODUCT_COMP_UNIT_BR_STATE, pcub.City PRODUCT_COMP_UNIT_BR_CITY, pcub.PhoneNo PRODUCT_COMP_UNIT_BR_PHONENO, pcub.Fax PRODUCT_COMP_UNIT_BR_FAX, pcub.Email PRODUCT_COMP_UNIT_BR_EMAIL, pcub.ContactPerson PRODUCT_COMP_UNIT_BR_CONTACT_PER, pcub.ContactPersonAdd PRODUCT_COMP_UNIT_BR_CONTACT_PER_ADD, pcub.ContactPersonPhone PRODUCT_COMP_UNIT_BR_CONTACT_PER_PHONE, pcub.Created_By PRODUCT_COMP_UNIT_BR_CREATED_BY, pcub.Created_Date PRODUCT_COMP_UNIT_BR_CREATED_DATE, pcub.Modify_By PRODUCT_COMP_UNIT_BR_MODIFIED_BY, pcub.Modify_Date PRODUCT_COMP_UNIT_BR_MODIFIED_DATE, pcu.Created_By PRODUCT_COMP_CREATED_BY, pcu.Created_Date PRODUCT_COMP_CREATED_DATE, p.PPL PPL, p.PPR PPR, p.PSL PSL, p.PSR PSR, p.PL_OPENING PL_OPENING, p.PL_CLOSING PL_CLOSING, p.BS_CLOSING BS_CLOSING, p.PImage PRODUCT_PIMAGE, p.EnterBY PRODUCT_ENTERBY, p.EnterDate PORDUCT_ENTERDATE, p.Status PRODUCT_STATUS, p.BeforeBuyRate PRODUCT_BEFOREBUYRATE, p.BeforeSalesRate PRODUCT_BEFORESALESRATE, p.Barcode PRODUCT_BARCODE, p.ChasisNo PRODUCT_CHASISNO, p.EngineNo PRODUCT_ENGINENO, p.VHColor PRODUCT_VEHICLE_COLOR, p.VHModel PRODUCT_VEHICLE_MODEL, p.VHNumber PRODUCT_VEHICLE_NUMBER, p.Barcode1 PRODUCT_BARCODE1, p.Barcode2 PRODUCT_BARCODE2, p.Barcode3 PRODUCT_BARCODE3, Gdn_Id GODOWN_ID, g.GName GDN_DESC, g.GCode GDN_SHORTNAME, g.GLocation GDN_LOCATION, Alt_Qty ALTERNATE_QUANTITY, Alt_Unit PRO_ALT_UNIT_ID, pau.UnitName ALT_UNIT_DESC, pau.UnitCode ALT_UNIT_SHORTNAME, Qty QUANTITY, Unit PRO_UNIT_ID, pu1.UnitName UNIT_DESC, pu1.UnitCode UNIT_SHORTNAME, AltStock_Qty ALTERNATE_STOCK_QUANTITY, StockQty STOCK_QUANTITY, Issue_Qty ISSUE_QUANTITY, NARRATION NARRATION
	FROM AMS.PIN_Details PM
		 LEFT OUTER JOIN AMS.Product p ON p.PID=PM.P_Id
		 LEFT OUTER JOIN AMS.ProductUnit ppu ON ppu.UID=p.PUnit
		 LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID=p.PAltUnit
		 LEFT OUTER JOIN AMS.Branch pb ON pb.Branch_ID=ppu.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo pci ON pci.Company_Id=ppu.Company_Id
		 LEFT OUTER JOIN AMS.Branch paub ON paub.Branch_ID=pau.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo pauc ON pauc.Company_Id=pau.Company_Id
		 LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpId=p.PGrpId
		 LEFT OUTER JOIN AMS.Branch pgb ON pgb.Branch_ID=pg.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo pgc ON pgc.Company_Id=pg.Company_Id
		 LEFT OUTER JOIN AMS.ProductSubGroup psg ON psg.PSubGrpId=p.PSubGrpId
		 LEFT OUTER JOIN AMS.ProductGroup psgpg ON psgpg.PGrpId=psg.GrpId
		 LEFT OUTER JOIN AMS.Branch psgpgb ON psgpgb.Branch_ID=psgpg.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo psgpgc ON psgpgc.Company_Id=psgpg.Company_Id
		 LEFT OUTER JOIN AMS.Branch psgb ON psgb.Branch_ID=psg.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo psgc ON psgc.Company_Id=psg.Company_Id
		 LEFT OUTER JOIN AMS.Branch prb ON prb.Branch_ID=p.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyUnit pcu ON pcu.CmpUnit_Id=p.CmpUnit_Id
		 LEFT OUTER JOIN AMS.Branch pcub ON pcub.Branch_ID=pcu.Branch_ID
		 LEFT OUTER JOIN AMS.Godown g ON g.GID=PM.Gdn_Id
		 LEFT OUTER JOIN AMS.ProductUnit pu ON pu.UID=PM.Alt_Unit
		 LEFT OUTER JOIN AMS.ProductUnit pu1 ON pu1.UID=PM.Unit');
END;

IF OBJECT_ID('VM.VIEW_SR_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SR_MASTER
	AS
	SELECT sm.SR_Invoice VOUCHER_NO, CONVERT(varchar(10),sm.Invoice_Date,103) VOUCHER_DATE, sm.Invoice_Miti VOUCHER_MITI, sm.Invoice_Time VOUCHER_TIME, sm.SB_Invoice REF_VOUCHER_NO, sm.SB_Date REF_VOUCHER_DATE, sm.SB_Miti REF_VOUCHER_MITI, sm.Customer_ID LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode ACCOUNTING_CODE, gl.GLType LEDGER_TYPE, gl.GrpId ACCOUNT_GROUP_ID, ag.GrpName GROUP_DESC, ag.GrpCode GROUP_SHORTNAME, ag.Schedule GROUP_SCHEDULE, ag.NepaliDesc LEDGER_NEPALI, gl.SubGrpId ACCOUNT_SUB_GROUP_ID, asg.SubGrpName SUB_GROUP_DESC, asg.SubGrpCode SUB_GROUP_SHORTNAME, gl.PanNo LEDGER_PAN, gl.AreaId LEDGER_AREA_ID, gl.AgentId LEDGER_AGENT_ID, gl.CurrId lEDGER_CURRENCY_ID, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.GLAddress LEDGER_ADDRESS, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LAND_LINE_NO, gl.OwnerName LEDGER_OWNER_DESC, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL, sm.Party_Name PARTY_DESC, sm.Vat_No PARTY_VAT_NO, sm.Contact_Person PARTY_CONTACT_PERSON, sm.Mobile_No PARTY_MOBILE_NO, sm.Address PARTY_ADDRESS, sm.ChqNo PARTY_CHEQUE_NO, sm.ChqDate PARTY_CHEQUE_DATE, sm.Invoice_Type VOUCHER_TYPE, sm.Invoice_Mode VOUCHER_MODE, sm.PAYMENT_MODE PAYMENT_MODE, sm.DueDays VOUCHER_DUE_DAYS, sm.DueDate VOUCHER_DUE_DATE, sm.AGENT_ID AGENT_ID, ja.AgentName AGENT_DESC, ja.AgentCode AGENT_SHORTNAME, ja.Address AGENT_ADDRESS, ja.PhoneNo AGENT_PHONE_NO, sm.SUBLEDGER_ID SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sm.Cls1 DEPATMENT_ID, D.DName DEPARTMENT_DESC, D.DCode DEPATMENT_SHORTNAME, sm.Cls2 DEPARTMENT_ID_2, sm.Cls3 DEPARTMENT_ID_3, sm.Cls4 DEPARTMENT_ID_4, sm.CounterId COUNTER_ID, C.CName COUNTER_DESC, C.Ccode COUNTER_SHORTNAME, sm.Cur_Id CURRENCY_ID, cc.CName CURRENCY_DESC, cc.Ccode CURRENCY_SHORTNAME, sm.Cur_Rate CURRENCY_RATE, sm.B_Amount BASIC_AMOUNT, sm.T_Amount TERM_AMOUNT, sm.N_Amount NET_AMOUNT, sm.LN_Amount LOCAL_NET_AMOUNT, sm.V_Amount VAT_AMOUNT, sm.Tbl_Amount TAXABLE_AMOUNT, sm.TENDER_AMOUNT TENDER_AMOUNT, sm.RETURN_AMOUNT RETURN_AMOUNT, sm.ACTION_TYPE ACTION_TYPE, sm.In_Words NUM_IN_WORDS, sm.REMARKS REMARKS, sm.R_Invoice IS_CANCEL, sm.IS_PRINTED IS_PRINTED, sm.No_Print NO_OF_PRINT, sm.PRINTED_BY PRINTED_BY, sm.PRINTED_DATE PRINTED_DATE, sm.Audit_Lock IS_LOCK, sm.ENTER_BY ENTER_BY, sm.ENTER_DATE ENTER_DATE, sm.RECONCILE_BY RECONCILE_BY, sm.RECONCILE_DATE RECONCILE_DATE, sm.Auth_By AUTHORIZED_BY, sm.Auth_Date AUTHORIZED_DATE, sm.Cleared_By CLEARING_BY, sm.Cleared_Date CLEARING_DATE, sm.CANCEL_BY CANCEL_BY, sm.CANCEL_DATE CANCEL_DATE, sm.CANCEL_REMARKS CANCEL_REMARKS, sm.CUnit_Id COMPANY_UNIT_ID, CU.CmpUnit_Name COMPANY_UNIT_DESC, CU.CmpUnit_Code COMPANY_UNIT_SHORTNAME, sm.CBranch_Id BRANCH_UNIT_ID, B.Branch_Name BRANCH_DESC, B.Branch_Code BRANCH_SHORTNAME, sm.IsAPIPosted IS_API_POSTED, sm.IsRealtime IS_REAL_TIME, sm.FiscalYearId FISCAL_YEAR_ID
	FROM AMS.SR_Master sm
		 LEFT OUTER JOIN AMS.GeneralLedger gl ON sm.Customer_ID=gl.GLID
		 LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId
		 LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId
		 LEFT OUTER JOIN AMS.JuniorAgent ja ON sm.AGENT_ID=ja.AgentId
		 LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=sm.SUBLEDGER_ID
		 LEFT OUTER JOIN AMS.Department D ON D.DId=sm.Cls1
		 LEFT OUTER JOIN AMS.Counter C ON C.CId=sm.CounterId
		 LEFT OUTER JOIN AMS.Currency cc ON cc.CId=sm.Cur_Id
		 LEFT OUTER JOIN AMS.CompanyUnit CU ON CU.CmpUnit_Id=sm.CUnit_Id
		 LEFT OUTER JOIN AMS.Branch B ON B.Branch_ID=sm.CBranch_Id
		 LEFT OUTER JOIN AMS.FiscalYear fy ON sm.FiscalYearId=fy.FY_Id;');
END;

IF OBJECT_ID('VM.VIEW_SR_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SR_DETAILS
	AS
	SELECT SR_Invoice VOUCHER_NO, INVOICE_SNO VOUCHER_SNO, P_Id PRODUCT_ID, P.PName PRODUCT_DESC, P.PAlias PRODUCT_ALIAS, P.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE, P.PType PRODUCT_TYPE, P.PCategory PRODUCT_CATEGORY, P.PUnit PRODUCT_UNIT_ID, pu.UnitCode UNIT_CODE, pu.UnitName UNIT_DESC, P.PAltUnit PRODUCT_ALT_UNIT_ID, pau.UnitCode ALT_UNIT_CODE, pau.UnitName ALT_UNIT_DESC, P.PValTech PRODUCT_VAL_TECH, P.PBuyRate PRODUCT_BUY_RATE, P.PSalesRate PRODUCT_SALES_RATE, P.PMargin1 PRODUCT_MARGIN_RATE, P.TradeRate PRODUCT_TRADE_RATE, P.PMargin2 PRODUCT_MARGIN_2, P.PMRP PRODUCT_MRP_RATE, P.PGrpId PRODUCT_GROUP_ID, P.PSubGrpId PRODUCT_SUB_GROUP_ID, P.PTax PRODUCT_TAX_RATE, P.PMin PRODUCT_MIN_STOCK_QTY, P.PMax PRODUCT_MAX_STOCK_QTY, P.CmpId PRODUCT_DEPARTMENT_ID, P.ChasisNo VEHICLE_CHASIS_NO, P.VHModel VEHICLE_MODEL_NO, P.VHColor VEHICLE_COLOR, P.EngineNo VEHICLE_ENGINE_NO, P.VHNumber VEHICLE_NUMBER, P.BeforeBuyRate PRODUCT_BEFORE_BUY_RATE, P.BeforeSalesRate PRODUCT_BEFORE_SALES_RATE, P.Barcode PRODUCT_BARCODE, P.Barcode1 PRODUCT_BARCODE_1, P.Barcode2 PRODUCT_BARCODE_2, P.Barcode3 PRODUCT_BARCODE_3, Gdn_Id GODOWN_ID, g.GName GODOWN_DESC, g.GCode GODOWN_SHORTNAME, ALT_QTY ALT_QTY, Alt_UnitId ALT_UNIT_ID, pau.UnitCode ALT_UOM, QTY QTY, UNIT_ID UNIT_ID, pu.UnitCode UOM, Rate INVOICE_RATE, B_Amount BASIC_AMOUNT, T_Amount TERM_AMOUNT, N_Amount NET_AMOUNT, AltStock_Qty ALT_STOCK_QTY, STOCK_QTY STOCK_QTY, NARRATION NARRATION, SB_Invoice INVOICE_VOUCHER_NO, SB_Sno INVOICE_SNO, Tax_Amount TAXABLE_AMOUNT, V_Amount VAT_AMOUNT, V_Rate TAX_RATE, Free_Unit_Id FREE_QTY_UNIT_ID, FREE_QTY FREE_QTY, StockFree_Qty STOCK_FREE_QTY, ExtraFree_Unit_Id EXTRA_FREE_UNIT_ID, ExtraFree_Qty EXTRA_FREE_QTY, ExtraStockFree_Qty EXTRA_STOCK_FREE_QTY, T_Product IS_TAXABLE, S_Ledger SALES_LEDGER_ID, SR_Ledger SALES_RETURN_LEDGER_ID, SZ1 SIZE_1, SZ2 SIZE_2, SZ3 SIZE_3, SZ4 SIZE_4, SZ5 SIZE_5, SZ6 SIZE_6, SZ7 SIZE_7, SZ8 SIZE_8, SZ9 SIZE_9, SZ10 SIZE_10, SERIAL_NO SERIAL_NO, BATCH_NO BATCH_NO, Exp_Date EXPIRY_DATE, Manu_Date MANUFACTURING_DATE, PDiscountRate DISCONT_RATE_ON_PRODUCT, PDiscount DISCOUNT_ON_PRODUCT, BDiscountRate BILL_DISCOUNT_RATE_ON_PRODUCT, BDiscount BILL_DISCOUNT_ON_PRODUCT, ServiceChargeRate SERVICE_CHARGE_RATE_ON_PRODUCT, ServiceCharge SERIVCE_CHARGE_ON_PRODUCT
	FROM AMS.SR_Details sd
		 LEFT OUTER JOIN AMS.Product P ON P.PID=sd.P_Id
		 LEFT OUTER JOIN AMS.ProductUnit pu ON pu.UID=P.PUnit
		 LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID=P.PAltUnit
		 LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpId=P.PGrpId
		 LEFT OUTER JOIN AMS.ProductSubGroup PSG ON PSG.GrpId=pg.PGrpId
		 LEFT OUTER JOIN AMS.Godown g ON g.GID=sd.Gdn_Id;');
END;

IF OBJECT_ID('VM.VIEW_SR_MASTER_OTHER_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SR_MASTER_OTHER_DETAILS
	AS
	SELECT PM.SR_Invoice VOUCHER_NO, TRANSPORT TRANSPORT, VechileNo VECHILE_NO, BiltyNo BILTY_NO, PACKAGE PACKAGE, BILTYDATE BILTYDATE, BiltyType BILTY_TYPE, Driver VEHICLE_DRIVER, PhoneNo DRIVER_PHONE_NO, LicenseNo DRIVER_LICENSE_NO, MailingAddress MAILING_ADDRESS, MCity M_CITY, MState M_STATE, MCountry M_COUNTRY, MEmail M_EMAIL, ShippingAddress SHIPPING_ADDRESS, SCity SHIPPING_CITY, SState SHIPPING_STATE, SCountry SHIPPING_COUNTRY, SEmail SHIPPING_EMAIL, ContractNo CONTRACT_NO, ContractDate CONTRACT_DATE, ExportInvoice EXPORT_INVOICE, ExportInvoiceDate EXPORT_INVOICE_DATE, VendorOrderNo VENDOR_ORDER_NO, BankDetails BANK_DETAILS, LcNumber LC_NUMBER, CustomDetails CUSTOM_DETAILS
	FROM AMS.SR_Master_OtherDetails PM
		 LEFT OUTER JOIN AMS.SR_Master sbm ON sbm.SR_Invoice = PM.SR_Invoice');
END;

IF OBJECT_ID('VM.VIEW_SO_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SO_MASTER
	AS
	SELECT SO_Invoice VOUCHER_NO, PM.Invoice_Date VOUCHER_DATE, PM.Invoice_Miti VOUCHER_MITI, PM.Invoice_Time VOUCHER_TIME, PM.REF_VNO REF_VNO, Ref_Date REF_VNO_DATE, Ref_Miti REF_VNO_MITI, PM.Customer_Id LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CrLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrTYpe LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, gl.SubGrpId LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME, PM.Party_Name PARTY_DESC, PM.Vat_No PARTY_TPAN_NO, PM.CONTACT_PERSON CONTACT_PERSON, PM.Mobile_No PARTY_MOBILE_NO, PM.Address PARTY_ADDRESS, PM.ChqNo CHEQUE_NO, PM.ChqDate CHEQUE_DATE, PM.INVOICE_TYPE INVOICE_TYPE, PM.Invoice_Mode VOUCHER_MODE, PM.PAYMENT_MODE PAYMENT_MODE, PM.DueDays DUE_DAYS, PM.DueDate DUE_DATE, PM.Agent_Id SALES_MAN_ID, ja.AgentName SALES_MAN, ja.AgentCode SALES_MAN_SHORTNAME, ja.Address SALES_MAN_ADDRESS, ja.PhoneNo SALES_MAN_PHONE_NO, ja.Email SALES_MAN_EMAIL, ja.Commission SALES_MAN_COMMISSION, ja.CrLimit SALES_MAN_CREDIT_LIMIT, ja.CrDays SALES_MAN_CREDIT_DAYS, ja.CrTYpe SALES_MAN_CREDIT_TYPE, ja.GLCode SALES_MAN_LEDGER_ID, jaGl.GLName AGENT_LEDGER_DESC, jaGl.GLCode AGENT_LEDGER_SHORTNAME, jaGl.ACCode AGENT_LEDGER_ACCOUNTING_CODE, jaGl.GLAddress AGENT_LEDGER_ADDRESS, jaGl.PanNo AGENT_LEDGER_PAN_NO, jaGl.CrDays AGENT_LEDGER_CREDIT_DAYS, jaGl.CrLimit AGENT_LEDGER_CREDIT_LIMIT, jaGl.CrTYpe AGENT_LEDGER_CREDIT_TYPE, jaGl.IntRate AGENT_LEDGER_INTEREST_RATE, jaGl.PhoneNo AGENT_LEDGER_PHONE_NO, jaGl.LandLineNo AGENT_LEDGER_LANDLINE_NO, jaGl.OwnerName AGENT_LEDGER_OWNER_NAME, jaGl.OwnerNumber AGENT_LEDGER_OWNER_NO, jaGl.Email AGENT_LEDGER_EMAIL_ADDRESS, ja.SAgent MAIN_SALES_MAN_ID, ja.AgentName MAIN_SALES_MAN, ja.AgentCode MAIN_SALES_MAN_SHORTNAME, ja.Address MAIN_SALES_MAN_ADDRESS, ja.PhoneNo MAIN_SALES_MAN_PHONE_NO, ja.Email MAIN_SALES_MAN_EMAIL, ja.Commission MAIN_SALES_MAN_COMMISSION, ja.CrLimit MAIN_SALES_MAN_CREDIT_LIMIT, ja.CrDays MAIN_SALES_MAN_CREDIT_DAYS, ja.CrTYpe MAIN_SALES_MAN_CREDIT_TYPE, ja.GLCode MAIN_SALES_MAN_LEDGER_ID, SaGl.GLName MAIN_AGENT_LEDGER_DESC, SaGl.GLCode MAIN_AGENT_LEDGER_SHORTNAME, SaGl.ACCode MAIN_AGENT_LEDGER_ACCOUNTING_CODE, SaGl.GLAddress MAIN, PM.SUBLEDGER_ID SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sl.GLID, slGl.GLName SUBLEDGER_LEDGER_DESC, slGl.GLCode SUBLEDGER_LEDGER_SHORTNAME, slGl.ACCode SUBLEDGER_LEDGER_ACCOUNTING_CODE, slGl.GLAddress SUBLEDGER_LEDGER_ADDRESS, slGl.PanNo SUBLEDGER_LEDGER_PAN_NO, slGl.CrDays SUBLEDGER_LEDGER_CREDIT_DAYS, slGl.CrLimit SUBLEDGER_LEDGER_CREDIT_LIMIT, slGl.CrTYpe SUBLEDGER_LEDGER_CREDIT_TYPE, slGl.IntRate SUBLEDGER_LEDGER_INTEREST_RATE, slGl.PhoneNo SUBLEDGER_LEDGER_PHONE_NO, slGl.LandLineNo SUBLEDGER_LEDGER_LANDLINE_NO, slGl.OwnerName SUBLEDGER_LEDGER_OWNER_NAME, slGl.OwnerNumber SUBLEDGER_LEDGER_OWNER_NO, slGl.Email SUBLEDGER_LEDGER_EMAIL_ADDRESS, PM.IND_Invoice INDENT_VOUCHER, PM.IND_Date INDENT_VOUCHER_DATE, pinma.PIN_Miti, QOT_Invoice QUOTATION_VOUCHER, QOT_Date QUOTATION_VOUCHER_DATE, PM.Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, PM.Cls2 DEPARTMENT_2DN, PM.Cls3 DEPARTMENT_3RD, PM.Cls4 DEPARTMENT_4TH, CounterId COUNTER_ID, c1.CName COUNTER_DESC, c1.Ccode COUNTER_CODE, c1.BRANCH_ID COUNTER_BRANCH_ID, Cb.Branch_Name COUNTER_BRANCH_DESC, Cb.Branch_Code COUNTER_BRANCH_SHORTNAME, Cb.Address COUNTER_BRANCH_ADDRESS, Cb.PhoneNo COUNTER_BRANCH_PHONE_NO, Cb.Email COUNTER_BRANCH_EMAIL, Cb.ContactPerson COUNTER_BRANCH_CONTACT_PERSON, Cb.ContactPersonAdd COUNTER_BRANCH_CONTACT_PERSON_ADDRESS, Cb.ContactPersonPhone COUNTER_BRANCH_CONTACT_PERSON_PHONE_NO, c1.Company_Id COUNTER_COMPANY_ID, cci.Company_Name COUNTER_COMPANY_DESC, cci.Company_Logo COUNTER_COMPANY_LOGO, cci.CReg_Date COUNTER_COMPANY_REG_DATE, cci.Address COUNTER_COMPANY_ADDRESS, cci.PhoneNo COUNTER_COMPANY_PHONE, cci.Fax COUNTER_COMPANY_FAX, cci.Pan_No COUNTER_COMPANY_PAN, cci.Email COUNTER_COMPANY_EMAIL, cci.Website COUNTER_COMPANY_WEBSITE, c1.EnterBy COUNTER_COMPANY_ENTERBY, PM.TableId TABLE_ID, t.TableName TABLE_DESC, t.TableCode TABLE_SHORTNAME, t.FloorId TABLE_FLOOR_ID, f.Description TABLE_FLOOR_DESC, f.ShortName TABLE_FLOOR_SHORTNAME, f.Type TABLE_FLOOR_TYPE, f.EnterBy TABLE_FLOOR_ENTER_BY, f.BRANCH_ID FLOOR_BRANCH_ID, fb.Branch_Name FLOOR_BRANCH_DESC, fb.Branch_Code FLOOR_BRANCH_SHORTNAME, fb.Address FLOOR_BRANCH_ADDRESS, fb.PhoneNo FLOOR_BRANCH_PHONE_NO, fb.Email FLOOR_BRANCH_EMAIL, fb.ContactPerson FLOOR_BRANCH_CONTACT_PERSON, fb.ContactPersonAdd FLOOR_BRANCH_CONTACT_PERSON_ADDRESS, fb.ContactPersonPhone FLOOR_BRANCH_CONTACT_PERSON_PHONE_NO, f.Company_Id FLOOR_COMPANY_ID, fci.Company_Name FLOOR_COMPANY_DESC, fci.Company_Logo FLOOR_COMPANY_LOGO, fci.CReg_Date FLOOR_COMPANY_REG_DATE, fci.Address FLOOR_COMPANY_ADDRESS, fci.PhoneNo FLOOR_COMPANY_PHONE, fci.Fax FLOOR_COMPANY_FAX, fci.Pan_No FLOOR_COMPANY_PAN, fci.Email FLOOR_COMPANY_EMAIL, fci.Website FLOOR_COMPANY_WEBSITE, f.Status TABLE_FLOOR_STATUS, t.BRANCH_ID TABLE_BRANCH_ID, tfb.Branch_Name TABLE_BRANCH_DESC, tfb.Branch_Code TABLE_BRANCH_SHORTNAME, tfb.Address TABLE_BRANCH_ADDRESS, tfb.PhoneNo TABLE_BRANCH_PHONE_NO, tfb.Email TABLE_BRANCH_EMAIL, tfb.ContactPerson TABLE_BRANCH_CONTACT_PERSON, tfb.ContactPersonAdd TABLE_BRANCH_CONTACT_PERSON_ADDRESS, tfb.ContactPersonPhone TABLE_BRANCH_CONTACT_PERSON_PHONE_NO, t.Company_Id TABLE_COMPANY_ID, tci.Company_Name TABLE_COMPANY_DESC, tci.Company_Logo TABLE_COMPANY_LOGO, tci.CReg_Date TABLE_COMPANY_REG_DATE, tci.Address TABLE_COMPANY_ADDRESS, tci.PhoneNo TABLE_COMPANY_PHONE, tci.Fax TABLE_COMPANY_FAX, tci.Pan_No TABLE_COMPANY_PAN, tci.Email TABLE_COMPANY_EMAIL, tci.Website TABLE_COMPANY_WEBSITE, t.TableStatus TABLE_STATUS, t.EnterBy TABLE_ENTER_BY, t.EnterDate TABLE_ENTER_DATE, t.TableType TABLE_TABLE_TYPE, t.Printed TABLE_PRINTED, t.IsPrePaid TABLE_IS_PAID, NoOfPerson NUMBER_OF_PACKS, PM.Cur_Id CURRENCY_ID, C.CName CURRENCY_NAME, C.Ccode CURRENCY_SHORTNAME, C.CRate CURRENCY_RATE, PM.Cur_Rate EXCHANGE_RATE, PM.B_Amount BASIC_AMOUNT, PM.T_Amount TERM_AMOUNT, PM.N_Amount NET_AMOUNT, PM.LN_Amount LOCAL_NET_AMOUNT, PM.V_Amount VAT_AMOUNT, PM.Tbl_Amount TAXABLE_AMOUNT, PM.TENDER_AMOUNT TENDER_AMOUNT, PM.RETURN_AMOUNT RETURN_AMOUNT, PM.ACTION_TYPE ACTION_TYPE, PM.IN_WORDS IN_WORDS, PM.REMARKS REMARKS, PM.R_Invoice REVERSE_VOUCHER, PM.IS_PRINTED IS_PRINTED, PM.No_Print NUMBER_OF_PRINT, PM.PRINTED_BY PRINTED_BY, PM.PRINTED_DATE PRINTED_DATE, PM.CUnit_Id COMPANY_UNIT_ID, cu.CmpUnit_Name BUSINESS_UNIT_DESC, cu.CmpUnit_Code BUSINESS_UNIT_SHORTNAME, PM.CBranch_Id BRANCH_ID, b.Branch_Name BRANCH_DESC, b.Branch_Code BRANCH_SHORTNAME, b.Address BRANCH_ADDRESS, b.PhoneNo BRANCH_PHONE_NO, b.Email BRANCH_EMAIL, b.ContactPerson BRANCH_CONTACT_PERSON, b.ContactPersonAdd BRANCH_CONTACT_PERSON_ADDRESS, b.ContactPersonPhone BRANCH_CONTACT_PERSON_PHONE_NO, PM.FiscalYearId FISCAL_YEAR_ID, fy.AD_FY, fy.Start_ADDate, fy.End_ADDate, fy.BS_FY, fy.Start_BSDate, fy.End_BSDate, PM.ENTER_BY ENTER_BY
	FROM AMS.SO_Master PM
			LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=PM.Customer_Id
			LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId
			LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId
			LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId
			LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId
			LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area
			LEFT OUTER JOIN AMS.Currency C ON C.CId=PM.Cur_Id
			LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId
			LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=PM.SUBLEDGER_ID
			LEFT OUTER JOIN AMS.GeneralLedger slGl ON slGl.GLID=sl.GLID
			LEFT OUTER JOIN AMS.JuniorAgent ja ON ja.AgentId=PM.Agent_Id
			LEFT OUTER JOIN AMS.GeneralLedger jaGl ON jaGl.GLID=ja.GLCode
			LEFT OUTER JOIN AMS.SeniorAgent sa ON sa.SAgentId=ja.SAgent
			LEFT OUTER JOIN AMS.GeneralLedger SaGl ON SaGl.GLID=ja.GLCode
			LEFT OUTER JOIN AMS.Branch b ON b.BRANCH_ID=PM.CBranch_Id
			LEFT OUTER JOIN AMS.CompanyUnit cu ON cu.CmpUnit_Id=PM.CUnit_Id
			LEFT OUTER JOIN AMS.FiscalYear fy ON fy.FY_Id=PM.FiscalYearId
			LEFT OUTER JOIN AMS.Department d ON d.DId=PM.Cls1
			LEFT OUTER JOIN AMS.Counter c1 ON c1.CId=PM.CounterId
			LEFT OUTER JOIN AMS.Branch Cb ON Cb.BRANCH_ID=c1.BRANCH_ID
			LEFT OUTER JOIN AMS.CompanyInfo cci ON cci.Company_Id=c1.Company_Id
			LEFT OUTER JOIN AMS.TableMaster t ON t.TableId=PM.TableId
			LEFT OUTER JOIN AMS.Floor f ON f.FloorId=t.FloorId
			LEFT OUTER JOIN AMS.Branch fb ON fb.BRANCH_ID=f.BRANCH_ID
			LEFT OUTER JOIN AMS.CompanyInfo fci ON fci.Company_Id=f.Company_Id
			LEFT OUTER JOIN AMS.Branch tfb ON fb.BRANCH_ID=t.BRANCH_ID
			LEFT OUTER JOIN AMS.CompanyInfo tci ON tci.Company_Id=t.Company_Id
			LEFT OUTER JOIN AMS.PIN_Master pinma ON pinma.PIN_Invoice=PM.IND_Invoice');
END;

IF OBJECT_ID('VM.VIEW_SO_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SO_DETAILS
	AS
	SELECT SO_Invoice VOUCHER_NO, Invoice_SNo VOUCHER_SNO, P_Id PRODUCT_ID, p.PName PRODUCT_DESC, p.PAlias PRODUCT_ALIS, p.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE, p.PType PRODUCT_TYPE, p.PCategory PRODUCT_CATEGORY, p.PUnit PRODUCT_UNIT, ppu.UnitName PRODUCT_UNIT_DESC, ppu.UnitCode PRODUCT_UNIT_SHORTNAME, ppu.Branch_ID PRODUCT_UNIT_BR_ID, pb.Branch_Name PRO_BR_DESC, pb.Branch_Code PRO_BR_SHORTNAME, pb.Reg_Date PRO_BR_REG_DATE, pb.Address PRO_BR_ADD, pb.Country PRO_BR_COUNTRY, pb.State PRO_BR_STATE, pb.City PRO_BR_CITY, pb.PhoneNo PRO_BR_PHONENO, pb.Fax PRO_BR_FAX, pb.Email PRO_BR_EMAIL, pb.ContactPerson PRO_BR_CT_PERSON, pb.ContactPersonPhone PRO_BR_CT_PHONE, ppu.Company_Id PRO_COMP_ID, pci.Company_Name PRO_COMP_DESC, pci.Company_Logo PRO_COMP_LOGO, pci.CReg_Date PRO_COMP_DATE, pci.Address PRO_COMP_ADDRESS, pci.Country PRO_COMP_COUNTRY, pci.State PRO_COMP_STATE, pci.City PRO_COMP_CITY, pci.PhoneNo PRO_COMP_PHONE_NO, pci.Pan_No PRO_COMP_PAN_NO, pci.Email PRO_COMP_EMAIL, pci.Website PRO_COMP_WEBSITE, pci.Status PRO_COMP_STATUS, pci.CreateDate PRO_COMP_CREATE_DATE, pci.LoginDate PRO_COMP_LOGIN_DATE, pci.SoftModule PRO_COMP_SOFT_MODULE, ppu.EnterBy ENTER_BY, ppu.EnterDate ENTER_DATE, ppu.Status Status, p.PAltUnit PRODUCT_ALT_UNIT, pau.UnitName PRODUCT_ALT_UNIT_DESC, pau.UnitCode PRODUCT_ALT_UNIT_SHORTNAME, pau.Branch_ID PRODUCT_ALT_UNIT_BRANCH_ID, paub.Branch_Name PRO_ALT_UNT_BR_DESC, paub.Branch_Code PRO_ALT_UNT_BR_SHORTNAME, paub.Reg_Date PRO_ALT_UNT_BR_REG_DATE, paub.Address PRO_ALT_UNT_BR_ADDRESS, paub.PhoneNo PRO_ALT_UNT_BR_PHONE, paub.Email PRO_ALT_UNT_BR_EMAIL, paub.ContactPerson PRO_ALT_UNT_BR_CONTACT_PER, paub.ContactPersonAdd PRO_ALT_UNT_BR_CONTACT_PER_DD, paub.ContactPersonPhone PRO_ALT_UNT_BR_CONTACT_PER_PHONE, paub.Created_By PRO_ALT_UNT_BR_CRETD_BY, paub.Created_Date PRO_ALT_UNT_BR_CRETD_DATE, paub.Modify_By PRO_ALT_UNT_BR_MOD_BY, paub.Modify_Date PRO_ALT_UNT_BR_MOD_DATE, pau.Company_Id PRODUCT_ALT_UNT_COMP_ID, pauc.Company_Name PRO_ALT_UNT_COMP_DESC, pauc.Company_Logo PRO_ALT_UNT_COMP_LOGO, pauc.CReg_Date PRO_ALT_UNT_COMP_REG_DATE, pauc.Address PRO_ALT_UNT_COMP_ADDRESS, pauc.PhoneNo PRO_ALT_UNT_COMP_PHONE, pauc.Pan_No PRO_ALT_UNT_COMP_PAN_NO, pauc.Email PRO_ALT_UNT_COMP_EMAIL, pauc.Website PRO_ALT_UNT_COMP_WEBSITE, pauc.Status PRO_ALT_UNT_COMP_STATUS, pauc.CreateDate PRO_ALT_UNT_COMP_CREATE_DATE, pau.EnterBy PRO_ALT_UNT_ENTER_BY, pau.EnterDate PRO_ALT_UNT_ENTER_DATE, pau.Status PRO_ALT_UNT_STATUS, p.PQtyConv PRO_QNTY_CONV, p.PAltConv PRO_ALT_QNTY_CONV, p.PValTech PRO_VAL_TECH, p.PSerialno PRO_SERIAL_NO, p.PSizewise PRO_SIZE_WISE, p.PBatchwise PRO_BATCH_WISE, p.PBuyRate PRO_BUY_RATE, p.PSalesRate PRO_SALES_RATE, p.PMargin1 PRO_MARGIN_ONE, p.TradeRate PRO_TRADE_RATE, p.PMargin2 PRO_MARGIN_TWO, p.PMRP PRO_MARKED_PRICE, p.PGrpId PRO_GRP_ID, pg.GrpName PRO_GRP_DESC, pg.GrpCode PRO_GRP_SHORTNAME, pg.GMargin PRO_GRP_MARGIN, pg.Gprinter PRO_GRP_PRINTER, pg.Branch_ID PRO_GRP_BRANCH_ID, pgb.Branch_Name PRO_GRP_BR_DESC, pgb.Branch_Code PRO_GRP_BR_SHORTNAME, pgb.Reg_Date PRO_GRP_BR_REG_DATE, pgb.Address PRO_GRP_BR_ADDRESS, pgb.PhoneNo PRO_GRP_BR_PHONENO, pgb.Email PRO_GRP_BR_EMAIL, pgb.ContactPerson PRO_GRP_BR_CONTACT_PER, pgb.ContactPersonAdd PRO_GRP_BR_CONTACT_PER_ADD, pgb.ContactPersonPhone PRO_GRP_BR_CONTACT_PER_PH, pgb.Created_By PRO_GRP_BR_CREATED_BY, pgb.Created_Date PRO_GRP_BR_CREATED_DATE, pgb.Modify_By PRO_GRP_BR_MODIFY_BY, pgb.Modify_Date PRO_GRP_MODIFY_DATE, pg.Company_Id PRO_GRP_COMP_ID, pgc.Company_Name PRO_GRP_COMP_DESC, pgc.Company_Logo PRO_GRP_COMP_LOGO, pgc.CReg_Date PRO_GRP_COMP_REG_DATE, pgc.Address PRO_GRP_COMP_ADDRESS, pgc.PhoneNo PRO_GRP_COMP_PHONE_NO, pgc.Pan_No PRO_GRP_COMP_PAN_NO, pgc.Email PRO_GRP_COMP_EMAIL, pgc.Website PRO_GRP_COMP_WEBSITE, pgc.Status PRO_GRP_COMP_STATUS, pgc.CreateDate PRO_GRP_COMP_CREATED_DATE, pgc.LoginDate PRO_GRP_COMP_LOGIN_DATE, pgc.PrintDesc PRO_GRP_COMP_PRINTDESC, pg.Status PRO_GRP_STATUS, pg.EnterBy PRO_GRP_ENTER_BY, pg.EnterDate PRO_GRP_ENTER_DATE, p.PSubGrpId PRODUCT_SUB_GRP_ID, psg.SubGrpName PRODUCT_SUB_GRP_DESC, psg.ShortName PRODUCT_SUB_GRP_SHORTNAME, psg.GrpId PRO_SUB_GRP_ID, psgpg.GrpName PRO_SUB_GRP_DESC, psgpg.GrpCode PRO_SUB_GRP_SHORTNAME, psgpg.GMargin PRO_SUB_GRP_MARGIN, psgpg.Gprinter PRO_SUB_GRP_PRINTER, psgpg.Branch_ID PRO_SUB_GRP_BRANCH_ID, psgpgb.Branch_Name PSG_PRO_GRP_BR_DESC, psgpgb.Branch_Code PSG_PRO_GRP_BR_SHORTNAME, psgpgb.Reg_Date PSG_PRO_GRP_BR_REG_DATE, psgpgb.Address PSG_PRO_GRP_BR_ADDRESS, psgpgb.PhoneNo PSG_PRO_GRP_BR_PHONENO, psgpgb.Fax PSG_PRO_GRP_BR_FAX, psgpgb.Email PSG_PRO_GRP_BR_EMAIL, psgpgb.ContactPerson PSG_PRO_GRP_BR_CONTACT_PER, psgpgb.ContactPersonAdd PSG_PRO_GRP_BR_CONTACT_PER_ADD, psgpgb.ContactPersonPhone PSG_PRO_GRP_BR_CONTACT_PER_PH, psgpgb.Created_By PSG_PRO_GRP_BR_CREATED_BY, psgpgb.Created_Date PSG_PR_GRP_BR_CREATED_DATE, psgpgb.Modify_By PSG_PRO_GRP_BR_MODIFY_BY, psgpgb.Modify_Date PSG_PRO_GRP_BR_MODIFY_DATE, psgpg.Company_Id PSG_PRO_GRP_COMP_ID, psgpgc.Company_Name PSG_PRO_GRP_COMP_DESC, psgpgc.Company_Logo PSG_PRO_GRP_COMP_LOGO, psgpgc.CReg_Date PSG_PRO_GRP_REG_DATE, psgpgc.Address PSG_PRO_GRP_COMP_ADDRESS, psgpgc.PhoneNo PSG_PRO_GRP_COMP_PHONE_NO, psgpgc.Pan_No PSG_PRO_GRP_COMP_PAN_NO, psgpgc.Email PSG_PRO_GRP_COMP_EMAIL, psgpgc.Website PSG_PRO_GRP_COMP_WEBSITE, psgpgc.Version_No PSG_PRO_GRP_COMP_VERSION, psgpgc.Status PSG_PRO_GRP_COMP_STATUS, psgpgc.CreateDate PSG_PRO_GRP_COMP_CREATED_DATE, psgpgc.LoginDate PSG_PRO_GRP_COMP_LOGIN_DATE, psgpg.Status PRO_SUB_GRP_STATUS, psgpg.EnterBy PRO_SUB_GRP_ENTER_BY, psgpg.EnterDate PRO_SUB_GRP_ENTER_DATE, psg.Branch_ID PRODUCT_SUB_GRP_BRANCH_ID, psgb.Branch_Name PRODUCT_SUB_GRP_BR_DESC, psgb.Branch_Code PRODUCT_SUB_GRP_BR_SHORTNAME, psgb.Reg_Date PRO_SUB_GRP_BR_REG_DATE, psgb.Address PRO_SUB_GRP_BR_ADDRESS, psgb.PhoneNo PRO_SUB_GRP_BR_PHONE, psgb.Email PRO_SUB_GRP_BR_EMAIL, psgb.ContactPerson PRO_SUB_GRP_BR_CONTCT_PER, psgb.ContactPersonAdd PRO_SUB_GRP_BR_CONTCT_PER_ADD, psgb.ContactPersonPhone PRO_SUB_GRP_BR_CONTCT_PER_PH, psgb.Created_By PRO_SUB_GRP_BR_CREATED_BY, psgb.Created_Date PRO_SUB_GRP_BR_CREATED_DATE, psgb.Modify_By PRO_SUB_GRP_BR_MODIFY_BY, psgb.Modify_Date PRO_SUB_GRP_BR_MODIFy_DATE, psg.Company_Id PRO_SUB_GRP_COMP_ID, psgc.Company_Name PRO_SUB_GRP_COMP_DESC, psgc.Company_Logo PRO_SUB_GRP_COMP_LOGO, psgc.CReg_Date PRO_SUB_GRP_COMP_REG_DATE, psgc.Address PRO_SUB_GRP_COMP_ADDRESS, psgc.City PRO_SUB_GRP_COMP_CITY, psgc.PhoneNo PRO_SUB_GRP_COMP_PHONE, psgc.Pan_No PRO_SUB_GRP_COMP_PAN, psgc.Email PRO_SUB_GRP_COMP_EMAIL, psgc.Website PRO_SUB_GRP_COMP_WEBSITE, psgc.PrintDesc PRO_SUB_GRP_COMP_PRINTDESC, psg.EnterBy PRO_SUB_GRP_ENTERBY, psg.EnterDate PRO_SUB_GRP_ENTERDATE, psg.Status PRODUCT_SUB_GRP_STATUS, p.PTax PRODUCT_TAX, p.PMin PRO_MIN_QTY, p.PMax PRO_MAX_QTY, p.CMPID CMPID, p.CMPID1 CMPID1, p.CMPID2 CMPID2, p.CmpId3 CmpId3, p.Branch_ID PRODUCT_BR_ID, prb.Branch_Name PRODUCT_BR_DESC, prb.Branch_Code PRODUCT_BR_SHORTNAME, prb.Reg_Date PRODUCT_BR_REG_DATE, prb.Address PRODUCT_BR_ADDRESS, prb.Country PRODUCT_BR_COUNTRY, prb.State PRODUCT_BR_STATE, prb.City PRODUCT_BR_CITY, prb.PhoneNo PRODUCT_BR_PHONE, prb.Fax PRODUCT_BR_FAX, prb.Email PRODUCT_BR_EMAIL, prb.ContactPerson PRODUCT_BR_CONTACT_PER, prb.ContactPersonAdd PRODUCT_BR_CONTACT_PER_ADD, prb.ContactPersonPhone PRODUCT_BR_CONTACT_PER_PHONE, prb.Created_By PRODUCT_BR_CREATED_BY, prb.Created_Date PRODUCT_BR_CREATED_DATE, prb.Modify_By PRODUCT_BR_MODIFY_BY, prb.Modify_Date PRODUCT_BR_MODIFY_DATE, prb.SyncGlobalId PRODUCT_BR_SYNCGLOBALID, prb.SyncOriginId PRODUCT_BR_SYNCORIGINID, prb.SyncCreatedOn PRODUCT_BR_SyncCreatedOn, prb.SyncLastPatchedOn PRODUCT_BR_SYNCLASTPATCHEDON, prb.SyncRowVersion PRODUCT_BR_SYNCROWVERSION, prb.SyncBaseId PRODUCT_BR_SYNCBASEDID, p.CmpUnit_ID PRODUCT_COMP_ID, pcu.CmpUnit_Name PRODUCT_COMP_DESC, pcu.CmpUnit_Code PRODUCT_COMP_SHORTNAME, pcu.Reg_Date PRODUCT_COMP_REGDATE, pcu.Address PRODUCT_COMP_ADDRESS, pcu.Country PRODUCT_COMP_COUNTRY, pcu.State PRODUCT_COMP_STATE, pcu.City PRODUCT_COMP_CITY, pcu.PhoneNo PRODUCT_COMP_PHONE, pcu.Fax PRODUCT_COMP_FAX, pcu.Email PRODUCT_COMP_EMAIL, pcu.ContactPerson PRODUCT_COMP_CONTACT_PER, pcu.ContactPersonAdd PRODUCT_COMP_CONTACT_PER_ADD, pcu.ContactPersonPhone PRODUCT_COMP_CONTACT_PER_PHONE, pcu.Branch_ID PRODUCT_COMP_BRANCH_ID, pcub.Branch_Name PRODUCT_COMP_UNIT_BR_DESC, pcub.Branch_Code PRODUCT_COMP_UNIT_BR_SHORTNAME, pcub.Reg_Date PRODUCT_COMP_UNIT_BR_REG_DATE, pcub.Address PRODUCT_COMP_UNIT_BR_ADDRESS, pcub.Country PRODUCT_COMP_UNIT_BR_COUNTRY, pcub.State PRODUCT_COMP_UNIT_BR_STATE, pcub.City PRODUCT_COMP_UNIT_BR_CITY, pcub.PhoneNo PRODUCT_COMP_UNIT_BR_PHONENO, pcub.Fax PRODUCT_COMP_UNIT_BR_FAX, pcub.Email PRODUCT_COMP_UNIT_BR_EMAIL, pcub.ContactPerson PRODUCT_COMP_UNIT_BR_CONTACT_PER, pcub.ContactPersonAdd PRODUCT_COMP_UNIT_BR_CONTACT_PER_ADD, pcub.ContactPersonPhone PRODUCT_COMP_UNIT_BR_CONTACT_PER_PHONE, pcub.Created_By PRODUCT_COMP_UNIT_BR_CREATED_BY, pcub.Created_Date PRODUCT_COMP_UNIT_BR_CREATED_DATE, pcub.Modify_By PRODUCT_COMP_UNIT_BR_MODIFIED_BY, pcub.Modify_Date PRODUCT_COMP_UNIT_BR_MODIFIED_DATE, pcu.Created_By PRODUCT_COMP_CREATED_BY, pcu.Created_Date PRODUCT_COMP_CREATED_DATE, p.PPL PPL, p.PPR PPR, p.PSL PSL, p.PSR PSR, p.PL_OPENING PL_OPENING, p.PL_CLOSING PL_CLOSING, p.BS_CLOSING BS_CLOSING, p.PImage PRODUCT_PIMAGE, p.EnterBy PRODUCT_ENTERBY, p.EnterDate PORDUCT_ENTERDATE, p.Status PRODUCT_STATUS, p.BeforeBuyRate PRODUCT_BEFOREBUYRATE, p.BeforeSalesRate PRODUCT_BEFORESALESRATE, p.BarCode PRODUCT_BARCODE, p.ChasisNo PRODUCT_CHASISNO, p.EngineNo PRODUCT_ENGINENO, p.VHColor PRODUCT_VEHICLE_COLOR, p.VHModel PRODUCT_VEHICLE_MODEL, p.VHNumber PRODUCT_VEHICLE_NUMBER, p.Barcode1 PRODUCT_BARCODE1, p.Barcode2 PRODUCT_BARCODE2, p.Barcode3 PRODUCT_BARCODE3, Gdn_Id GODOWN_ID, g.GName GDN_DESC, g.GCode GDN_SHORTNAME, g.GLocation GDN_LOCATION, Alt_Qty ALTERNATE_QUANTITY, Alt_UnitId PRO_ALT_UNIT_ID, pau.UnitName ALT_UNIT_DESC, pau.UnitCode ALT_UNIT_SHORTNAME, Qty QUANTITY, Unit_Id PRO_UNIT_ID, pu1.UnitName UNIT_DESC, pu1.UnitCode UNIT_SHORTNAME, Rate PRODUCT_RATE, B_Amount PRODUCT_BASIC_AMOUNT, T_Amount PRODUCT_TAX_AMOUNT, N_Amount PRODUCT_NET_AMOUNT, AltStock_Qty ALTERNATE_STOCK_QUANTITY, Stock_Qty STOCK_QUANTITY, NARRATION NARRATION, IND_Invoice INDENT_VOUCHER, IND_Sno INDENT_SNO, QOT_Invoice QUOTATIN_VOUCHER, QOT_SNo QUOTATION_SNO, TAX_AMOUNT TAX_AMOUNT, V_Amount VAT_AMOUNT, V_Rate VAT_RATE, Issue_Qty ISSUE_QUANTITY, Free_Unit_Id FREE_PRO_UNIT_ID, fpu.UnitName FREE_UNIT_DESC, fpu.UnitCode FREE_UNIT_SHORTNAME, Free_Qty FREE_QUANTITY, StockFree_Qty STOCK_FREE_QUANTITY, ExtraFree_Unit_Id EXTRA_FREE_PRO_UNIT_ID, fpu.UnitName EXTRA_FREE_UNIT_DESC, fpu.UnitCode EXTRA_FREE_UNIT_SHORTNAME, ExtraFree_Qty EXTRA_FREE_QUANTITY, ExtraStockFree_Qty EXTRA_STOCK_FREE_QUANTITY, T_Product TERM_PRODUCT, S_Ledger SALES_LEDGER, SR_Ledger SALES_RETURN_LEDGER, SZ1, SZ2, SZ3, SZ4, SZ5, SZ6, SZ7, SZ8, SZ9, SZ10, SERIAL_NO SERIAL_NO, BATCH_NO BATCH_NO, EXP_DATE EXP_DATE, Manu_Date MANUFACTURE_DATE, NOTES NOTES, PrintedItem PRINTED_ITEM, PrintKOT PRINT_KOT, OrderTime ORDER_TIME, PRINT_TIME PRINT_TIME, IS_CANCELED IS_CANCELED, CancelNotes CANCEL_NOTES, PDiscountRate PRODUCT_DISCOUNT_RATE, PDiscount PRODUCT_DISCOUNT, BDiscountRate BILL_DISCOUNT_RATE, BDiscount BILL_DISCOUNT, ServiceChargeRate SERVICE_CHARGE_RATE, ServiceCharge SERVICE_CHARGE
	FROM AMS.SO_Details PM
		 LEFT OUTER JOIN AMS.Product p ON p.PID=PM.P_Id
		 LEFT OUTER JOIN AMS.ProductUnit ppu ON ppu.UID=p.PUnit
		 LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID=p.PAltUnit
		 LEFT OUTER JOIN AMS.Branch pb ON pb.Branch_ID=ppu.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo pci ON pci.Company_Id=ppu.Company_Id
		 LEFT OUTER JOIN AMS.Branch paub ON paub.Branch_ID=pau.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo pauc ON pauc.Company_Id=pau.Company_Id
		 LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpId=p.PGrpId
		 LEFT OUTER JOIN AMS.Branch pgb ON pgb.Branch_ID=pg.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo pgc ON pgc.Company_Id=pg.Company_Id
		 LEFT OUTER JOIN AMS.ProductSubGroup psg ON psg.PSubGrpId=p.PSubGrpId
		 LEFT OUTER JOIN AMS.ProductGroup psgpg ON psgpg.PGrpId=psg.GrpId
		 LEFT OUTER JOIN AMS.Branch psgpgb ON psgpgb.Branch_ID=psgpg.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo psgpgc ON psgpgc.Company_Id=psgpg.Company_Id
		 LEFT OUTER JOIN AMS.Branch psgb ON psgb.Branch_ID=psg.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyInfo psgc ON psgc.Company_Id=psg.Company_Id
		 LEFT OUTER JOIN AMS.Branch prb ON prb.Branch_ID=p.Branch_ID
		 LEFT OUTER JOIN AMS.CompanyUnit pcu ON pcu.CmpUnit_ID=p.CmpUnit_ID
		 LEFT OUTER JOIN AMS.Branch pcub ON pcub.Branch_ID=pcu.Branch_ID
		 LEFT OUTER JOIN AMS.Godown g ON g.GID=PM.Gdn_Id
		 LEFT OUTER JOIN AMS.ProductUnit pu ON pu.UID=PM.Alt_UnitId
		 LEFT OUTER JOIN AMS.ProductUnit pu1 ON pu1.UID=PM.Unit_Id
		 LEFT OUTER JOIN AMS.ProductUnit fpu ON fpu.UID=PM.Free_Unit_Id
		 LEFT OUTER JOIN AMS.ProductUnit efpu ON efpu.UID=PM.ExtraFree_Unit_Id;');
END;

IF OBJECT_ID('VM.VIEW_SO_MASTER_OTHER_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SO_MASTER_OTHER_DETAILS
    AS
    SELECT PM.SO_Invoice VOUCHER_NO, Transport TRANSPORT, VechileNo VECHILE_NO, BiltyNo BILTY_NO, Package PACKAGE, BiltyDate BILTYDATE, BiltyType BILTY_TYPE, Driver VEHICLE_DRIVER, PhoneNo DRIVER_PHONE_NO, LicenseNo DRIVER_LICENSE_NO, MailingAddress MAILING_ADDRESS, MCity M_CITY, MState M_STATE, MCountry M_COUNTRY, MEmail M_EMAIL, ShippingAddress SHIPPING_ADDRESS, SCity SHIPPING_CITY, SState SHIPPING_STATE, SCountry SHIPPING_COUNTRY, SEmail SHIPPING_EMAIL, ContractNo CONTRACT_NO, ContractDate CONTRACT_DATE, ExportInvoice EXPORT_INVOICE, ExportInvoiceDate EXPORT_INVOICE_DATE, VendorOrderNo VENDOR_ORDER_NO, BankDetails BANK_DETAILS, LcNumber LC_NUMBER, CustomDetails CUSTOM_DETAILS
     FROM AMS.SO_Master_OtherDetails PM
          LEFT OUTER JOIN AMS.SO_Master sbm ON sbm.SO_Invoice = PM.SO_Invoice');
END;

IF OBJECT_ID('VM.VIEW_SB_MASTER') IS NOT NULL BEGIN
  EXECUTE('
	ALTER VIEW [VM].[VIEW_SB_MASTER]
	AS
	SELECT sm.SB_Invoice AS VOUCHER_NO, CONVERT(VARCHAR(10), sm.Invoice_Date, 103) AS VOUCHER_DATE, sm.Invoice_Miti AS VOUCHER_MITI, sm.Invoice_Time AS VOUCHER_TIME, sm.PB_Vno AS REF_VOUCHER_NO, sm.Vno_Date AS REF_VOUCHER_DATE, sm.Vno_Miti AS REF_VOUCHER_MITI, sm.Customer_Id AS LEDGER_ID, gl.GLName AS LEDGER_DESC, gl.GLCode AS LEDGER_SHORTNAME, gl.ACCode AS ACCOUNTING_CODE, gl.GLType AS LEDGER_TYPE, gl.GrpId AS ACCOUNT_GROUP_ID, ag.GrpName AS GROUP_DESC, ag.GrpCode AS GROUP_SHORTNAME, ag.Schedule AS GROUP_SCHEDULE, ag.NepaliDesc AS LEDGER_NEPALI, gl.SubGrpId AS ACCOUNT_SUB_GROUP_ID, asg.SubGrpName AS SUB_GROUP_DESC, asg.SubGrpCode AS SUB_GROUP_SHORTNAME, gl.PanNo AS LEDGER_PAN, gl.AreaId AS LEDGER_AREA_ID, gl.AgentId AS LEDGER_AGENT_ID, gl.CurrId AS LEDGER_CURRENCY_ID, gl.CrDays AS LEDGER_CREDIT_DAYS, gl.CrLimit AS LEDGER_CREDIT_LIMIT, gl.CrTYpe AS LEDGER_CREDIT_TYPE, gl.IntRate AS LEDGER_INTEREST_RATE, gl.GLAddress AS LEDGER_ADDRESS, gl.PhoneNo AS LEDGER_PHONE_NO, gl.LandLineNo AS LEDGER_LAND_LINE_NO, gl.OwnerName AS LEDGER_OWNER_DESC, gl.OwnerNumber AS LEDGER_OWNER_NO, gl.Email AS LEDGER_EMAIL, ISNULL(sm.Party_Name, gl.GLName) AS PARTY_DESC, sm.Vat_No AS PARTY_VAT_NO, sm.Contact_Person AS PARTY_CONTACT_PERSON, sm.Mobile_No AS PARTY_MOBILE_NO, sm.Address AS PARTY_ADDRESS, sm.ChqNo AS PARTY_CHEQUE_NO, sm.ChqDate AS PARTY_CHEQUE_DATE, sm.Invoice_Type AS VOUCHER_TYPE, sm.Invoice_Mode AS VOUCHER_MODE, sm.Payment_Mode AS PAYMENT_MODE, sm.DueDays AS VOUCHER_DUE_DAYS, sm.DueDate AS VOUCHER_DUE_DATE, sm.Agent_Id AS AGENT_ID, ja.AgentName AS AGENT_DESC, ja.AgentCode AS AGENT_SHORTNAME, ja.Address AS AGENT_ADDRESS, ja.PhoneNo AS AGENT_PHONE_NO, sm.Subledger_Id AS SUBLEDGER_ID, sl.SLName AS SUBLEDGER_DESC, sl.SLCode AS SUBLEDGER_SHORTNAME, sl.SLAddress AS SUBLEDGER_ADDRESS, sl.SLPhoneNo AS SUBLEDGER_PHONE_NO, sm.SO_Invoice AS ORDER_VOUCHER_NO, sm.SO_Date AS ORDER_DATE, sm.SC_Invoice AS CHALLAN_VOUCHER_NO, sm.SC_Date AS CHALLAN_DATE, sm.Cls1 AS DEPATMENT_ID, D.DName AS DEPARTMENT_DESC, D.DCode AS DEPATMENT_SHORTNAME, sm.Cls2 AS DEPARTMENT_ID_2, sm.Cls3 AS DEPARTMENT_ID_3, sm.Cls4 AS DEPARTMENT_ID_4, sm.CounterId AS COUNTER_ID, C.CName AS COUNTER_DESC, C.CCode AS COUNTER_SHORTNAME, sm.Cur_Id AS CURRENCY_ID, cc.CName AS CURRENCY_DESC, cc.CCode AS CURRENCY_SHORTNAME, sm.Cur_Rate AS CURRENCY_RATE, sm.B_Amount AS BASIC_AMOUNT, sm.T_Amount AS TERM_AMOUNT, sm.N_Amount AS NET_AMOUNT, sm.LN_Amount AS LOCAL_NET_AMOUNT, sm.V_Amount AS VAT_AMOUNT, sm.Tbl_Amount AS TAXABLE_AMOUNT, sm.Tender_Amount AS TENDER_AMOUNT, sm.Return_Amount AS RETURN_AMOUNT, sm.Action_Type AS ACTION_TYPE, sm.In_Words AS NUM_IN_WORDS, sm.Remarks AS Remarks, sm.R_Invoice AS IS_CANCEL, sm.Is_Printed AS IS_PRINTED, sm.No_Print AS NO_OF_PRINT, sm.Printed_By AS PRINTED_BY, sm.Printed_Date AS PRINTED_DATE, sm.Audit_Lock AS IS_LOCK, sm.Enter_By AS ENTER_BY, sm.Enter_Date AS ENTER_DATE, sm.Reconcile_By AS RECONCILE_BY, sm.Reconcile_Date AS RECONCILE_DATE, sm.Auth_By AS AUTHORIZED_BY, sm.Auth_Date AS AUTHORIZED_DATE, sm.Cleared_By AS CLEARING_BY, sm.Cleared_Date AS CLEARING_DATE, sm.Cancel_By AS CANCEL_BY, sm.Cancel_Date AS CANCEL_DATE, sm.Cancel_Remarks AS CANCEL_REMARKS, sm.CUnit_Id AS COMPANY_UNIT_ID, CU.CmpUnit_Name AS COMPANY_UNIT_DESC, CU.CmpUnit_Code AS COMPANY_UNIT_SHORTNAME, sm.CBranch_Id AS BRANCH_UNIT_ID, B.Branch_Name AS BRANCH_DESC, B.Branch_Code AS BRANCH_SHORTNAME, sm.IsAPIPosted AS IS_API_POSTED, sm.IsRealtime AS IS_REAL_TIME, sm.FiscalYearId AS FISCAL_YEAR_ID, sm.MShipId AS MEMBER_SHIP_ID, ms.MShipDesc AS MEMBER_DESC, ms.MShipShortName AS MEMBER_SHORTNAME, ms.PhoneNo AS MEMBER_PHONE_NO, ms.EmailAdd AS MEMBER_EMAIL_ADDRESS, ms.PriceTag AS MEMBER_PRICE_TAG, mt.MemberDesc AS MEMBER_TYPE_DESC, mt.MemberShortName AS MEMBER_TYPE_SHORTNAME, mt.Discount AS MEMBER_DISCOUNT, sm.TableId AS table_id, tm.TableName AS TABLE_DESC, tm.TableCode AS TABLE_SHORTNAME, sm.DoctorId AS DOCTOR_ID, dr.DrName AS DOCTOR_DESC, dr.DrShortName AS DOCTOR_SHORTNAME, sm.PatientId AS PATIENT_ID, PTM.PaitentDesc AS PATIENT_DESC, PTM.ShortName AS PATIENT_SHORTNAME, PTM.AccountLedger PATIENT_LEDGER, PTM.TAddress AS PATIENT_TEMP_ADDRESS, PTM.PAddress AS PATIENT_PER_ADDRESS, PTM.Age PATIENT_AGE, PTM.ContactNo PATIENT_CONTACT_NO, sm.HDepartmentId AS HOSPITAL_DEPARTMENT_ID, HD.DName AS HOSPITAL_DEPARTMENT, HD.DCode AS HOSPITAL_DEPARTMENT_SHORTNAME
	FROM AMS.SB_Master sm
		LEFT OUTER JOIN AMS.GeneralLedger gl ON sm.Customer_Id=gl.GLID
		LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId
		LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId
		LEFT OUTER JOIN AMS.JuniorAgent ja ON sm.Agent_Id=ja.AgentId
		LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=sm.Subledger_Id
		LEFT OUTER JOIN AMS.Department D ON D.DId=sm.Cls1
		LEFT OUTER JOIN AMS.Counter C ON C.CId=sm.CounterId
		LEFT OUTER JOIN AMS.Currency cc ON cc.CId=sm.Cur_Id
		LEFT OUTER JOIN AMS.CompanyUnit CU ON CU.CmpUnit_ID=sm.CUnit_Id
		LEFT OUTER JOIN AMS.Branch B ON B.Branch_ID=sm.CBranch_Id
		LEFT OUTER JOIN AMS.FiscalYear fy ON sm.FiscalYearId=fy.FY_Id
		LEFT OUTER JOIN AMS.MemberShipSetup ms ON ms.MShipId=sm.MShipId
		LEFT OUTER JOIN AMS.MemberType mt ON mt.MemberTypeId=ms.MemberTypeId
		LEFT OUTER JOIN AMS.TableMaster tm ON tm.TableId=sm.TableId
		LEFT OUTER JOIN HOS.Doctor dr ON dr.DrId=sm.DoctorId
		LEFT OUTER JOIN HOS.PatientMaster PTM ON PTM.PaitentId=sm.PatientId
		LEFT OUTER JOIN HOS.Department HD ON HD.DId=sm.HDepartmentId;');
END;

IF OBJECT_ID('VM.VIEW_SB_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW [VM].[VIEW_SB_DETAILS]
    AS
    SELECT SB_Invoice VOUCHER_NO, Invoice_SNo VOUCHER_SNO, sd.P_Id PRODUCT_ID, P.PName PRODUCT_DESC, P.PAlias PRODUCT_ALIAS, P.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE , P.PType PRODUCT_TYPE, P.PCategory PRODUCT_CATEGORY, P.PUnit PRODUCT_UNIT_ID, pu.UnitCode UNIT_CODE, pu.UnitName UNIT_DESC, P.PAltUnit PRODUCT_ALT_UNIT_ID, pau.UnitCode ALT_UNIT_CODE, pau.UnitName ALT_UNIT_DESC, P.PValTech PRODUCT_VAL_TECH, P.PBuyRate PRODUCT_BUY_RATE, P.PSalesRate PRODUCT_SALES_RATE, P.PMargin1 PRODUCT_MARGIN_RATE, P.TradeRate PRODUCT_TRADE_RATE, P.PMargin2 PRODUCT_MARGIN_2, P.PMRP PRODUCT_MRP_RATE, P.PGrpId PRODUCT_GROUP_ID, P.PSubGrpId PRODUCT_SUB_GROUP_ID, P.PTax PRODUCT_TAX_RATE, P.PMin PRODUCT_MIN_STOCK_QTY, P.PMax PRODUCT_MAX_STOCK_QTY, P.CmpId PRODUCT_DEPARTMENT_ID, P.ChasisNo VEHICLE_CHASIS_NO, P.VHModel VEHICLE_MODEL_NO, P.VHColor VEHICLE_COLOR, P.EngineNo VEHICLE_ENGINE_NO, P.VHNumber VEHICLE_NUMBER, P.BeforeBuyRate PRODUCT_BEFORE_BUY_RATE, P.BeforeSalesRate PRODUCT_BEFORE_SALES_RATE, P.Barcode PRODUCT_BARCODE, P.Barcode1 PRODUCT_BARCODE_1, P.Barcode2 PRODUCT_BARCODE_2, P.Barcode3 PRODUCT_BARCODE_3, Gdn_Id GODOWN_ID, g.GName GODOWN_DESC, g.GCode GODOWN_SHORTNAME, Alt_Qty ALT_QTY, Alt_UnitId ALT_UNIT_ID, pau.UnitCode ALT_UOM, Qty QTY, Unit_Id UNIT_ID, pu.UnitCode UOM, Rate INVOICE_RATE, B_Amount BASIC_AMOUNT, T_Amount TERM_AMOUNT, N_Amount NET_AMOUNT, AltStock_Qty ALT_STOCK_QTY, Stock_Qty STOCK_QTY, Narration NARRATION, SO_Invoice ORDER_VOUCHER_NO, SO_Sno ODER_SNO, SC_Invoice CHALLAN_VOUCHER_NO, SC_SNo CHALLAN_SNO, Tax_Amount TAXABLE_AMOUNT, V_Amount VAT_AMOUNT, V_Rate TAX_RATE, Free_Unit_Id FREE_QTY_UNIT_ID, Free_Qty FREE_QTY, StockFree_Qty STOCK_FREE_QTY, ExtraFree_Unit_Id EXTRA_FREE_UNIT_ID, ExtraFree_Qty EXTRA_FREE_QTY, ExtraStockFree_Qty EXTRA_STOCK_FREE_QTY, T_Product IS_TAXABLE, S_Ledger SALES_LEDGER_ID, SR_Ledger SALES_RETURN_LEDGER_ID, SZ1 SIZE_1, SZ2 SIZE_2, SZ3 SIZE_3, SZ4 SIZE_4, SZ5 SIZE_5, SZ6 SIZE_6, SZ7 SIZE_7, SZ8 SIZE_8, SZ9 SIZE_9, SZ10 SIZE_10, Serial_No SERIAL_NO, Batch_No BATCH_NO, Exp_Date EXPIRY_DATE, Manu_Date MANUFACTURING_DATE, MaterialPost IS_MATERIAL_POST, PDiscountRate DISCONT_RATE_ON_PRODUCT, PDiscount DISCOUNT_ON_PRODUCT, BDiscountRate BILL_DISCOUNT_RATE_ON_PRODUCT, BDiscount BILL_DISCOUNT_ON_PRODUCT, ServiceChargeRate SERVICE_CHARGE_RATE_ON_PRODUCT, ServiceCharge SERIVCE_CHARGE_ON_PRODUCT
    FROM AMS.SB_Details sd
            LEFT OUTER JOIN AMS.Product P ON P.PID=sd.P_Id
            LEFT OUTER JOIN AMS.ProductUnit pu ON pu.UID=P.PUnit
            LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID=P.PAltUnit
            LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpId=P.PGrpId
            LEFT OUTER JOIN AMS.ProductSubGroup PSG ON PSG.PSubGrpId=p.PSubGrpId
            LEFT OUTER JOIN AMS.Godown g ON g.GID=sd.Gdn_Id;');
END;

IF OBJECT_ID('VM.VIEW_SB_MASTER_OTHER_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SB_MASTER_OTHER_DETAILS
    AS
    SELECT PM.SB_Invoice VOUCHER_NO, Transport TRANSPORT, VechileNo VECHILE_NO, BiltyNo BILTY_NO, Package PACKAGE, BiltyDate BILTYDATE, BiltyType BILTY_TYPE, Driver VEHICLE_DRIVER, PhoneNo DRIVER_PHONE_NO, LicenseNo DRIVER_LICENSE_NO, MailingAddress MAILING_ADDRESS, MCity M_CITY, MState M_STATE, MCountry M_COUNTRY, MEmail M_EMAIL, ShippingAddress SHIPPING_ADDRESS, SCity SHIPPING_CITY, SState SHIPPING_STATE, SCountry SHIPPING_COUNTRY, SEmail SHIPPING_EMAIL, ContractNo CONTRACT_NO, ContractDate CONTRACT_DATE, ExportInvoice EXPORT_INVOICE, ExportInvoiceDate EXPORT_INVOICE_DATE, VendorOrderNo VENDOR_ORDER_NO, BankDetails BANK_DETAILS, LcNumber LC_NUMBER, CustomDetails CUSTOM_DETAILS
     FROM AMS.SB_Master_OtherDetails PM
          LEFT OUTER JOIN AMS.SB_Master sbm ON sbm.SB_Invoice = PM.SB_Invoice');
END;

IF OBJECT_ID('VM.VIEW_SB_EXCHANGE_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SB_EXCHANGE_DETAILS
    AS
    SELECT SB_Invoice VOUCHER_NO, Invoice_SNo VOUCHER_SNO, P_Id PRODUCT_ID, p.PName PRODUCT_DESC, p.PAlias PRODUCT_ALIS, p.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE, p.PType PRODUCT_TYPE, p.PCategory PRODUCT_CATEGORY, p.PUnit PRODUCT_UNIT, ppu.UnitName PRODUCT_UNIT_DESC, ppu.UnitCode PRODUCT_UNIT_SHORTNAME, ppu.Branch_ID PRODUCT_UNIT_BR_ID, pb.Branch_Name PRO_BR_DESC, pb.Branch_Code PRO_BR_SHORTNAME, pb.Reg_Date PRO_BR_REG_DATE, pb.Address PRO_BR_ADD, pb.Country PRO_BR_COUNTRY, pb.State PRO_BR_STATE, pb.City PRO_BR_CITY, pb.PhoneNo PRO_BR_PHONENO, pb.Fax PRO_BR_FAX, pb.Email PRO_BR_EMAIL, pb.ContactPerson PRO_BR_CT_PERSON, pb.ContactPersonPhone PRO_BR_CT_PHONE, ppu.Company_ID PRO_COMP_ID, pci.Company_Name PRO_COMP_DESC, pci.Company_Logo PRO_COMP_LOGO, pci.CReg_Date PRO_COMP_DATE, pci.Address PRO_COMP_ADDRESS, pci.Country PRO_COMP_COUNTRY, pci.State PRO_COMP_STATE, pci.City PRO_COMP_CITY, pci.PhoneNo PRO_COMP_PHONE_NO, pci.Pan_No PRO_COMP_PAN_NO, pci.Email PRO_COMP_EMAIL, pci.Website PRO_COMP_WEBSITE, pci.Status PRO_COMP_STATUS, pci.CreateDate PRO_COMP_CREATE_DATE, pci.LoginDate PRO_COMP_LOGIN_DATE, pci.SoftModule PRO_COMP_SOFT_MODULE, ppu.EnterBy ENTER_BY, ppu.EnterDate ENTER_DATE, ppu.Status Status, p.PAltUnit PRODUCT_ALT_UNIT, pau.UnitName PRODUCT_ALT_UNIT_DESC, pau.UnitCode PRODUCT_ALT_UNIT_SHORTNAME, pau.Branch_ID PRODUCT_ALT_UNIT_BRANCH_ID, paub.Branch_Name PRO_ALT_UNT_BR_DESC, paub.Branch_Code PRO_ALT_UNT_BR_SHORTNAME, paub.Reg_Date PRO_ALT_UNT_BR_REG_DATE, paub.Address PRO_ALT_UNT_BR_ADDRESS, paub.PhoneNo PRO_ALT_UNT_BR_PHONE, paub.Email PRO_ALT_UNT_BR_EMAIL, paub.ContactPerson PRO_ALT_UNT_BR_CONTACT_PER, paub.ContactPersonAdd PRO_ALT_UNT_BR_CONTACT_PER_DD, paub.ContactPersonPhone PRO_ALT_UNT_BR_CONTACT_PER_PHONE, paub.Created_By PRO_ALT_UNT_BR_CRETD_BY, paub.Created_Date PRO_ALT_UNT_BR_CRETD_DATE, paub.Modify_By PRO_ALT_UNT_BR_MOD_BY, paub.Modify_Date PRO_ALT_UNT_BR_MOD_DATE, pau.Company_ID PRODUCT_ALT_UNT_COMP_ID, pauc.Company_Name PRO_ALT_UNT_COMP_DESC, pauc.Company_Logo PRO_ALT_UNT_COMP_LOGO, pauc.CReg_Date PRO_ALT_UNT_COMP_REG_DATE, pauc.Address PRO_ALT_UNT_COMP_ADDRESS, pauc.PhoneNo PRO_ALT_UNT_COMP_PHONE, pauc.Pan_No PRO_ALT_UNT_COMP_PAN_NO, pauc.Email PRO_ALT_UNT_COMP_EMAIL, pauc.Website PRO_ALT_UNT_COMP_WEBSITE, pauc.Status PRO_ALT_UNT_COMP_STATUS, pauc.CreateDate PRO_ALT_UNT_COMP_CREATE_DATE, pau.EnterBy PRO_ALT_UNT_ENTER_BY, pau.EnterDate PRO_ALT_UNT_ENTER_DATE, pau.Status PRO_ALT_UNT_STATUS, p.PQtyConv PRO_QNTY_CONV, p.PAltConv PRO_ALT_QNTY_CONV, p.PValTech PRO_VAL_TECH, p.PSerialno PRO_SERIAL_NO, p.PSizewise PRO_SIZE_WISE, p.PBatchwise PRO_BATCH_WISE, p.PBuyRate PRO_BUY_RATE, p.PSalesRate PRO_SALES_RATE, p.PMargin1 PRO_MARGIN_ONE, p.TradeRate PRO_TRADE_RATE, p.PMargin2 PRO_MARGIN_TWO, p.PMRP PRO_MARKED_PRICE, p.PGrpId PRO_GRP_ID, pg.GrpName PRO_GRP_DESC, pg.GrpCode PRO_GRP_SHORTNAME, pg.GMargin PRO_GRP_MARGIN, pg.Gprinter PRO_GRP_PRINTER, pg.Branch_ID PRO_GRP_BRANCH_ID, pgb.Branch_Name PRO_GRP_BR_DESC, pgb.Branch_Code PRO_GRP_BR_SHORTNAME, pgb.Reg_Date PRO_GRP_BR_REG_DATE, pgb.Address PRO_GRP_BR_ADDRESS, pgb.PhoneNo PRO_GRP_BR_PHONENO, pgb.Email PRO_GRP_BR_EMAIL, pgb.ContactPerson PRO_GRP_BR_CONTACT_PER, pgb.ContactPersonAdd PRO_GRP_BR_CONTACT_PER_ADD, pgb.ContactPersonPhone PRO_GRP_BR_CONTACT_PER_PH, pgb.Created_By PRO_GRP_BR_CREATED_BY, pgb.Created_Date PRO_GRP_BR_CREATED_DATE, pgb.Modify_By PRO_GRP_BR_MODIFY_BY, pgb.Modify_Date PRO_GRP_MODIFY_DATE, pg.Company_ID PRO_GRP_COMP_ID, pgc.Company_Name PRO_GRP_COMP_DESC, pgc.Company_Logo PRO_GRP_COMP_LOGO, pgc.CReg_Date PRO_GRP_COMP_REG_DATE, pgc.Address PRO_GRP_COMP_ADDRESS, pgc.PhoneNo PRO_GRP_COMP_PHONE_NO, pgc.Pan_No PRO_GRP_COMP_PAN_NO, pgc.Email PRO_GRP_COMP_EMAIL, pgc.Website PRO_GRP_COMP_WEBSITE, pgc.Status PRO_GRP_COMP_STATUS, pgc.CreateDate PRO_GRP_COMP_CREATED_DATE, pgc.LoginDate PRO_GRP_COMP_LOGIN_DATE, pgc.PrintDesc PRO_GRP_COMP_PRINTDESC, pg.Status PRO_GRP_STATUS, pg.EnterBy PRO_GRP_ENTER_BY, pg.EnterDate PRO_GRP_ENTER_DATE, p.PSubGrpId PRODUCT_SUB_GRP_ID, psg.SubGrpName PRODUCT_SUB_GRP_DESC, psg.ShortName PRODUCT_SUB_GRP_SHORTNAME, psg.GrpId PRO_SUB_GRP_ID, psgpg.GrpName PRO_SUB_GRP_DESC, psgpg.GrpCode PRO_SUB_GRP_SHORTNAME, psgpg.GMargin PRO_SUB_GRP_MARGIN, psgpg.Gprinter PRO_SUB_GRP_PRINTER, psgpg.Branch_ID PRO_SUB_GRP_BRANCH_ID, psgpgb.Branch_Name PSG_PRO_GRP_BR_DESC, psgpgb.Branch_Code PSG_PRO_GRP_BR_SHORTNAME, psgpgb.Reg_Date PSG_PRO_GRP_BR_REG_DATE, psgpgb.Address PSG_PRO_GRP_BR_ADDRESS, psgpgb.PhoneNo PSG_PRO_GRP_BR_PHONENO, psgpgb.Fax PSG_PRO_GRP_BR_FAX, psgpgb.Email PSG_PRO_GRP_BR_EMAIL, psgpgb.ContactPerson PSG_PRO_GRP_BR_CONTACT_PER, psgpgb.ContactPersonAdd PSG_PRO_GRP_BR_CONTACT_PER_ADD, psgpgb.ContactPersonPhone PSG_PRO_GRP_BR_CONTACT_PER_PH, psgpgb.Created_By PSG_PRO_GRP_BR_CREATED_BY, psgpgb.Created_Date PSG_PR_GRP_BR_CREATED_DATE, psgpgb.Modify_By PSG_PRO_GRP_BR_MODIFY_BY, psgpgb.Modify_Date PSG_PRO_GRP_BR_MODIFY_DATE, psgpg.Company_ID PSG_PRO_GRP_COMP_ID, psgpgc.Company_Name PSG_PRO_GRP_COMP_DESC, psgpgc.Company_Logo PSG_PRO_GRP_COMP_LOGO, psgpgc.CReg_Date PSG_PRO_GRP_REG_DATE, psgpgc.Address PSG_PRO_GRP_COMP_ADDRESS, psgpgc.PhoneNo PSG_PRO_GRP_COMP_PHONE_NO, psgpgc.Pan_No PSG_PRO_GRP_COMP_PAN_NO, psgpgc.Email PSG_PRO_GRP_COMP_EMAIL, psgpgc.Website PSG_PRO_GRP_COMP_WEBSITE, psgpgc.Version_No PSG_PRO_GRP_COMP_VERSION, psgpgc.Status PSG_PRO_GRP_COMP_STATUS, psgpgc.CreateDate PSG_PRO_GRP_COMP_CREATED_DATE, psgpgc.LoginDate PSG_PRO_GRP_COMP_LOGIN_DATE, psgpg.Status PRO_SUB_GRP_STATUS, psgpg.EnterBy PRO_SUB_GRP_ENTER_BY, psgpg.EnterDate PRO_SUB_GRP_ENTER_DATE, psg.Branch_ID PRODUCT_SUB_GRP_BRANCH_ID, psgb.Branch_Name PRODUCT_SUB_GRP_BR_DESC, psgb.Branch_Code PRODUCT_SUB_GRP_BR_SHORTNAME, psgb.Reg_Date PRO_SUB_GRP_BR_REG_DATE, psgb.Address PRO_SUB_GRP_BR_ADDRESS, psgb.PhoneNo PRO_SUB_GRP_BR_PHONE, psgb.Email PRO_SUB_GRP_BR_EMAIL, psgb.ContactPerson PRO_SUB_GRP_BR_CONTCT_PER, psgb.ContactPersonAdd PRO_SUB_GRP_BR_CONTCT_PER_ADD, psgb.ContactPersonPhone PRO_SUB_GRP_BR_CONTCT_PER_PH, psgb.Created_By PRO_SUB_GRP_BR_CREATED_BY, psgb.Created_Date PRO_SUB_GRP_BR_CREATED_DATE, psgb.Modify_By PRO_SUB_GRP_BR_MODIFY_BY, psgb.Modify_Date PRO_SUB_GRP_BR_MODIFy_DATE, psg.Company_ID PRO_SUB_GRP_COMP_ID, psgc.Company_Name PRO_SUB_GRP_COMP_DESC, psgc.Company_Logo PRO_SUB_GRP_COMP_LOGO, psgc.CReg_Date PRO_SUB_GRP_COMP_REG_DATE, psgc.Address PRO_SUB_GRP_COMP_ADDRESS, psgc.City PRO_SUB_GRP_COMP_CITY, psgc.PhoneNo PRO_SUB_GRP_COMP_PHONE, psgc.Pan_No PRO_SUB_GRP_COMP_PAN, psgc.Email PRO_SUB_GRP_COMP_EMAIL, psgc.Website PRO_SUB_GRP_COMP_WEBSITE, psgc.PrintDesc PRO_SUB_GRP_COMP_PRINTDESC, psg.EnterBy PRO_SUB_GRP_ENTERBY, psg.EnterDate PRO_SUB_GRP_ENTERDATE, psg.Status PRODUCT_SUB_GRP_STATUS, p.PTax PRODUCT_TAX, p.PMin PRO_MIN_QTY, p.PMax PRO_MAX_QTY, p.CmpId CMPID, p.CmpId1 CMPID1, p.CmpId2 CMPID2, p.CmpId3 CmpId3, p.Branch_Id PRODUCT_BR_ID, prb.Branch_Name PRODUCT_BR_DESC, prb.Branch_Code PRODUCT_BR_SHORTNAME, prb.Reg_Date PRODUCT_BR_REG_DATE, prb.Address PRODUCT_BR_ADDRESS, prb.Country PRODUCT_BR_COUNTRY, prb.State PRODUCT_BR_STATE, prb.City PRODUCT_BR_CITY, prb.PhoneNo PRODUCT_BR_PHONE, prb.Fax PRODUCT_BR_FAX, prb.Email PRODUCT_BR_EMAIL, prb.ContactPerson PRODUCT_BR_CONTACT_PER, prb.ContactPersonAdd PRODUCT_BR_CONTACT_PER_ADD, prb.ContactPersonPhone PRODUCT_BR_CONTACT_PER_PHONE, prb.Created_By PRODUCT_BR_CREATED_BY, prb.Created_Date PRODUCT_BR_CREATED_DATE, prb.Modify_By PRODUCT_BR_MODIFY_BY, prb.Modify_Date PRODUCT_BR_MODIFY_DATE, prb.SyncGlobalId PRODUCT_BR_SYNCGLOBALID, prb.SyncOriginId PRODUCT_BR_SYNCORIGINID, prb.SyncCreatedOn PRODUCT_BR_SyncCreatedOn, prb.SyncLastPatchedOn PRODUCT_BR_SYNCLASTPATCHEDON, prb.SyncRowVersion PRODUCT_BR_SYNCROWVERSION, prb.SyncBaseId PRODUCT_BR_SYNCBASEDID, p.CmpUnit_Id PRODUCT_COMP_ID, pcu.CmpUnit_Name PRODUCT_COMP_DESC, pcu.CmpUnit_Code PRODUCT_COMP_SHORTNAME, pcu.Reg_Date PRODUCT_COMP_REGDATE, pcu.Address PRODUCT_COMP_ADDRESS, pcu.Country PRODUCT_COMP_COUNTRY, pcu.State PRODUCT_COMP_STATE, pcu.City PRODUCT_COMP_CITY, pcu.PhoneNo PRODUCT_COMP_PHONE, pcu.Fax PRODUCT_COMP_FAX, pcu.Email PRODUCT_COMP_EMAIL, pcu.ContactPerson PRODUCT_COMP_CONTACT_PER, pcu.ContactPersonAdd PRODUCT_COMP_CONTACT_PER_ADD, pcu.ContactPersonPhone PRODUCT_COMP_CONTACT_PER_PHONE, pcu.Branch_Id PRODUCT_COMP_BRANCH_ID, pcub.Branch_Name PRODUCT_COMP_UNIT_BR_DESC, pcub.Branch_Code PRODUCT_COMP_UNIT_BR_SHORTNAME, pcub.Reg_Date PRODUCT_COMP_UNIT_BR_REG_DATE, pcub.Address PRODUCT_COMP_UNIT_BR_ADDRESS, pcub.Country PRODUCT_COMP_UNIT_BR_COUNTRY, pcub.State PRODUCT_COMP_UNIT_BR_STATE, pcub.City PRODUCT_COMP_UNIT_BR_CITY, pcub.PhoneNo PRODUCT_COMP_UNIT_BR_PHONENO, pcub.Fax PRODUCT_COMP_UNIT_BR_FAX, pcub.Email PRODUCT_COMP_UNIT_BR_EMAIL, pcub.ContactPerson PRODUCT_COMP_UNIT_BR_CONTACT_PER, pcub.ContactPersonAdd PRODUCT_COMP_UNIT_BR_CONTACT_PER_ADD, pcub.ContactPersonPhone PRODUCT_COMP_UNIT_BR_CONTACT_PER_PHONE, pcub.Created_By PRODUCT_COMP_UNIT_BR_CREATED_BY, pcub.Created_Date PRODUCT_COMP_UNIT_BR_CREATED_DATE, pcub.Modify_By PRODUCT_COMP_UNIT_BR_MODIFIED_BY, pcub.Modify_Date PRODUCT_COMP_UNIT_BR_MODIFIED_DATE, pcu.Created_By PRODUCT_COMP_CREATED_BY, pcu.Created_Date PRODUCT_COMP_CREATED_DATE, p.PPL PPL, p.PPR PPR, p.PSL PSL, p.PSR PSR, p.PL_Opening PL_OPENING, p.PL_Closing PL_CLOSING, p.BS_Closing BS_CLOSING, p.PImage PRODUCT_PIMAGE, p.EnterBy PRODUCT_ENTERBY, p.EnterDate PORDUCT_ENTERDATE, p.Status PRODUCT_STATUS, p.BeforeBuyRate PRODUCT_BEFOREBUYRATE, p.BeforeSalesRate PRODUCT_BEFORESALESRATE, p.Barcode PRODUCT_BARCODE, p.ChasisNo PRODUCT_CHASISNO, p.EngineNo PRODUCT_ENGINENO, p.VHColor PRODUCT_VEHICLE_COLOR, p.VHModel PRODUCT_VEHICLE_MODEL, p.VHNumber PRODUCT_VEHICLE_NUMBER, p.Barcode1 PRODUCT_BARCODE1, p.Barcode2 PRODUCT_BARCODE2, p.Barcode3 PRODUCT_BARCODE3, Gdn_Id GODOWN_ID, g.GName GDN_DESC, g.GCode GDN_SHORTNAME, g.GLocation GDN_LOCATION, Alt_Qty ALTERNATE_QUANTITY, Alt_UnitId PRO_ALT_UNIT_ID, pau.UnitName ALT_UNIT_DESC, pau.UnitCode ALT_UNIT_SHORTNAME, Qty QUANTITY, Unit_Id PRO_UNIT_ID, pu1.UnitName UNIT_DESC, pu1.UnitCode UNIT_SHORTNAME, Rate RATE, B_Amount BASIC_AMOUNT, N_Amount NET_AMOUNT, ExchangeGLD EXCHANGE_GLD
       FROM AMS.SB_ExchangeDetails PM LEFT OUTER JOIN AMS.Product p ON p.PID=PM.P_Id LEFT OUTER JOIN AMS.ProductUnit ppu ON ppu.UID=p.PUnit LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID=p.PAltUnit LEFT OUTER JOIN AMS.Branch pb ON pb.Branch_Id=ppu.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo pci ON pci.Company_Id=ppu.Company_ID LEFT OUTER JOIN AMS.Branch paub ON paub.Branch_Id=pau.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo pauc ON pauc.Company_Id=pau.Company_ID LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpID=p.PGrpId LEFT OUTER JOIN AMS.Branch pgb ON pgb.Branch_Id=pg.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo pgc ON pgc.Company_Id=pg.Company_ID LEFT OUTER JOIN AMS.ProductSubGroup psg ON psg.PSubGrpId=p.PSubGrpId LEFT OUTER JOIN AMS.ProductGroup psgpg ON psgpg.PGrpID=psg.GrpId LEFT OUTER JOIN AMS.Branch psgpgb ON psgpgb.Branch_Id=psgpg.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo psgpgc ON psgpgc.Company_Id=psgpg.Company_ID LEFT OUTER JOIN AMS.Branch psgb ON psgb.Branch_Id=psg.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo psgc ON psgc.Company_Id=psg.Company_ID LEFT OUTER JOIN AMS.Branch prb ON prb.Branch_Id=p.Branch_Id LEFT OUTER JOIN AMS.CompanyUnit pcu ON pcu.CmpUnit_Id=p.CmpUnit_Id LEFT OUTER JOIN AMS.Branch pcub ON pcub.Branch_Id=pcu.Branch_Id LEFT OUTER JOIN AMS.Godown g ON g.GID=PM.Gdn_Id LEFT OUTER JOIN AMS.ProductUnit pu ON pu.UID=PM.Alt_UnitId LEFT OUTER JOIN AMS.ProductUnit pu1 ON pu1.UID=PM.Unit_Id;');
END;

IF OBJECT_ID('VM.VIEW_SC_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SC_MASTER
    AS
    SELECT sm.SC_Invoice VOUCHER_NO, CONVERT(varchar(10),sm.Invoice_Date,103) VOUCHER_DATE, sm.Invoice_Miti VOUCHER_MITI, sm.Invoice_Time VOUCHER_TIME, sm.Ref_Vno REF_VOUCHER_NO, sm.Ref_Date REF_VOUCHER_DATE, sm.Ref_Miti REF_VOUCHER_MITI, sm.Customer_Id LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode ACCOUNTING_CODE, gl.GLType LEDGER_TYPE, gl.GrpId ACCOUNT_GROUP_ID, ag.GrpName GROUP_DESC, ag.GrpCode GROUP_SHORTNAME, ag.Schedule GROUP_SCHEDULE, ag.NepaliDesc LEDGER_NEPALI, gl.SubGrpId ACCOUNT_SUB_GROUP_ID, asg.SubGrpName SUB_GROUP_DESC, asg.SubGrpCode SUB_GROUP_SHORTNAME, gl.PanNo LEDGER_PAN, gl.AreaId LEDGER_AREA_ID, gl.AgentId LEDGER_AGENT_ID, gl.CurrId lEDGER_CURRENCY_ID, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.GLAddress LEDGER_ADDRESS, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LAND_LINE_NO, gl.OwnerName LEDGER_OWNER_DESC, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL, sm.Party_Name PARTY_DESC, sm.Vat_No PARTY_VAT_NO, sm.Contact_Person PARTY_CONTACT_PERSON, sm.Mobile_No PARTY_MOBILE_NO, sm.Address PARTY_ADDRESS, sm.ChqNo PARTY_CHEQUE_NO, sm.ChqDate PARTY_CHEQUE_DATE, sm.Invoice_Type VOUCHER_TYPE, sm.Invoice_Mode VOUCHER_MODE, sm.Payment_Mode PAYMENT_MODE, sm.DueDays VOUCHER_DUE_DAYS, sm.DueDate VOUCHER_DUE_DATE, sm.Agent_Id AGENT_ID, ja.AgentName AGENT_DESC, ja.AgentCode AGENT_SHORTNAME, ja.Address AGENT_ADDRESS, ja.PhoneNo AGENT_PHONE_NO, sm.Subledger_Id SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sm.SO_Invoice ORDER_VOUCHER_NO, sm.SO_Date ORDER_DATE, sm.QOT_Invoice QUOT_VOUCHER_NO, sm.QOT_Date QUOT_DATE, sm.Cls1 DEPATMENT_ID, D.DName DEPARTMENT_DESC, D.DCode DEPATMENT_SHORTNAME, sm.Cls2 DEPARTMENT_ID_2, sm.Cls3 DEPARTMENT_ID_3, sm.Cls4 DEPARTMENT_ID_4, sm.CounterId COUNTER_ID, C.CName COUNTER_DESC, C.CCode COUNTER_SHORTNAME, sm.Cur_Id CURRENCY_ID, cc.CName CURRENCY_DESC, cc.Ccode CURRENCY_SHORTNAME, sm.Cur_Rate CURRENCY_RATE, sm.B_Amount BASIC_AMOUNT, sm.T_Amount TERM_AMOUNT, sm.N_Amount NET_AMOUNT, sm.LN_Amount LOCAL_NET_AMOUNT, sm.V_Amount VAT_AMOUNT, sm.Tbl_Amount TAXABLE_AMOUNT, sm.Tender_Amount TENDER_AMOUNT, sm.Return_Amount RETURN_AMOUNT, sm.Action_Type ACTION_TYPE, sm.In_Words NUM_IN_WORDS, sm.Remarks REMARKS, sm.R_Invoice IS_CANCEL, sm.No_Print NO_OF_PRINT, sm.Audit_Lock IS_LOCK, sm.Enter_By ENTER_BY, sm.Enter_Date ENTER_DATE, sm.Reconcile_By RECONCILE_BY, sm.Reconcile_Date RECONCILE_DATE, sm.Auth_By AUTHORIZED_BY, sm.Auth_Date AUTHORIZED_DATE, sm.CUnit_Id COMPANY_UNIT_ID, CU.CmpUnit_Name COMPANY_UNIT_DESC, CU.CmpUnit_Code COMPANY_UNIT_SHORTNAME, sm.CBranch_Id BRANCH_UNIT_ID, B.Branch_Name BRANCH_DESC, B.Branch_Code BRANCH_SHORTNAME, sm.FiscalYearId FISCAL_YEAR_ID
       FROM AMS.SC_Master sm LEFT OUTER JOIN AMS.GeneralLedger gl ON sm.Customer_Id=gl.GLID LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent ja ON sm.Agent_Id=ja.AgentId LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=sm.Subledger_Id LEFT OUTER JOIN AMS.Department D ON D.DId=sm.Cls1 LEFT OUTER JOIN AMS.Counter C ON C.CId=sm.CounterId LEFT OUTER JOIN AMS.Currency cc ON cc.CId=sm.Cur_Id LEFT OUTER JOIN AMS.CompanyUnit CU ON CU.CmpUnit_Id=sm.CUnit_Id LEFT OUTER JOIN AMS.Branch B ON B.Branch_Id=sm.CBranch_Id LEFT OUTER JOIN AMS.FiscalYear fy ON sm.FiscalYearId=fy.FY_Id;');
END;

IF OBJECT_ID('VM.VIEW_SC_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SC_DETAILS
    AS
    SELECT SC_Invoice VOUCHER_NO, Invoice_SNo VOUCHER_SNO, P_Id PRODUCT_ID, P.PName PRODUCT_DESC, P.PAlias PRODUCT_ALIAS, P.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE, P.PType PRODUCT_TYPE, P.PCategory PRODUCT_CATEGORY, P.PUnit PRODUCT_UNIT_ID, pu.UnitCode UNIT_CODE, pu.UnitName UNIT_DESC, P.PAltUnit PRODUCT_ALT_UNIT_ID, pau.UnitCode ALT_UNIT_CODE, pau.UnitName ALT_UNIT_DESC, P.PValTech PRODUCT_VAL_TECH, P.PBuyRate PRODUCT_BUY_RATE, P.PSalesRate PRODUCT_SALES_RATE, P.PMargin1 PRODUCT_MARGIN_RATE, P.TradeRate PRODUCT_TRADE_RATE, P.PMargin2 PRODUCT_MARGIN_2, P.PMRP PRODUCT_MRP_RATE, P.PGrpId PRODUCT_GROUP_ID, P.PSubGrpId PRODUCT_SUB_GROUP_ID, P.PTax PRODUCT_TAX_RATE, P.PMin PRODUCT_MIN_STOCK_QTY, P.PMax PRODUCT_MAX_STOCK_QTY, P.CmpId PRODUCT_DEPARTMENT_ID, P.ChasisNo VEHICLE_CHASIS_NO, P.VHModel VEHICLE_MODEL_NO, P.VHColor VEHICLE_COLOR, P.EngineNo VEHICLE_ENGINE_NO, P.VHNumber VEHICLE_NUMBER, P.BeforeBuyRate PRODUCT_BEFORE_BUY_RATE, P.BeforeSalesRate PRODUCT_BEFORE_SALES_RATE, P.Barcode PRODUCT_BARCODE, P.Barcode1 PRODUCT_BARCODE_1, P.Barcode2 PRODUCT_BARCODE_2, P.Barcode3 PRODUCT_BARCODE_3, Gdn_Id GODOWN_ID, g.GName GODOWN_DESC, g.GCode GODOWN_SHORTNAME, Alt_Qty ALT_QTY, Alt_UnitId ALT_UNIT_ID, pau.UnitCode ALT_UOM, Qty QTY, Unit_Id UNIT_ID, pu.UnitCode UOM, Rate INVOICE_RATE, B_Amount BASIC_AMOUNT, T_Amount TERM_AMOUNT, N_Amount NET_AMOUNT, AltStock_Qty ALT_STOCK_QTY, Stock_Qty STOCK_QTY, Narration NARRATION, SO_Invoice ORDER_VOUCHER_NO, SO_Sno ODER_SNO, QOT_Invoice QUOT_VOUCHER_NO, QOT_SNo QUOT_SNO, Tax_Amount TAXABLE_AMOUNT, V_Amount VAT_AMOUNT, V_Rate TAX_RATE, Free_Unit_Id FREE_QTY_UNIT_ID, Free_Qty FREE_QTY, StockFree_Qty STOCK_FREE_QTY, ExtraFree_Unit_Id EXTRA_FREE_UNIT_ID, ExtraFree_Qty EXTRA_FREE_QTY, ExtraStockFree_Qty EXTRA_STOCK_FREE_QTY, T_Product IS_TAXABLE, S_Ledger SALES_LEDGER_ID, SR_Ledger SALES_RETURN_LEDGER_ID, SZ1 SIZE_1, SZ2 SIZE_2, SZ3 SIZE_3, SZ4 SIZE_4, SZ5 SIZE_5, SZ6 SIZE_6, SZ7 SIZE_7, SZ8 SIZE_8, SZ9 SIZE_9, SZ10 SIZE_10, Serial_No SERIAL_NO, Batch_No BATCH_NO, Exp_Date EXPIRY_DATE, Manu_Date MANUFACTURING_DATE
       FROM AMS.SC_Details sd LEFT OUTER JOIN AMS.Product P ON P.PID=sd.P_Id LEFT OUTER JOIN AMS.ProductUnit pu ON pu.UID=P.PUnit LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID=P.PAltUnit LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpID=P.PGrpId LEFT OUTER JOIN AMS.ProductSubGroup PSG ON PSG.GrpId=pg.PGrpID LEFT OUTER JOIN AMS.Godown g ON g.GID=sd.Gdn_Id;');
END;

IF OBJECT_ID('VM.VIEW_SC_MASTER_OTHER_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SC_MASTER_OTHER_DETAILS
    AS
    SELECT PM.SC_Invoice VOUCHER_NO, Transport TRANSPORT, VechileNo VECHILE_NO, BiltyNo BILTY_NO, Package PACKAGE, BiltyDate BILTYDATE, BiltyType BILTY_TYPE, Driver VEHICLE_DRIVER, PhoneNo DRIVER_PHONE_NO, LicenseNo DRIVER_LICENSE_NO, MailingAddress MAILING_ADDRESS, MCity M_CITY, MState M_STATE, MCountry M_COUNTRY, MEmail M_EMAIL, ShippingAddress SHIPPING_ADDRESS, SCity SHIPPING_CITY, SState SHIPPING_STATE, SCountry SHIPPING_COUNTRY, SEmail SHIPPING_EMAIL, ContractNo CONTRACT_NO, ContractDate CONTRACT_DATE, ExportInvoice EXPORT_INVOICE, ExportInvoiceDate EXPORT_INVOICE_DATE, VendorOrderNo VENDOR_ORDER_NO, BankDetails BANK_DETAILS, LcNumber LC_NUMBER, CustomDetails CUSTOM_DETAILS
       FROM AMS.SC_Master_OtherDetails PM LEFT OUTER JOIN AMS.SC_Master sbm ON sbm.SC_Invoice=PM.SC_Invoice;');
END;

IF OBJECT_ID('VM.VIEW_SQ_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SQ_MASTER
    AS
    SELECT SQ_Invoice VOUCHER_NO, Invoice_Date VOUCHER_DATE, Invoice_Miti VOUCHER_MITI, Invoice_Time VOUCHER_TIME, Expiry_Date VOUCHER_EXPIRY_DATE, Ref_Vno REF_VNO, Ref_VDate REF_VNO_DATE, Ref_VMiti REF_VNO_MITI, Customer_Id LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CRLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrType LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, gl.SubGrpId LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME, Party_Name PARTY_DESC, Vat_No PARTY_TPAN_NO, Contact_Person CONTACT_PERSON, Mobile_No PARTY_MOBILE_NO, PM.Address PARTY_ADDRESS, ChqNo CHEQUE_NO, ChqDate CHEQUE_DATE, Invoice_Type INVOICE_TYPE, Invoice_Mode VOUCHER_MODE, Payment_Mode PAYMENT_MODE, DueDays DUE_DAYS, DueDate DUE_DATE, Agent_Id SALES_MAN_ID, ja.AgentName SALES_MAN, ja.AgentCode SALES_MAN_SHORTNAME, ja.Address SALES_MAN_ADDRESS, ja.PhoneNo SALES_MAN_PHONE_NO, ja.Email SALES_MAN_EMAIL, ja.Commission SALES_MAN_COMMISSION, ja.CRLimit SALES_MAN_CREDIT_LIMIT, ja.CrDays SALES_MAN_CREDIT_DAYS, ja.CrType SALES_MAN_CREDIT_TYPE, ja.GLCode SALES_MAN_LEDGER_ID, jaGl.GLName AGENT_LEDGER_DESC, jaGl.GLCode AGENT_LEDGER_SHORTNAME, jaGl.ACCode AGENT_LEDGER_ACCOUNTING_CODE, jaGl.GLAddress AGENT_LEDGER_ADDRESS, jaGl.PanNo AGENT_LEDGER_PAN_NO, jaGl.CrDays AGENT_LEDGER_CREDIT_DAYS, jaGl.CrLimit AGENT_LEDGER_CREDIT_LIMIT, jaGl.CrTYpe AGENT_LEDGER_CREDIT_TYPE, jaGl.IntRate AGENT_LEDGER_INTEREST_RATE, jaGl.PhoneNo AGENT_LEDGER_PHONE_NO, jaGl.LandLineNo AGENT_LEDGER_LANDLINE_NO, jaGl.OwnerName AGENT_LEDGER_OWNER_NAME, jaGl.OwnerNumber AGENT_LEDGER_OWNER_NO, jaGl.Email AGENT_LEDGER_EMAIL_ADDRESS, ja.SAgent MAIN_SALES_MAN_ID, ja.AgentName MAIN_SALES_MAN, ja.AgentCode MAIN_SALES_MAN_SHORTNAME, ja.Address MAIN_SALES_MAN_ADDRESS, ja.PhoneNo MAIN_SALES_MAN_PHONE_NO, ja.Email MAIN_SALES_MAN_EMAIL, ja.Commission MAIN_SALES_MAN_COMMISSION, ja.CRLimit MAIN_SALES_MAN_CREDIT_LIMIT, ja.CrDays MAIN_SALES_MAN_CREDIT_DAYS, ja.CrType MAIN_SALES_MAN_CREDIT_TYPE, ja.GLCode MAIN_SALES_MAN_LEDGER_ID, SaGl.GLName MAIN_AGENT_LEDGER_DESC, SaGl.GLCode MAIN_AGENT_LEDGER_SHORTNAME, SaGl.ACCode MAIN_AGENT_LEDGER_ACCOUNTING_CODE, SaGl.GLAddress MAIN, Subledger_Id SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sl.GLID, slGl.GLName SUBLEDGER_LEDGER_DESC, slGl.GLCode SUBLEDGER_LEDGER_SHORTNAME, slGl.ACCode SUBLEDGER_LEDGER_ACCOUNTING_CODE, slGl.GLAddress SUBLEDGER_LEDGER_ADDRESS, slGl.PanNo SUBLEDGER_LEDGER_PAN_NO, slGl.CrDays SUBLEDGER_LEDGER_CREDIT_DAYS, slGl.CrLimit SUBLEDGER_LEDGER_CREDIT_LIMIT, slGl.CrTYpe SUBLEDGER_LEDGER_CREDIT_TYPE, slGl.IntRate SUBLEDGER_LEDGER_INTEREST_RATE, slGl.PhoneNo SUBLEDGER_LEDGER_PHONE_NO, slGl.LandLineNo SUBLEDGER_LEDGER_LANDLINE_NO, slGl.OwnerName SUBLEDGER_LEDGER_OWNER_NAME, slGl.OwnerNumber SUBLEDGER_LEDGER_OWNER_NO, slGl.Email SUBLEDGER_LEDGER_EMAIL_ADDRESS, IND_Invoice INDENT_VOUCHER, IND_Date INDENT_VOUCHER_DATE, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, Cur_Id CURRENCY_ID, C.CName CURRENCY_NAME, C.Ccode CURRENCY_SHORTNAME, C.CRate CURRENCY_RATE, Cur_Rate EXCHANGE_RATE, B_Amount BASIC_AMOUNT, T_Amount TERM_AMOUNT, N_Amount NET_AMOUNT, LN_Amount LOCAL_NET_AMOUNT, V_Amount VAT_AMOUNT, Tbl_Amount TAXABLE_AMOUNT, Tender_Amount TENDER_AMOUNT, Return_Amount RETURN_AMOUNT, Action_Type ACTION_TYPE, In_Words IN_WORDS, Remarks REMARKS, R_Invoice REVERSE_VOUCHER, Is_Printed IS_PRINTED, No_Print NUMBER_OF_PRINT, Printed_By PRINTED_BY, Printed_Date PRINTED_DATE, Cancel_By CANCEL_BY, Cancel_Date CANCEL_DATE, Cancel_Remarks CANCEL_REMARKS, CUnit_Id COMPANY_UNIT_ID, cu.CmpUnit_Name BUSINESS_UNIT_DESC, cu.CmpUnit_Code BUSINESS_UNIT_SHORTNAME, CBranch_Id BRANCH_ID, b.Branch_Name BRANCH_DESC, b.Branch_Code BRANCH_SHORTNAME, b.Address BRANCH_ADDRESS, b.PhoneNo BRANCH_PHONE_NO, b.Email BRANCH_EMAIL, b.ContactPerson BRANCH_CONTACT_PERSON, b.ContactPersonAdd BRANCH_CONTACT_PERSON_ADDRESS, b.ContactPersonPhone BRANCH_CONTACT_PERSON_PHONE_NO, FiscalYearId FISCAL_YEAR_ID, fy.AD_FY, fy.Start_ADDate, fy.End_ADDate, fy.BS_FY, fy.Start_BSDate, fy.End_BSDate, Enter_By ENTER_BY
       FROM AMS.SQ_Master PM LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=PM.Customer_Id LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area LEFT OUTER JOIN AMS.Currency C ON C.CId=PM.Cur_Id LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=PM.Subledger_Id LEFT OUTER JOIN AMS.GeneralLedger slGl ON slGl.GLID=sl.GLID LEFT OUTER JOIN AMS.JuniorAgent ja ON ja.AgentId=PM.Agent_Id LEFT OUTER JOIN AMS.GeneralLedger jaGl ON jaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.SeniorAgent sa ON sa.SAgentId=ja.SAgent LEFT OUTER JOIN AMS.GeneralLedger SaGl ON SaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.Branch b ON b.Branch_Id=PM.CBranch_Id LEFT OUTER JOIN AMS.CompanyUnit cu ON cu.CmpUnit_Id=PM.CUnit_Id LEFT OUTER JOIN AMS.FiscalYear fy ON fy.FY_Id=PM.FiscalYearId LEFT OUTER JOIN AMS.Department d ON d.DId=PM.Cls1;');
END;

IF OBJECT_ID('VM.VIEW_SQ_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_SQ_DETAILS
    AS
    SELECT SQ_Invoice VOUCHER_NO, Invoice_SNo VOUCHER_SNO, P_Id PRODUCT_ID, p.PName PRODUCT_DESC, p.PAlias PRODUCT_ALIS, p.PShortName PRODUCT_SHORTNAME ,p.HsCode PRODUCT_HSCODE, p.PType PRODUCT_TYPE, p.PCategory PRODUCT_CATEGORY, p.PUnit PRODUCT_UNIT, ppu.UnitName PRODUCT_UNIT_DESC, ppu.UnitCode PRODUCT_UNIT_SHORTNAME, ppu.Branch_ID PRODUCT_UNIT_BR_ID, pb.Branch_Name PRO_BR_DESC, pb.Branch_Code PRO_BR_SHORTNAME, pb.Reg_Date PRO_BR_REG_DATE, pb.Address PRO_BR_ADD, pb.Country PRO_BR_COUNTRY, pb.State PRO_BR_STATE, pb.City PRO_BR_CITY, pb.PhoneNo PRO_BR_PHONENO, pb.Fax PRO_BR_FAX, pb.Email PRO_BR_EMAIL, pb.ContactPerson PRO_BR_CT_PERSON, pb.ContactPersonPhone PRO_BR_CT_PHONE, ppu.Company_ID PRO_COMP_ID, pci.Company_Name PRO_COMP_DESC, pci.Company_Logo PRO_COMP_LOGO, pci.CReg_Date PRO_COMP_DATE, pci.Address PRO_COMP_ADDRESS, pci.Country PRO_COMP_COUNTRY, pci.State PRO_COMP_STATE, pci.City PRO_COMP_CITY, pci.PhoneNo PRO_COMP_PHONE_NO, pci.Pan_No PRO_COMP_PAN_NO, pci.Email PRO_COMP_EMAIL, pci.Website PRO_COMP_WEBSITE, pci.Status PRO_COMP_STATUS, pci.CreateDate PRO_COMP_CREATE_DATE, pci.LoginDate PRO_COMP_LOGIN_DATE, pci.SoftModule PRO_COMP_SOFT_MODULE, ppu.EnterBy ENTER_BY, ppu.EnterDate ENTER_DATE, ppu.Status Status, p.PAltUnit PRODUCT_ALT_UNIT, pau.UnitName PRODUCT_ALT_UNIT_DESC, pau.UnitCode PRODUCT_ALT_UNIT_SHORTNAME, pau.Branch_ID PRODUCT_ALT_UNIT_BRANCH_ID, paub.Branch_Name PRO_ALT_UNT_BR_DESC, paub.Branch_Code PRO_ALT_UNT_BR_SHORTNAME, paub.Reg_Date PRO_ALT_UNT_BR_REG_DATE, paub.Address PRO_ALT_UNT_BR_ADDRESS, paub.PhoneNo PRO_ALT_UNT_BR_PHONE, paub.Email PRO_ALT_UNT_BR_EMAIL, paub.ContactPerson PRO_ALT_UNT_BR_CONTACT_PER, paub.ContactPersonAdd PRO_ALT_UNT_BR_CONTACT_PER_DD, paub.ContactPersonPhone PRO_ALT_UNT_BR_CONTACT_PER_PHONE, paub.Created_By PRO_ALT_UNT_BR_CRETD_BY, paub.Created_Date PRO_ALT_UNT_BR_CRETD_DATE, paub.Modify_By PRO_ALT_UNT_BR_MOD_BY, paub.Modify_Date PRO_ALT_UNT_BR_MOD_DATE, pau.Company_ID PRODUCT_ALT_UNT_COMP_ID, pauc.Company_Name PRO_ALT_UNT_COMP_DESC, pauc.Company_Logo PRO_ALT_UNT_COMP_LOGO, pauc.CReg_Date PRO_ALT_UNT_COMP_REG_DATE, pauc.Address PRO_ALT_UNT_COMP_ADDRESS, pauc.PhoneNo PRO_ALT_UNT_COMP_PHONE, pauc.Pan_No PRO_ALT_UNT_COMP_PAN_NO, pauc.Email PRO_ALT_UNT_COMP_EMAIL, pauc.Website PRO_ALT_UNT_COMP_WEBSITE, pauc.Status PRO_ALT_UNT_COMP_STATUS, pauc.CreateDate PRO_ALT_UNT_COMP_CREATE_DATE, pau.EnterBy PRO_ALT_UNT_ENTER_BY, pau.EnterDate PRO_ALT_UNT_ENTER_DATE, pau.Status PRO_ALT_UNT_STATUS, p.PQtyConv PRO_QNTY_CONV, p.PAltConv PRO_ALT_QNTY_CONV, p.PValTech PRO_VAL_TECH, p.PSerialno PRO_SERIAL_NO, p.PSizewise PRO_SIZE_WISE, p.PBatchwise PRO_BATCH_WISE, p.PBuyRate PRO_BUY_RATE, p.PSalesRate PRO_SALES_RATE, p.PMargin1 PRO_MARGIN_ONE, p.TradeRate PRO_TRADE_RATE, p.PMargin2 PRO_MARGIN_TWO, p.PMRP PRO_MARKED_PRICE, p.PGrpId PRO_GRP_ID, pg.GrpName PRO_GRP_DESC, pg.GrpCode PRO_GRP_SHORTNAME, pg.GMargin PRO_GRP_MARGIN, pg.Gprinter PRO_GRP_PRINTER, pg.Branch_ID PRO_GRP_BRANCH_ID, pgb.Branch_Name PRO_GRP_BR_DESC, pgb.Branch_Code PRO_GRP_BR_SHORTNAME, pgb.Reg_Date PRO_GRP_BR_REG_DATE, pgb.Address PRO_GRP_BR_ADDRESS, pgb.PhoneNo PRO_GRP_BR_PHONENO, pgb.Email PRO_GRP_BR_EMAIL, pgb.ContactPerson PRO_GRP_BR_CONTACT_PER, pgb.ContactPersonAdd PRO_GRP_BR_CONTACT_PER_ADD, pgb.ContactPersonPhone PRO_GRP_BR_CONTACT_PER_PH, pgb.Created_By PRO_GRP_BR_CREATED_BY, pgb.Created_Date PRO_GRP_BR_CREATED_DATE, pgb.Modify_By PRO_GRP_BR_MODIFY_BY, pgb.Modify_Date PRO_GRP_MODIFY_DATE, pg.Company_ID PRO_GRP_COMP_ID, pgc.Company_Name PRO_GRP_COMP_DESC, pgc.Company_Logo PRO_GRP_COMP_LOGO, pgc.CReg_Date PRO_GRP_COMP_REG_DATE, pgc.Address PRO_GRP_COMP_ADDRESS, pgc.PhoneNo PRO_GRP_COMP_PHONE_NO, pgc.Pan_No PRO_GRP_COMP_PAN_NO, pgc.Email PRO_GRP_COMP_EMAIL, pgc.Website PRO_GRP_COMP_WEBSITE, pgc.Status PRO_GRP_COMP_STATUS, pgc.CreateDate PRO_GRP_COMP_CREATED_DATE, pgc.LoginDate PRO_GRP_COMP_LOGIN_DATE, pgc.PrintDesc PRO_GRP_COMP_PRINTDESC, pg.Status PRO_GRP_STATUS, pg.EnterBy PRO_GRP_ENTER_BY, pg.EnterDate PRO_GRP_ENTER_DATE, p.PSubGrpId PRODUCT_SUB_GRP_ID, psg.SubGrpName PRODUCT_SUB_GRP_DESC, psg.ShortName PRODUCT_SUB_GRP_SHORTNAME, psg.GrpId PRO_SUB_GRP_ID, psgpg.GrpName PRO_SUB_GRP_DESC, psgpg.GrpCode PRO_SUB_GRP_SHORTNAME, psgpg.GMargin PRO_SUB_GRP_MARGIN, psgpg.Gprinter PRO_SUB_GRP_PRINTER, psgpg.Branch_ID PRO_SUB_GRP_BRANCH_ID, psgpgb.Branch_Name PSG_PRO_GRP_BR_DESC, psgpgb.Branch_Code PSG_PRO_GRP_BR_SHORTNAME, psgpgb.Reg_Date PSG_PRO_GRP_BR_REG_DATE, psgpgb.Address PSG_PRO_GRP_BR_ADDRESS, psgpgb.PhoneNo PSG_PRO_GRP_BR_PHONENO, psgpgb.Fax PSG_PRO_GRP_BR_FAX, psgpgb.Email PSG_PRO_GRP_BR_EMAIL, psgpgb.ContactPerson PSG_PRO_GRP_BR_CONTACT_PER, psgpgb.ContactPersonAdd PSG_PRO_GRP_BR_CONTACT_PER_ADD, psgpgb.ContactPersonPhone PSG_PRO_GRP_BR_CONTACT_PER_PH, psgpgb.Created_By PSG_PRO_GRP_BR_CREATED_BY, psgpgb.Created_Date PSG_PR_GRP_BR_CREATED_DATE, psgpgb.Modify_By PSG_PRO_GRP_BR_MODIFY_BY, psgpgb.Modify_Date PSG_PRO_GRP_BR_MODIFY_DATE, psgpg.Company_ID PSG_PRO_GRP_COMP_ID, psgpgc.Company_Name PSG_PRO_GRP_COMP_DESC, psgpgc.Company_Logo PSG_PRO_GRP_COMP_LOGO, psgpgc.CReg_Date PSG_PRO_GRP_REG_DATE, psgpgc.Address PSG_PRO_GRP_COMP_ADDRESS, psgpgc.PhoneNo PSG_PRO_GRP_COMP_PHONE_NO, psgpgc.Pan_No PSG_PRO_GRP_COMP_PAN_NO, psgpgc.Email PSG_PRO_GRP_COMP_EMAIL, psgpgc.Website PSG_PRO_GRP_COMP_WEBSITE, psgpgc.Version_No PSG_PRO_GRP_COMP_VERSION, psgpgc.Status PSG_PRO_GRP_COMP_STATUS, psgpgc.CreateDate PSG_PRO_GRP_COMP_CREATED_DATE, psgpgc.LoginDate PSG_PRO_GRP_COMP_LOGIN_DATE, psgpg.Status PRO_SUB_GRP_STATUS, psgpg.EnterBy PRO_SUB_GRP_ENTER_BY, psgpg.EnterDate PRO_SUB_GRP_ENTER_DATE, psg.Branch_ID PRODUCT_SUB_GRP_BRANCH_ID, psgb.Branch_Name PRODUCT_SUB_GRP_BR_DESC, psgb.Branch_Code PRODUCT_SUB_GRP_BR_SHORTNAME, psgb.Reg_Date PRO_SUB_GRP_BR_REG_DATE, psgb.Address PRO_SUB_GRP_BR_ADDRESS, psgb.PhoneNo PRO_SUB_GRP_BR_PHONE, psgb.Email PRO_SUB_GRP_BR_EMAIL, psgb.ContactPerson PRO_SUB_GRP_BR_CONTCT_PER, psgb.ContactPersonAdd PRO_SUB_GRP_BR_CONTCT_PER_ADD, psgb.ContactPersonPhone PRO_SUB_GRP_BR_CONTCT_PER_PH, psgb.Created_By PRO_SUB_GRP_BR_CREATED_BY, psgb.Created_Date PRO_SUB_GRP_BR_CREATED_DATE, psgb.Modify_By PRO_SUB_GRP_BR_MODIFY_BY, psgb.Modify_Date PRO_SUB_GRP_BR_MODIFy_DATE, psg.Company_ID PRO_SUB_GRP_COMP_ID, psgc.Company_Name PRO_SUB_GRP_COMP_DESC, psgc.Company_Logo PRO_SUB_GRP_COMP_LOGO, psgc.CReg_Date PRO_SUB_GRP_COMP_REG_DATE, psgc.Address PRO_SUB_GRP_COMP_ADDRESS, psgc.City PRO_SUB_GRP_COMP_CITY, psgc.PhoneNo PRO_SUB_GRP_COMP_PHONE, psgc.Pan_No PRO_SUB_GRP_COMP_PAN, psgc.Email PRO_SUB_GRP_COMP_EMAIL, psgc.Website PRO_SUB_GRP_COMP_WEBSITE, psgc.PrintDesc PRO_SUB_GRP_COMP_PRINTDESC, psg.EnterBy PRO_SUB_GRP_ENTERBY, psg.EnterDate PRO_SUB_GRP_ENTERDATE, psg.Status PRODUCT_SUB_GRP_STATUS, p.PTax PRODUCT_TAX, p.PMin PRO_MIN_QTY, p.PMax PRO_MAX_QTY, p.CmpId CMPID, p.CmpId1 CMPID1, p.CmpId2 CMPID2, p.CmpId3 CmpId3, p.Branch_Id PRODUCT_BR_ID, prb.Branch_Name PRODUCT_BR_DESC, prb.Branch_Code PRODUCT_BR_SHORTNAME, prb.Reg_Date PRODUCT_BR_REG_DATE, prb.Address PRODUCT_BR_ADDRESS, prb.Country PRODUCT_BR_COUNTRY, prb.State PRODUCT_BR_STATE, prb.City PRODUCT_BR_CITY, prb.PhoneNo PRODUCT_BR_PHONE, prb.Fax PRODUCT_BR_FAX, prb.Email PRODUCT_BR_EMAIL, prb.ContactPerson PRODUCT_BR_CONTACT_PER, prb.ContactPersonAdd PRODUCT_BR_CONTACT_PER_ADD, prb.ContactPersonPhone PRODUCT_BR_CONTACT_PER_PHONE, prb.Created_By PRODUCT_BR_CREATED_BY, prb.Created_Date PRODUCT_BR_CREATED_DATE, prb.Modify_By PRODUCT_BR_MODIFY_BY, prb.Modify_Date PRODUCT_BR_MODIFY_DATE, prb.SyncGlobalId PRODUCT_BR_SYNCGLOBALID, prb.SyncOriginId PRODUCT_BR_SYNCORIGINID, prb.SyncCreatedOn PRODUCT_BR_SyncCreatedOn, prb.SyncLastPatchedOn PRODUCT_BR_SYNCLASTPATCHEDON, prb.SyncRowVersion PRODUCT_BR_SYNCROWVERSION, prb.SyncBaseId PRODUCT_BR_SYNCBASEDID, p.CmpUnit_Id PRODUCT_COMP_ID, pcu.CmpUnit_Name PRODUCT_COMP_DESC, pcu.CmpUnit_Code PRODUCT_COMP_SHORTNAME, pcu.Reg_Date PRODUCT_COMP_REGDATE, pcu.Address PRODUCT_COMP_ADDRESS, pcu.Country PRODUCT_COMP_COUNTRY, pcu.State PRODUCT_COMP_STATE, pcu.City PRODUCT_COMP_CITY, pcu.PhoneNo PRODUCT_COMP_PHONE, pcu.Fax PRODUCT_COMP_FAX, pcu.Email PRODUCT_COMP_EMAIL, pcu.ContactPerson PRODUCT_COMP_CONTACT_PER, pcu.ContactPersonAdd PRODUCT_COMP_CONTACT_PER_ADD, pcu.ContactPersonPhone PRODUCT_COMP_CONTACT_PER_PHONE, pcu.Branch_Id PRODUCT_COMP_BRANCH_ID, pcub.Branch_Name PRODUCT_COMP_UNIT_BR_DESC, pcub.Branch_Code PRODUCT_COMP_UNIT_BR_SHORTNAME, pcub.Reg_Date PRODUCT_COMP_UNIT_BR_REG_DATE, pcub.Address PRODUCT_COMP_UNIT_BR_ADDRESS, pcub.Country PRODUCT_COMP_UNIT_BR_COUNTRY, pcub.State PRODUCT_COMP_UNIT_BR_STATE, pcub.City PRODUCT_COMP_UNIT_BR_CITY, pcub.PhoneNo PRODUCT_COMP_UNIT_BR_PHONENO, pcub.Fax PRODUCT_COMP_UNIT_BR_FAX, pcub.Email PRODUCT_COMP_UNIT_BR_EMAIL, pcub.ContactPerson PRODUCT_COMP_UNIT_BR_CONTACT_PER, pcub.ContactPersonAdd PRODUCT_COMP_UNIT_BR_CONTACT_PER_ADD, pcub.ContactPersonPhone PRODUCT_COMP_UNIT_BR_CONTACT_PER_PHONE, pcub.Created_By PRODUCT_COMP_UNIT_BR_CREATED_BY, pcub.Created_Date PRODUCT_COMP_UNIT_BR_CREATED_DATE, pcub.Modify_By PRODUCT_COMP_UNIT_BR_MODIFIED_BY, pcub.Modify_Date PRODUCT_COMP_UNIT_BR_MODIFIED_DATE, pcu.Created_By PRODUCT_COMP_CREATED_BY, pcu.Created_Date PRODUCT_COMP_CREATED_DATE, p.PPL PPL, p.PPR PPR, p.PSL PSL, p.PSR PSR, p.PL_Opening PL_OPENING, p.PL_Closing PL_CLOSING, p.BS_Closing BS_CLOSING, p.PImage PRODUCT_PIMAGE, p.EnterBy PRODUCT_ENTERBY, p.EnterDate PORDUCT_ENTERDATE, p.Status PRODUCT_STATUS, p.BeforeBuyRate PRODUCT_BEFOREBUYRATE, p.BeforeSalesRate PRODUCT_BEFORESALESRATE, p.Barcode PRODUCT_BARCODE, p.ChasisNo PRODUCT_CHASISNO, p.EngineNo PRODUCT_ENGINENO, p.VHColor PRODUCT_VEHICLE_COLOR, p.VHModel PRODUCT_VEHICLE_MODEL, p.VHNumber PRODUCT_VEHICLE_NUMBER, p.Barcode1 PRODUCT_BARCODE1, p.Barcode2 PRODUCT_BARCODE2, p.Barcode3 PRODUCT_BARCODE3, Gdn_Id GODOWN_ID, g.GName GDN_DESC, g.GCode GDN_SHORTNAME, g.GLocation GDN_LOCATION, Alt_Qty ALTERNATE_QUANTITY, Alt_UnitId PRO_ALT_UNIT_ID, pau.UnitName ALT_UNIT_DESC, pau.UnitCode ALT_UNIT_SHORTNAME, Qty QUANTITY, Unit_Id PRO_UNIT_ID, pu1.UnitName UNIT_DESC, pu1.UnitCode UNIT_SHORTNAME, Rate PRODUCT_RATE, B_Amount PRODUCT_BASIC_AMOUNT, T_Amount PRODUCT_TAX_AMOUNT, N_Amount PRODUCT_NET_AMOUNT, AltStock_Qty ALTERNATE_STOCK_QUANTITY, Stock_Qty STOCK_QUANTITY, Narration NARRATION, IND_Invoice INDENT_VOUCHER, IND_Sno INDENT_SNO, Tax_Amount TAX_AMOUNT, V_Amount VAT_AMOUNT, V_Rate VAT_RATE, Issue_Qty ISSUE_QUANTITY, Free_Unit_Id FREE_PRO_UNIT_ID, fpu.UnitName FREE_UNIT_DESC, fpu.UnitCode FREE_UNIT_SHORTNAME, Free_Qty FREE_QUANTITY, StockFree_Qty STOCK_FREE_QUANTITY, ExtraFree_Unit_Id EXTRA_FREE_PRO_UNIT_ID, fpu.UnitName EXTRA_FREE_UNIT_DESC, fpu.UnitCode EXTRA_FREE_UNIT_SHORTNAME, ExtraFree_Qty EXTRA_FREE_QUANTITY, ExtraStockFree_Qty EXTRA_STOCK_FREE_QUANTITY, PG_Id PRODUCT_GROUP_ID, ppg.GrpName PRODUCT_GROUP_DESC, ppg.GrpCode PRODUCT_GROUP_SHORTNAME, ppg.GMargin PRODUCT_GROUP_MARGIN, ppg.Gprinter PRODUCT_GROUP_PRINTER, ppg.Branch_ID PRODUCT_GROUP_BRANCH_ID, ppgb.Branch_Name PRODUCT_GROUP_BRANCH_DESC, ppgb.Branch_Code PRODUCT_GROUP_BRANCH_SHORTNAME, ppgb.Address PRODUCT_GROUP_BRANCH_ADDRESS, ppgb.PhoneNo PRODUCT_GROUP_BRANCH_PHONE_NO, ppgb.Email PRODUCT_GROUP_BRANCH_EMAIL, ppgb.ContactPerson PRODUCT_GROUP_BRANCH_CONTACT_PERSON, ppgb.ContactPersonAdd PRODUCT_GROUP_BRANCH_CONTACT_PERSON_ADDRESS, ppgb.ContactPersonPhone PRODUCT_GROUP_BRANCH_CONTACT_PERSON_PHONE_NO, ppg.Company_ID PRODUCT_GROUP_COMPANY_ID, ppgci.Company_Name PRODUCT_GROUP_COMPANY_DESC, ppgci.Company_Logo PRODUCT_GROUP_COMPANY_LOGO, ppgci.CReg_Date PRODUCT_GROUP_COMPANY_REG_DATE, ppgci.Address PRODUCT_GROUP_COMPANY_ADDRESS, ppgci.PhoneNo PRODUCT_GROUP_COMPANY_PHONE, ppgci.Fax PRODUCT_GROUP_COMPANY_FAX, ppgci.Pan_No PRODUCT_GROUP_COMPANY_PAN, ppgci.Email PRODUCT_GROUP_COMPANY_EMAIL, ppgci.Website PRODUCT_GROUP_COMPANY_WEBSITE, ppg.Status PRODUCT_GROUP_STATUS, ppg.EnterBy PRODUCT_GROUP_ENTER_BY, T_Product TERM_PRODUCT, S_Ledger SALES_LEDGER, SR_Ledger SALES_RETURN_LEDGER, SZ1, SZ2, SZ3, SZ4, SZ5, SZ6, SZ7, SZ8, SZ9, SZ10, Serial_No SERIAL_NO, Batch_No BATCH_NO, Exp_Date EXP_DATE, Manu_Date MANUFACTURE_DATE
       FROM AMS.SQ_Details PM LEFT OUTER JOIN AMS.Product p ON p.PID=PM.P_Id LEFT OUTER JOIN AMS.ProductUnit ppu ON ppu.UID=p.PUnit LEFT OUTER JOIN AMS.ProductUnit pau ON pau.UID=p.PAltUnit LEFT OUTER JOIN AMS.Branch pb ON pb.Branch_Id=ppu.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo pci ON pci.Company_Id=ppu.Company_ID LEFT OUTER JOIN AMS.Branch paub ON paub.Branch_Id=pau.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo pauc ON pauc.Company_Id=pau.Company_ID LEFT OUTER JOIN AMS.ProductGroup pg ON pg.PGrpID=p.PGrpId LEFT OUTER JOIN AMS.Branch pgb ON pgb.Branch_Id=pg.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo pgc ON pgc.Company_Id=pg.Company_ID LEFT OUTER JOIN AMS.ProductSubGroup psg ON psg.PSubGrpId=p.PSubGrpId LEFT OUTER JOIN AMS.ProductGroup psgpg ON psgpg.PGrpID=psg.GrpId LEFT OUTER JOIN AMS.Branch psgpgb ON psgpgb.Branch_Id=psgpg.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo psgpgc ON psgpgc.Company_Id=psgpg.Company_ID LEFT OUTER JOIN AMS.Branch psgb ON psgb.Branch_Id=psg.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo psgc ON psgc.Company_Id=psg.Company_ID LEFT OUTER JOIN AMS.Branch prb ON prb.Branch_Id=p.Branch_Id LEFT OUTER JOIN AMS.CompanyUnit pcu ON pcu.CmpUnit_Id=p.CmpUnit_Id LEFT OUTER JOIN AMS.Branch pcub ON pcub.Branch_Id=pcu.Branch_Id LEFT OUTER JOIN AMS.Godown g ON g.GID=PM.Gdn_Id LEFT OUTER JOIN AMS.ProductUnit pu ON pu.UID=PM.Alt_UnitId LEFT OUTER JOIN AMS.ProductUnit pu1 ON pu1.UID=PM.Unit_Id LEFT OUTER JOIN AMS.ProductUnit fpu ON fpu.UID=PM.Free_Unit_Id LEFT OUTER JOIN AMS.ProductUnit efpu ON efpu.UID=PM.ExtraFree_Unit_Id LEFT OUTER JOIN AMS.ProductGroup ppg ON ppg.PGrpID=PM.PG_Id LEFT OUTER JOIN AMS.Branch ppgb ON ppgb.Branch_Id=ppg.Branch_ID LEFT OUTER JOIN AMS.CompanyInfo ppgci ON ppgci.Company_Id=ppg.Company_ID;');
END;

IF OBJECT_ID('VM.VIEW_JV_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_JV_MASTER
    AS
    SELECT VoucherMode VOUCHER_MODE, Voucher_No VOUCHER_NO, Voucher_Date VOUCHER_DATE, Voucher_Miti VOUCHER_MITI, Voucher_Time VOUCHER_TIME, Ref_VNo REF_VNO, Ref_VDate REF_VNO_DATE, Currency_Id CURRENCY_ID, c.CName CURRENCY_NAME, c.Ccode CURRENCY_SHORTNAME, c.CRate CURRENCY_RATE, Currency_Rate EXCHANGE_RATE, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, N_Amount, Remarks, Action_Type, Audit_Lock, ReconcileBy, ReconcileDate, ClearingBy, ClearingDate, PrintValue, CBranch_Id BRANCH_ID, b.Branch_Name BRANCH_DESC, b.Branch_Code BRANCH_SHORTNAME, b.Address BRANCH_ADDRESS, b.PhoneNo BRANCH_PHONE_NO, b.Email BRANCH_EMAIL, b.ContactPerson BRANCH_CONTACT_PERSON, b.ContactPersonAdd BRANCH_CONTACT_PERSON_ADDRESS, b.ContactPersonPhone BRANCH_CONTACT_PERSON_PHONE_NO, CUnit_Id COMPANY_UNIT_ID, cu.CmpUnit_Name BUSINESS_UNIT_DESC, cu.CmpUnit_Code BUSINESS_UNIT_SHORTNAME, FiscalYearId FISCAL_YEAR_ID, fy.AD_FY, fy.Start_ADDate, fy.End_ADDate, fy.BS_FY, fy.Start_BSDate, fy.End_BSDate, PM.EnterBy ENTER_BY
       FROM AMS.JV_Master PM LEFT OUTER JOIN AMS.Currency c ON c.CId=PM.Currency_Id LEFT OUTER JOIN AMS.Department d ON d.DId=PM.Cls1 LEFT OUTER JOIN AMS.Branch b ON b.Branch_Id=PM.CBranch_Id LEFT OUTER JOIN AMS.CompanyUnit cu ON cu.CmpUnit_Id=PM.CUnit_Id LEFT OUTER JOIN AMS.FiscalYear fy ON fy.FY_Id=PM.FiscalYearId;');
END;

IF OBJECT_ID('VM.VIEW_JV_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_JV_DETAILS
    AS
    SELECT Voucher_No VOUCHER_NO, SNo VOUCHER_SNO, Ledger_Id LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CRLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrType LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, gl.SubGrpId LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME, Subledger_Id SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sl.GLID, slGl.GLName SUBLEDGER_LEDGER_DESC, slGl.GLCode SUBLEDGER_LEDGER_SHORTNAME, slGl.ACCode SUBLEDGER_LEDGER_ACCOUNTING_CODE, slGl.GLAddress SUBLEDGER_LEDGER_ADDRESS, slGl.PanNo SUBLEDGER_LEDGER_PAN_NO, slGl.CrDays SUBLEDGER_LEDGER_CREDIT_DAYS, slGl.CrLimit SUBLEDGER_LEDGER_CREDIT_LIMIT, slGl.CrTYpe SUBLEDGER_LEDGER_CREDIT_TYPE, slGl.IntRate SUBLEDGER_LEDGER_INTEREST_RATE, slGl.PhoneNo SUBLEDGER_LEDGER_PHONE_NO, slGl.LandLineNo SUBLEDGER_LEDGER_LANDLINE_NO, slGl.OwnerName SUBLEDGER_LEDGER_OWNER_NAME, slGl.OwnerNumber SUBLEDGER_LEDGER_OWNER_NO, slGl.Email SUBLEDGER_LEDGER_EMAIL_ADDRESS, Agent_Id SALES_MAN_ID, ja.AgentName SALES_MAN, ja.AgentCode SALES_MAN_SHORTNAME, ja.Address SALES_MAN_ADDRESS, ja.PhoneNo SALES_MAN_PHONE_NO, ja.Email SALES_MAN_EMAIL, ja.Commission SALES_MAN_COMMISSION, ja.CRLimit SALES_MAN_CREDIT_LIMIT, ja.CrDays SALES_MAN_CREDIT_DAYS, ja.CrType SALES_MAN_CREDIT_TYPE, ja.GLCode SALES_MAN_LEDGER_ID, jaGl.GLName AGENT_LEDGER_DESC, jaGl.GLCode AGENT_LEDGER_SHORTNAME, jaGl.ACCode AGENT_LEDGER_ACCOUNTING_CODE, jaGl.GLAddress AGENT_LEDGER_ADDRESS, jaGl.PanNo AGENT_LEDGER_PAN_NO, jaGl.CrDays AGENT_LEDGER_CREDIT_DAYS, jaGl.CrLimit AGENT_LEDGER_CREDIT_LIMIT, jaGl.CrTYpe AGENT_LEDGER_CREDIT_TYPE, jaGl.IntRate AGENT_LEDGER_INTEREST_RATE, jaGl.PhoneNo AGENT_LEDGER_PHONE_NO, jaGl.LandLineNo AGENT_LEDGER_LANDLINE_NO, jaGl.OwnerName AGENT_LEDGER_OWNER_NAME, jaGl.OwnerNumber AGENT_LEDGER_OWNER_NO, jaGl.Email AGENT_LEDGER_EMAIL_ADDRESS, ja.SAgent MAIN_SALES_MAN_ID, ja.AgentName MAIN_SALES_MAN, ja.AgentCode MAIN_SALES_MAN_SHORTNAME, ja.Address MAIN_SALES_MAN_ADDRESS, ja.PhoneNo MAIN_SALES_MAN_PHONE_NO, ja.Email MAIN_SALES_MAN_EMAIL, ja.Commission MAIN_SALES_MAN_COMMISSION, ja.CRLimit MAIN_SALES_MAN_CREDIT_LIMIT, ja.CrDays MAIN_SALES_MAN_CREDIT_DAYS, ja.CrType MAIN_SALES_MAN_CREDIT_TYPE, ja.GLCode MAIN_SALES_MAN_LEDGER_ID, SaGl.GLName MAIN_AGENT_LEDGER_DESC, SaGl.GLCode MAIN_AGENT_LEDGER_SHORTNAME, SaGl.ACCode MAIN_AGENT_LEDGER_ACCOUNTING_CODE, SaGl.GLAddress MAIN, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, Chq_No CHEQUE_NO, Chq_Date CHEQUE_DATE, Debit DEBIT, Credit CREDIT, LocalDebit LOCAL_DEBIT, LocalCredit LOCAL_CREDIT, Narration NARRATION, Tbl_Amount TAXABLE_AMOUNT, V_Amount VAT_AMOUT, Vat_Reg VAT_REG, Party_No PARTY_DESC, Invoice_Date VOUCHER_DATE, Invoice_Miti VOUCHER_MITI, VatLedger_Id VAT_LEDGER_ID, pm.PanNo PAN_NO, CurrencyId CURRENCY_ID, C.CName CURRENCY_NAME, C.Ccode CURRENCY_SHORTNAME, C.CRate CURRENCY_RATE, CurrencyRate EXCHANGE_RATE
       FROM AMS.JV_Details pm LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=pm.Ledger_Id LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area LEFT OUTER JOIN AMS.Currency C ON C.CId=pm.CurrencyId LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=pm.Subledger_Id LEFT OUTER JOIN AMS.GeneralLedger slGl ON slGl.GLID=sl.GLID LEFT OUTER JOIN AMS.JuniorAgent ja ON ja.AgentId=pm.Agent_Id LEFT OUTER JOIN AMS.GeneralLedger jaGl ON jaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.SeniorAgent sa ON sa.SAgentId=ja.SAgent LEFT OUTER JOIN AMS.GeneralLedger SaGl ON SaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.Department d ON d.DId=pm.Cls1;');
END;

IF OBJECT_ID('VM.VIEW_CB_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_CB_MASTER
    AS
    SELECT VoucherMode VOUCHER_MODE, Voucher_No VOUCHER_NO, Voucher_Date VOUCHER_DATE, Voucher_Miti VOUCHER_MITI, Voucher_Time VOUCHER_TIME, Ref_VNo REF_VNO, Ref_VDate REF_VNO_DATE, VoucherType VOUCHER_TYPE, Ledger_Id LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CRLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrType LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, gl.SubGrpId LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME, CheqNo CHEQUE_NO, CheqDate CHEQUE_DATE, CheqMiti CHEQUE_MITI, Currency_Id CURRENCY_ID, C.CName CURRENCY_NAME, C.Ccode CURRENCY_SHORTNAME, C.CRate CURRENCY_RATE, Currency_Rate EXCHANGE_RATE, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, Remarks REMARKS, Action_Type ACTION_TYPE, PrintValue PRINT_VALUE, PM.EnterBy ENTER_BY, CBranch_Id BRANCH_ID, b.Branch_Name BRANCH_DESC, b.Branch_Code BRANCH_SHORTNAME, b.Address BRANCH_ADDRESS, b.PhoneNo BRANCH_PHONE_NO, b.Email BRANCH_EMAIL, b.ContactPerson BRANCH_CONTACT_PERSON, b.ContactPersonAdd BRANCH_CONTACT_PERSON_ADDRESS, b.ContactPersonPhone BRANCH_CONTACT_PERSON_PHONE_NO, CUnit_Id COMPANY_UNIT_ID, cu.CmpUnit_Name BUSINESS_UNIT_DESC, cu.CmpUnit_Code BUSINESS_UNIT_SHORTNAME, FiscalYearId FISCAL_YEAR_ID, fy.AD_FY, fy.Start_ADDate, fy.End_ADDate, fy.BS_FY, fy.Start_BSDate, fy.End_BSDate, In_Words IN_WORDS
       FROM AMS.CB_Master PM LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=PM.Ledger_Id LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area LEFT OUTER JOIN AMS.Currency C ON C.CId=PM.Currency_Id LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId LEFT OUTER JOIN AMS.FiscalYear fy ON fy.FY_Id=PM.FiscalYearId LEFT OUTER JOIN AMS.Department d ON d.DId=PM.Cls1 LEFT OUTER JOIN AMS.Branch b ON b.Branch_Id=PM.CBranch_Id LEFT OUTER JOIN AMS.CompanyUnit cu ON cu.CmpUnit_Id=PM.CUnit_Id;');
END;

IF OBJECT_ID('VM.VIEW_CB_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_CB_DETAILS
    AS
    SELECT Voucher_No VOUCHER_NO, SNo VOUCHER_SNO, Ledger_Id LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CRLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrType LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, gl.SubGrpId LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME, Subledger_Id SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sl.GLID, slGl.GLName SUBLEDGER_LEDGER_DESC, slGl.GLCode SUBLEDGER_LEDGER_SHORTNAME, slGl.ACCode SUBLEDGER_LEDGER_ACCOUNTING_CODE, slGl.GLAddress SUBLEDGER_LEDGER_ADDRESS, slGl.PanNo SUBLEDGER_LEDGER_PAN_NO, slGl.CrDays SUBLEDGER_LEDGER_CREDIT_DAYS, slGl.CrLimit SUBLEDGER_LEDGER_CREDIT_LIMIT, slGl.CrTYpe SUBLEDGER_LEDGER_CREDIT_TYPE, slGl.IntRate SUBLEDGER_LEDGER_INTEREST_RATE, slGl.PhoneNo SUBLEDGER_LEDGER_PHONE_NO, slGl.LandLineNo SUBLEDGER_LEDGER_LANDLINE_NO, slGl.OwnerName SUBLEDGER_LEDGER_OWNER_NAME, slGl.OwnerNumber SUBLEDGER_LEDGER_OWNER_NO, slGl.Email SUBLEDGER_LEDGER_EMAIL_ADDRESS, Agent_Id SALES_MAN_ID, ja.AgentName SALES_MAN, ja.AgentCode SALES_MAN_SHORTNAME, ja.Address SALES_MAN_ADDRESS, ja.PhoneNo SALES_MAN_PHONE_NO, ja.Email SALES_MAN_EMAIL, ja.Commission SALES_MAN_COMMISSION, ja.CRLimit SALES_MAN_CREDIT_LIMIT, ja.CrDays SALES_MAN_CREDIT_DAYS, ja.CrType SALES_MAN_CREDIT_TYPE, ja.GLCode SALES_MAN_LEDGER_ID, jaGl.GLName AGENT_LEDGER_DESC, jaGl.GLCode AGENT_LEDGER_SHORTNAME, jaGl.ACCode AGENT_LEDGER_ACCOUNTING_CODE, jaGl.GLAddress AGENT_LEDGER_ADDRESS, jaGl.PanNo AGENT_LEDGER_PAN_NO, jaGl.CrDays AGENT_LEDGER_CREDIT_DAYS, jaGl.CrLimit AGENT_LEDGER_CREDIT_LIMIT, jaGl.CrTYpe AGENT_LEDGER_CREDIT_TYPE, jaGl.IntRate AGENT_LEDGER_INTEREST_RATE, jaGl.PhoneNo AGENT_LEDGER_PHONE_NO, jaGl.LandLineNo AGENT_LEDGER_LANDLINE_NO, jaGl.OwnerName AGENT_LEDGER_OWNER_NAME, jaGl.OwnerNumber AGENT_LEDGER_OWNER_NO, jaGl.Email AGENT_LEDGER_EMAIL_ADDRESS, ja.SAgent MAIN_SALES_MAN_ID, ja.AgentName MAIN_SALES_MAN, ja.AgentCode MAIN_SALES_MAN_SHORTNAME, ja.Address MAIN_SALES_MAN_ADDRESS, ja.PhoneNo MAIN_SALES_MAN_PHONE_NO, ja.Email MAIN_SALES_MAN_EMAIL, ja.Commission MAIN_SALES_MAN_COMMISSION, ja.CRLimit MAIN_SALES_MAN_CREDIT_LIMIT, ja.CrDays MAIN_SALES_MAN_CREDIT_DAYS, ja.CrType MAIN_SALES_MAN_CREDIT_TYPE, ja.GLCode MAIN_SALES_MAN_LEDGER_ID, SaGl.GLName MAIN_AGENT_LEDGER_DESC, SaGl.GLCode MAIN_AGENT_LEDGER_SHORTNAME, SaGl.ACCode MAIN_AGENT_LEDGER_ACCOUNTING_CODE, SaGl.GLAddress MAIN, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, Debit DEBIT, Credit CREDIT, LocalDebit LOCAL_DEBIT, LocalCredit LOCAL_CREDIT, Narration NARRATION, Tbl_Amount TAXABLE_AMOUNT, V_Amount VAT_AMOUT, Vat_Reg VAT_REG, Party_No PARTY_DESC, Invoice_Date VOUCHER_DATE, Invoice_Miti VOUCHER_MITI, VatLedger_Id VAT_LEDGER_ID, PM.PanNo PAN_NO, Vat_Reg VAT_REGISTER, CurrencyId CURRENCY_ID, C.CName CURRENCY_NAME, C.Ccode CURRENCY_SHORTNAME, C.CRate CURRENCY_RATE, CurrencyRate EXCHANGE_RATE
       FROM AMS.CB_Details PM LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=PM.Ledger_Id LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area LEFT OUTER JOIN AMS.Currency C ON C.CId=PM.CurrencyId LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=PM.Subledger_Id LEFT OUTER JOIN AMS.GeneralLedger slGl ON slGl.GLID=sl.GLID LEFT OUTER JOIN AMS.JuniorAgent ja ON ja.AgentId=PM.Agent_Id LEFT OUTER JOIN AMS.GeneralLedger jaGl ON jaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.SeniorAgent sa ON sa.SAgentId=ja.SAgent LEFT OUTER JOIN AMS.GeneralLedger SaGl ON SaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.Department d ON d.DId=PM.Cls1;');
END;

IF OBJECT_ID('VM.VIEW_NOTES_MASTER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_NOTES_MASTER
    AS
    SELECT VoucherMode VOUCHER_MODE, Voucher_No VOUCHER_NO, Voucher_Date VOUCHER_DATE, Voucher_Miti VOUCHER_MITI, Voucher_Time VOUCHER_TIME, Ref_VNo REF_VNO, Ref_VDate REF_VNO_DATE, VoucherType VOUCHER_TYPE, Ledger_Id LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CRLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrType LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, gl.SubGrpId LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME, CheqNo CHEQUE_NO, CheqDate CHEQUE_DATE, CheqMiti CHEQUE_MITI, Subledger_Id SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sl.GLID, slGl.GLName SUBLEDGER_LEDGER_DESC, slGl.GLCode SUBLEDGER_LEDGER_SHORTNAME, slGl.ACCode SUBLEDGER_LEDGER_ACCOUNTING_CODE, slGl.GLAddress SUBLEDGER_LEDGER_ADDRESS, slGl.PanNo SUBLEDGER_LEDGER_PAN_NO, slGl.CrDays SUBLEDGER_LEDGER_CREDIT_DAYS, slGl.CrLimit SUBLEDGER_LEDGER_CREDIT_LIMIT, slGl.CrTYpe SUBLEDGER_LEDGER_CREDIT_TYPE, slGl.IntRate SUBLEDGER_LEDGER_INTEREST_RATE, slGl.PhoneNo SUBLEDGER_LEDGER_PHONE_NO, slGl.LandLineNo SUBLEDGER_LEDGER_LANDLINE_NO, slGl.OwnerName SUBLEDGER_LEDGER_OWNER_NAME, slGl.OwnerNumber SUBLEDGER_LEDGER_OWNER_NO, slGl.Email SUBLEDGER_LEDGER_EMAIL_ADDRESS, Agent_Id SALES_MAN_ID, ja.AgentName SALES_MAN, ja.AgentCode SALES_MAN_SHORTNAME, ja.Address SALES_MAN_ADDRESS, ja.PhoneNo SALES_MAN_PHONE_NO, ja.Email SALES_MAN_EMAIL, ja.Commission SALES_MAN_COMMISSION, ja.CRLimit SALES_MAN_CREDIT_LIMIT, ja.CrDays SALES_MAN_CREDIT_DAYS, ja.CrType SALES_MAN_CREDIT_TYPE, ja.GLCode SALES_MAN_LEDGER_ID, jaGl.GLName AGENT_LEDGER_DESC, jaGl.GLCode AGENT_LEDGER_SHORTNAME, jaGl.ACCode AGENT_LEDGER_ACCOUNTING_CODE, jaGl.GLAddress AGENT_LEDGER_ADDRESS, jaGl.PanNo AGENT_LEDGER_PAN_NO, jaGl.CrDays AGENT_LEDGER_CREDIT_DAYS, jaGl.CrLimit AGENT_LEDGER_CREDIT_LIMIT, jaGl.CrTYpe AGENT_LEDGER_CREDIT_TYPE, jaGl.IntRate AGENT_LEDGER_INTEREST_RATE, jaGl.PhoneNo AGENT_LEDGER_PHONE_NO, jaGl.LandLineNo AGENT_LEDGER_LANDLINE_NO, jaGl.OwnerName AGENT_LEDGER_OWNER_NAME, jaGl.OwnerNumber AGENT_LEDGER_OWNER_NO, jaGl.Email AGENT_LEDGER_EMAIL_ADDRESS, ja.SAgent MAIN_SALES_MAN_ID, ja.AgentName MAIN_SALES_MAN, ja.AgentCode MAIN_SALES_MAN_SHORTNAME, ja.Address MAIN_SALES_MAN_ADDRESS, ja.PhoneNo MAIN_SALES_MAN_PHONE_NO, ja.Email MAIN_SALES_MAN_EMAIL, ja.Commission MAIN_SALES_MAN_COMMISSION, ja.CRLimit MAIN_SALES_MAN_CREDIT_LIMIT, ja.CrDays MAIN_SALES_MAN_CREDIT_DAYS, ja.CrType MAIN_SALES_MAN_CREDIT_TYPE, ja.GLCode MAIN_SALES_MAN_LEDGER_ID, SaGl.GLName MAIN_AGENT_LEDGER_DESC, SaGl.GLCode MAIN_AGENT_LEDGER_SHORTNAME, SaGl.ACCode MAIN_AGENT_LEDGER_ACCOUNTING_CODE, SaGl.GLAddress MAIN, Currency_Id CURRENCY_ID, C.CName CURRENCY_NAME, C.Ccode CURRENCY_SHORTNAME, C.CRate CURRENCY_RATE, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, Remarks REMARKS, Action_Type ACTION_TYPE, PrintValue PRINT_VALUE, CBranch_Id BRANCH_ID, b.Branch_Name BRANCH_DESC, b.Branch_Code BRANCH_SHORTNAME, b.Address BRANCH_ADDRESS, b.PhoneNo BRANCH_PHONE_NO, b.Email BRANCH_EMAIL, b.ContactPerson BRANCH_CONTACT_PERSON, b.ContactPersonAdd BRANCH_CONTACT_PERSON_ADDRESS, b.ContactPersonPhone BRANCH_CONTACT_PERSON_PHONE_NO, CUnit_Id COMPANY_UNIT_ID, cu.CmpUnit_Name BUSINESS_UNIT_DESC, cu.CmpUnit_Code BUSINESS_UNIT_SHORTNAME, FiscalYearId FISCAL_YEAR_ID, fy.AD_FY, fy.Start_ADDate, fy.End_ADDate, fy.BS_FY, fy.Start_BSDate, fy.End_BSDate, PM.EnterBy ENTER_BY
       FROM AMS.Notes_Master PM LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=PM.Ledger_Id LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area LEFT OUTER JOIN AMS.Currency C ON C.CId=PM.Currency_Id LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId LEFT OUTER JOIN AMS.FiscalYear fy ON fy.FY_Id=PM.FiscalYearId LEFT OUTER JOIN AMS.Department d ON d.DId=PM.Cls1 LEFT OUTER JOIN AMS.Branch b ON b.Branch_Id=PM.CBranch_Id LEFT OUTER JOIN AMS.CompanyUnit cu ON cu.CmpUnit_Id=PM.CUnit_Id LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=PM.Subledger_Id LEFT OUTER JOIN AMS.GeneralLedger slGl ON slGl.GLID=sl.GLID LEFT OUTER JOIN AMS.JuniorAgent ja ON ja.AgentId=PM.Agent_Id LEFT OUTER JOIN AMS.GeneralLedger jaGl ON jaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.SeniorAgent sa ON sa.SAgentId=ja.SAgent LEFT OUTER JOIN AMS.GeneralLedger SaGl ON SaGl.GLID=ja.GLCode;');
END;

IF OBJECT_ID('VM.VIEW_NOTES_DETAILS') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_NOTES_DETAILS
    AS
    SELECT VoucherMode VOUCHER_MODE, Voucher_No VOUCHER_NO, SNo VOUCHER_SNO, Ledger_Id LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CRLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrType LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, Subledger_Id LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME, Agent_Id SALES_MAN_ID, ja.AgentName SALES_MAN, ja.AgentCode SALES_MAN_SHORTNAME, ja.Address SALES_MAN_ADDRESS, ja.PhoneNo SALES_MAN_PHONE_NO, ja.Email SALES_MAN_EMAIL, ja.Commission SALES_MAN_COMMISSION, ja.CRLimit SALES_MAN_CREDIT_LIMIT, ja.CrDays SALES_MAN_CREDIT_DAYS, ja.CrType SALES_MAN_CREDIT_TYPE, ja.GLCode SALES_MAN_LEDGER_ID, jaGl.GLName AGENT_LEDGER_DESC, jaGl.GLCode AGENT_LEDGER_SHORTNAME, jaGl.ACCode AGENT_LEDGER_ACCOUNTING_CODE, jaGl.GLAddress AGENT_LEDGER_ADDRESS, jaGl.PanNo AGENT_LEDGER_PAN_NO, jaGl.CrDays AGENT_LEDGER_CREDIT_DAYS, jaGl.CrLimit AGENT_LEDGER_CREDIT_LIMIT, jaGl.CrTYpe AGENT_LEDGER_CREDIT_TYPE, jaGl.IntRate AGENT_LEDGER_INTEREST_RATE, jaGl.PhoneNo AGENT_LEDGER_PHONE_NO, jaGl.LandLineNo AGENT_LEDGER_LANDLINE_NO, jaGl.OwnerName AGENT_LEDGER_OWNER_NAME, jaGl.OwnerNumber AGENT_LEDGER_OWNER_NO, jaGl.Email AGENT_LEDGER_EMAIL_ADDRESS, ja.SAgent MAIN_SALES_MAN_ID, ja.AgentName MAIN_SALES_MAN, ja.AgentCode MAIN_SALES_MAN_SHORTNAME, ja.Address MAIN_SALES_MAN_ADDRESS, ja.PhoneNo MAIN_SALES_MAN_PHONE_NO, ja.Email MAIN_SALES_MAN_EMAIL, ja.Commission MAIN_SALES_MAN_COMMISSION, ja.CRLimit MAIN_SALES_MAN_CREDIT_LIMIT, ja.CrDays MAIN_SALES_MAN_CREDIT_DAYS, ja.CrType MAIN_SALES_MAN_CREDIT_TYPE, ja.GLCode MAIN_SALES_MAN_LEDGER_ID, SaGl.GLName MAIN_AGENT_LEDGER_DESC, SaGl.GLCode MAIN_AGENT_LEDGER_SHORTNAME, SaGl.ACCode MAIN_AGENT_LEDGER_ACCOUNTING_CODE, SaGl.GLAddress MAIN, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, Debit DEBIT, Credit CREDIT, LocalDebit LOCAL_DEBIT, LocalCredit LOCAL_CREDIT, Narration NARRATION, T_Amount TERM_AMOUNT, V_Amount VAT_AMOUNT, Party_No PARTY_NO, Invoice_Date VOUCHER_DATE, Invoice_Miti VOUCHER_MITI, VatLedger_Id VAT_LEDGER_ID, PM.PanNo PAN_NO, Vat_Reg VAT_REGISTER
       FROM AMS.Notes_Details PM LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=PM.Ledger_Id LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=PM.Subledger_Id LEFT OUTER JOIN AMS.GeneralLedger slGl ON slGl.GLID=sl.GLID LEFT OUTER JOIN AMS.JuniorAgent ja ON ja.AgentId=PM.Agent_Id LEFT OUTER JOIN AMS.GeneralLedger jaGl ON jaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.SeniorAgent sa ON sa.SAgentId=ja.SAgent LEFT OUTER JOIN AMS.GeneralLedger SaGl ON SaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.Department d ON d.DId=PM.Cls1;');
END;

IF OBJECT_ID('VM.VIEW_POST_DATE_CHEQUE') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_POST_DATE_CHEQUE
    AS
    SELECT PDCId VOUCHER_ID, VoucherNo VOUCHER_NO, VoucherDate VOUCHER_DATE, VoucherMiti VOUCHER_MITI, VoucherType VOUCHER_TYPE, BankName VOUCHER_BANK_NAME, BranchName VOUCHER_BANK_BRNACH, ChequeNo VOUCHER_CHEQUE_NO, ChqDate VOUCHER_CHEQUE_DATE, ChqMiti VOUCHER_CHEQUE_MITI, DrawOn VOUCHER_CHEQUE_DRAWON, Amount VOUCHER_CHEQUE_AMOUNT, LedgerId LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CRLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrType LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, gl.SubGrpId LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME, SubLedgerId SUBLEDGER_ID, sl.SLName SUBLEDGER_DESC, sl.SLCode SUBLEDGER_SHORTNAME, sl.SLAddress SUBLEDGER_ADDRESS, sl.SLPhoneNo SUBLEDGER_PHONE_NO, sl.GLID, slGl.GLName SUBLEDGER_LEDGER_DESC, slGl.GLCode SUBLEDGER_LEDGER_SHORTNAME, slGl.ACCode SUBLEDGER_LEDGER_ACCOUNTING_CODE, slGl.GLAddress SUBLEDGER_LEDGER_ADDRESS, slGl.PanNo SUBLEDGER_LEDGER_PAN_NO, slGl.CrDays SUBLEDGER_LEDGER_CREDIT_DAYS, slGl.CrLimit SUBLEDGER_LEDGER_CREDIT_LIMIT, slGl.CrTYpe SUBLEDGER_LEDGER_CREDIT_TYPE, slGl.IntRate SUBLEDGER_LEDGER_INTEREST_RATE, slGl.PhoneNo SUBLEDGER_LEDGER_PHONE_NO, slGl.LandLineNo SUBLEDGER_LEDGER_LANDLINE_NO, slGl.OwnerName SUBLEDGER_LEDGER_OWNER_NAME, slGl.OwnerNumber SUBLEDGER_LEDGER_OWNER_NO, slGl.Email SUBLEDGER_LEDGER_EMAIL_ADDRESS, pm.AgentId SALES_MAN_ID, ja.AgentName SALES_MAN, ja.AgentCode SALES_MAN_SHORTNAME, ja.Address SALES_MAN_ADDRESS, ja.PhoneNo SALES_MAN_PHONE_NO, ja.Email SALES_MAN_EMAIL, ja.Commission SALES_MAN_COMMISSION, ja.CRLimit SALES_MAN_CREDIT_LIMIT, ja.CrDays SALES_MAN_CREDIT_DAYS, ja.CrType SALES_MAN_CREDIT_TYPE, ja.GLCode SALES_MAN_LEDGER_ID, jaGl.GLName AGENT_LEDGER_DESC, jaGl.GLCode AGENT_LEDGER_SHORTNAME, jaGl.ACCode AGENT_LEDGER_ACCOUNTING_CODE, jaGl.GLAddress AGENT_LEDGER_ADDRESS, jaGl.PanNo AGENT_LEDGER_PAN_NO, jaGl.CrDays AGENT_LEDGER_CREDIT_DAYS, jaGl.CrLimit AGENT_LEDGER_CREDIT_LIMIT, jaGl.CrTYpe AGENT_LEDGER_CREDIT_TYPE, jaGl.IntRate AGENT_LEDGER_INTEREST_RATE, jaGl.PhoneNo AGENT_LEDGER_PHONE_NO, jaGl.LandLineNo AGENT_LEDGER_LANDLINE_NO, jaGl.OwnerName AGENT_LEDGER_OWNER_NAME, jaGl.OwnerNumber AGENT_LEDGER_OWNER_NO, jaGl.Email AGENT_LEDGER_EMAIL_ADDRESS, ja.SAgent MAIN_SALES_MAN_ID, ja.AgentName MAIN_SALES_MAN, ja.AgentCode MAIN_SALES_MAN_SHORTNAME, ja.Address MAIN_SALES_MAN_ADDRESS, ja.PhoneNo MAIN_SALES_MAN_PHONE_NO, ja.Email MAIN_SALES_MAN_EMAIL, ja.Commission MAIN_SALES_MAN_COMMISSION, ja.CRLimit MAIN_SALES_MAN_CREDIT_LIMIT, ja.CrDays MAIN_SALES_MAN_CREDIT_DAYS, ja.CrType MAIN_SALES_MAN_CREDIT_TYPE, ja.GLCode MAIN_SALES_MAN_LEDGER_ID, SaGl.GLName MAIN_AGENT_LEDGER_DESC, SaGl.GLCode MAIN_AGENT_LEDGER_SHORTNAME, SaGl.ACCode MAIN_AGENT_LEDGER_ACCOUNTING_CODE, SaGl.GLAddress MAIN, Remarks VOUCHER_REMARKS, DepositedBy VOUCHER_DEPOSITED_BY, DepositeDate VOUCHER_DEPOSITE_DATE, CancelReason VOUCHER_CANCEL_REASON, CancelBy VOUCHER_CANCEL_BY, CancelDate VOUCHER_CANCEL_DATE, Cls1 DEPARTMENT_1ST, d.DName DEPARTMENT_DESC, d.DCode DEPARTMENT_SHORTNAME, Cls2 DEPARTMENT_2DN, Cls3 DEPARTMENT_3RD, Cls4 DEPARTMENT_4TH, CompanyUnitId COMPANY_UNIT_ID, cu.CmpUnit_Name BUSINESS_UNIT_DESC, cu.CmpUnit_Code BUSINESS_UNIT_SHORTNAME, BranchId BRANCH_ID, b.Branch_Name BRANCH_DESC, b.Branch_Code BRANCH_SHORTNAME, b.Address BRANCH_ADDRESS, b.PhoneNo BRANCH_PHONE_NO, b.Email BRANCH_EMAIL, b.ContactPerson BRANCH_CONTACT_PERSON, b.ContactPersonAdd BRANCH_CONTACT_PERSON_ADDRESS, b.ContactPersonPhone BRANCH_CONTACT_PERSON_PHONE_NO, pm.EnterBy ENTER_BY, FiscalYearId FISCAL_YEAR_ID, fy.AD_FY, fy.Start_ADDate, fy.End_ADDate, fy.BS_FY, fy.Start_BSDate, fy.End_BSDate, VoucherTime VOUCHER_TIME, BankLedgerId BANK_LEDGER_ID, bagl.GLName BANK_LEDGER_DESC, bagl.GLCode BANK_LEDGER_SHORTNAME, bagl.ACCode BANK_LEDGER_ACCOUNTING_CODE, bagl.GLAddress BANK_LEDGER_ADDRESS, bagl.PanNo BANK_LEDGER_PAN_NO, bagl.CrDays BANK_LEDGER_CREDIT_DAYS, bagl.CrLimit BANK_LEDGER_CREDIT_LIMIT, bagl.CrTYpe BANK_LEDGER_CREDIT_TYPE, bagl.IntRate BANK_LEDGER_INTEREST_RATE, bagl.PhoneNo BANK_LEDGER_PHONE_NO, bagl.LandLineNo BANK_LEDGER_LANDLINE_NO, bagl.OwnerName BANK_LEDGER_OWNER_NAME, bagl.OwnerNumber BANK_LEDGER_OWNER_NO, bagl.Email BANK_LEDGER_EMAIL_ADDRESS, bagl.CurrId BANK_LEDGER_CURRENCY_ID, baglCu.CName BANK_LEDGER_CURRENCY_NAME, baglCu.Ccode BANK_LEDGER_CURRENCY_SHORTNAME, baglCu.CRate BANK_LEDGER_CURRENCY_RATE, bagl.AgentId BANK_LEDGER_AGENT_ID, baglAg.AgentName BANK_LEDGER_SALES_MAN, baglAg.AgentCode BANK_LEDGER_SALES_MAN_SHORTNAME, baglAg.Address BANK_LEDGER_SALES_MAN_ADDRESS, baglAg.PhoneNo BANK_LEDGER_SALES_MAN_PHONE_NO, baglAg.Email BANK_LEDGER_SALES_MAN_EMAIL, baglAg.Commission BANK_LEDGER_SALES_MAN_COMMISSION, baglAg.CRLimit BANK_LEDGER_SALES_MAN_CREDIT_LIMIT, baglAg.CrDays BANK_LEDGER_SALES_MAN_CREDIT_DAYS, baglAg.CrType BANK_LEDGER_SALES_MAN_CREDIT_TYPE, bagl.AreaId BANK_LEDGER_AREA_ID, baglA.AreaName BANK_LEDGER_AREA_DESC, baglA.AreaCode BANK_LEDGER_AREA_SHORTNAME, baglA.Country BANK_LEDGER_AREA_COUNTRY, baglA.Main_Area BANK_LEDGER_MAIN_AREA_ID, baglMa.MAreaName BANK_LEDGER_MAIN_AREA_DESC, baglMa.MAreaCode BANK_LEDGER_MAIN_AREA_SHORTNAME, baglMa.MCountry BANK_LEDGER_MAIN_AREA_COUNTRY, bagl.GrpId BANK_LEDGER_GROUP_ID, baag.GrpName BANK_LEDGER_GROUP_DESC, baag.GrpCode BANK_LEDGER_GROUP_SHORTNAME, baag.PrimaryGrp BANK_LEDGER_GROUP_PRIMARY, baag.GrpType BANK_LEDGER_GROUP_TYPE, bagl.SubGrpId BANK_LEDGER_SUBGROUP_ID, baasg.SubGrpName BANK_LEDGER_SUBGROUP_DESC, baasg.SubGrpCode BANK_LEDGER_SUBGROUP_SHORTNAME
       FROM AMS.PostDateCheque pm LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=pm.LedgerId LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId LEFT OUTER JOIN AMS.Subledger sl ON sl.SLId=pm.SubLedgerId LEFT OUTER JOIN AMS.GeneralLedger slGl ON slGl.GLID=sl.GLID LEFT OUTER JOIN AMS.JuniorAgent ja ON ja.AgentId=pm.AgentId LEFT OUTER JOIN AMS.GeneralLedger jaGl ON jaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.SeniorAgent sa ON sa.SAgentId=ja.SAgent LEFT OUTER JOIN AMS.GeneralLedger SaGl ON SaGl.GLID=ja.GLCode LEFT OUTER JOIN AMS.Branch b ON b.Branch_Id=pm.BranchId LEFT OUTER JOIN AMS.CompanyUnit cu ON cu.CmpUnit_Id=pm.CompanyUnitId LEFT OUTER JOIN AMS.FiscalYear fy ON fy.FY_Id=pm.FiscalYearId LEFT OUTER JOIN AMS.Department d ON d.DId=pm.Cls1 LEFT OUTER JOIN AMS.GeneralLedger bagl ON bagl.GLID=pm.BankLedgerId LEFT OUTER JOIN AMS.AccountGroup baag ON baag.GrpId=bagl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup baasg ON baasg.SubGrpId=bagl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent baglAg ON baglAg.AgentId=bagl.AgentId LEFT OUTER JOIN AMS.Area baglA ON baglA.AreaId=bagl.AreaId LEFT OUTER JOIN AMS.MainArea baglMa ON baglMa.MAreaId=baglA.Main_Area LEFT OUTER JOIN AMS.Currency baglCu ON baglCu.CId=bagl.CurrId;');
END;

IF OBJECT_ID('VM.VIEW_GENERAL_LEDGER') IS NOT NULL BEGIN
  EXECUTE('
    ALTER VIEW VM.VIEW_GENERAL_LEDGER
    AS
    SELECT PM.GLID LEDGER_ID, gl.GLName LEDGER_DESC, gl.GLCode LEDGER_SHORTNAME, gl.ACCode LEDGER_ACCOUNTING_CODE, gl.GLAddress LEDGER_ADDRESS, gl.PanNo LEDGER_PAN_NO, gl.CrDays LEDGER_CREDIT_DAYS, gl.CrLimit LEDGER_CREDIT_LIMIT, gl.CrTYpe LEDGER_CREDIT_TYPE, gl.IntRate LEDGER_INTEREST_RATE, gl.PhoneNo LEDGER_PHONE_NO, gl.LandLineNo LEDGER_LANDLINE_NO, gl.OwnerName LEDGER_OWNER_NAME, gl.OwnerNumber LEDGER_OWNER_NO, gl.Email LEDGER_EMAIL_ADDRESS, gl.CurrId LEDGER_CURRENCY_ID, glCu.CName LEDGER_CURRENCY_NAME, glCu.Ccode LEDGER_CURRENCY_SHORTNAME, glCu.CRate LEDGER_CURRENCY_RATE, gl.AgentId LEDGER_AGENT_ID, glAg.AgentName LEDGER_SALES_MAN, glAg.AgentCode LEDGER_SALES_MAN_SHORTNAME, glAg.Address LEDGER_SALES_MAN_ADDRESS, glAg.PhoneNo LEDGER_SALES_MAN_PHONE_NO, glAg.Email LEDGER_SALES_MAN_EMAIL, glAg.Commission LEDGER_SALES_MAN_COMMISSION, glAg.CRLimit LEDGER_SALES_MAN_CREDIT_LIMIT, glAg.CrDays LEDGER_SALES_MAN_CREDIT_DAYS, glAg.CrType LEDGER_SALES_MAN_CREDIT_TYPE, gl.AreaId LEDGER_AREA_ID, glA.AreaName LEDGER_AREA_DESC, glA.AreaCode LEDGER_AREA_SHORTNAME, glA.Country LEDGER_AREA_COUNTRY, glA.Main_Area LEDGER_MAIN_AREA_ID, glMa.MAreaName LEDGER_MAIN_AREA_DESC, glMa.MAreaCode LEDGER_MAIN_AREA_SHORTNAME, glMa.MCountry LEDGER_MAIN_AREA_COUNTRY, gl.GrpId LEDGER_GROUP_ID, ag.GrpName LEDGER_GROUP_DESC, ag.GrpCode LEDGER_GROUP_SHORTNAME, ag.PrimaryGrp LEDGER_GROUP_PRIMARY, ag.GrpType LEDGER_GROUP_TYPE, gl.SubGrpId LEDGER_SUBGROUP_ID, asg.SubGrpName LEDGER_SUBGROUP_DESC, asg.SubGrpCode LEDGER_SUBGROUP_SHORTNAME
       FROM AMS.GeneralLedger PM LEFT OUTER JOIN AMS.GeneralLedger gl ON gl.GLID=PM.GLID LEFT OUTER JOIN AMS.AccountGroup ag ON ag.GrpId=gl.GrpId LEFT OUTER JOIN AMS.AccountSubGroup asg ON asg.SubGrpId=gl.SubGrpId LEFT OUTER JOIN AMS.JuniorAgent glAg ON glAg.AgentId=gl.AgentId LEFT OUTER JOIN AMS.Area glA ON glA.AreaId=gl.AreaId LEFT OUTER JOIN AMS.MainArea glMa ON glMa.MAreaId=glA.Main_Area LEFT OUTER JOIN AMS.Currency glCu ON glCu.CId=gl.CurrId;');
END;
